#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -rT -f ./submit50_2 
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[0]))
	"\353\127\335\067\225\305\047\115\203\364\325\167\073\110\143\353"
	"\141\154\271\053\102\023\361"
#define      tst1_z	22
#define      tst1	((&data[24]))
	"\231\174\231\210\205\133\107\373\200\343\015\032\135\331\062\134"
	"\241\231\061\233\023\265\165\364\233"
#define      msg1_z	42
#define      msg1	((&data[57]))
	"\250\053\260\147\332\140\012\225\126\257\374\206\250\241\234\240"
	"\041\344\154\362\135\276\017\167\056\057\245\106\067\002\370\107"
	"\116\041\143\376\034\015\353\122\256\275\212\113\275\266\231\022"
	"\163\245\053\006\174\033\233\211\000\225\233\361\300"
#define      tst2_z	19
#define      tst2	((&data[109]))
	"\137\125\263\241\010\044\176\210\264\115\325\160\316\034\050\301"
	"\237\045\366\126\114\015"
#define      pswd_z	256
#define      pswd	((&data[147]))
	"\012\033\237\263\106\120\032\041\261\045\266\007\053\063\043\307"
	"\135\206\117\014\217\225\141\366\176\371\006\010\365\077\233\045"
	"\213\273\205\050\332\071\205\130\075\303\107\214\043\214\255\201"
	"\023\375\216\242\222\357\230\021\351\236\032\336\336\265\003\151"
	"\161\211\221\113\302\026\244\000\332\354\214\375\171\072\176\214"
	"\067\014\057\312\374\310\333\345\146\366\303\105\253\307\257\035"
	"\121\100\151\023\127\015\024\061\372\240\057\163\332\255\377\022"
	"\272\057\334\266\367\270\234\136\256\137\243\132\047\122\167\170"
	"\223\340\214\353\356\240\035\350\101\114\134\034\372\133\056\265"
	"\213\012\153\202\302\007\340\161\147\204\313\217\327\103\007\152"
	"\044\224\126\023\064\164\373\166\300\127\222\273\263\300\160\076"
	"\312\334\301\215\344\241\376\114\045\312\333\374\015\343\147\062"
	"\167\276\105\254\062\101\042\363\231\264\256\115\164\036\214\077"
	"\372\115\314\336\356\313\052\024\225\006\021\243\351\171\326\141"
	"\070\033\015\152\135\057\136\367\344\014\104\131\053\320\230\046"
	"\036\145\005\015\060\060\042\306\066\063\151\040\255\100\201\345"
	"\133\216\120\271\276\256\260\242\273\365\374\346\305\224\015\344"
	"\274\043\134\130\024\035\066\031\317\215\145\335\175\246\205\207"
	"\301\045\072\010\166\125\051\047\172\340\057\246\023\122\155\320"
	"\165\312\050\212\350\136\244\267\354\011"
#define      chk1_z	22
#define      chk1	((&data[447]))
	"\032\361\251\262\105\176\242\067\122\025\323\121\244\043\347\114"
	"\305\277\362\115\356\037\122\177\162\100\053\173"
#define      rlax_z	1
#define      rlax	((&data[473]))
	"\131"
#define      date_z	1
#define      date	((&data[474]))
	"\354"
#define      shll_z	10
#define      shll	((&data[476]))
	"\137\244\177\333\367\316\064\377\016\243\074\020"
#define      lsto_z	1
#define      lsto	((&data[487]))
	"\161"
#define      msg2_z	19
#define      msg2	((&data[489]))
	"\361\002\145\100\015\067\224\167\035\213\357\046\033\233\345\312"
	"\116\310\072\130\004\172\335"
#define      inlo_z	3
#define      inlo	((&data[511]))
	"\015\305\040"
#define      opts_z	1
#define      opts	((&data[514]))
	"\130"
#define      xecc_z	15
#define      xecc	((&data[516]))
	"\253\271\050\226\065\243\334\006\231\172\027\363\304\044\026\103"
	"\040"
#define      text_z	2335
#define      text	((&data[716]))
	"\341\326\014\204\160\154\224\331\101\157\154\242\062\135\246\255"
	"\072\265\274\202\163\347\272\244\121\036\120\162\003\241\161\345"
	"\170\176\151\350\352\376\302\053\155\056\315\240\213\164\115\306"
	"\051\012\110\235\361\002\102\103\041\222\265\045\064\047\012\254"
	"\245\164\224\217\162\126\273\340\205\211\201\020\375\316\327\047"
	"\331\037\304\312\042\006\015\103\231\303\151\315\353\164\172\220"
	"\350\016\040\133\145\333\074\352\144\275\373\142\213\322\211\145"
	"\361\115\057\024\124\075\130\355\001\301\273\354\065\065\175\036"
	"\103\235\171\251\171\266\224\336\163\217\100\377\142\312\144\123"
	"\030\224\150\154\321\300\132\322\202\025\277\267\112\074\325\216"
	"\332\117\070\123\005\314\062\170\134\163\170\276\075\334\022\125"
	"\160\172\302\102\073\035\025\275\070\341\006\263\131\151\073\107"
	"\227\200\147\156\001\164\220\272\050\270\030\231\173\141\057\267"
	"\021\327\171\325\125\027\243\360\351\006\333\243\135\072\100\145"
	"\022\370\035\262\004\155\071\067\016\140\050\142\040\222\246\112"
	"\217\022\251\207\102\335\161\243\010\127\272\274\217\226\073\107"
	"\213\024\023\144\325\076\365\044\011\106\267\330\170\300\307\035"
	"\372\145\330\071\145\311\245\256\172\012\212\375\160\172\207\041"
	"\067\211\304\350\134\217\317\225\312\365\036\353\363\277\057\323"
	"\001\167\046\102\334\052\027\050\115\074\147\377\330\251\377\362"
	"\337\214\071\310\264\047\010\364\202\363\243\041\302\235\126\145"
	"\311\321\131\273\072\365\371\143\137\022\135\041\053\366\247\166"
	"\031\324\341\305\064\306\241\220\304\317\357\313\355\162\140\143"
	"\064\275\075\345\307\117\370\237\165\365\321\264\110\066\140\254"
	"\250\162\215\015\114\370\233\047\331\127\141\356\025\271\061\147"
	"\114\152\201\357\226\231\143\237\203\127\071\302\225\032\110\263"
	"\325\057\320\264\126\157\100\345\053\024\061\161\077\276\137\252"
	"\301\112\172\256\003\027\141\003\307\076\014\103\032\003\043\126"
	"\117\001\330\254\342\176\234\134\047\306\222\206\323\034\255\121"
	"\241\007\074\011\157\156\036\175\227\104\152\376\162\115\010\071"
	"\003\326\231\107\114\140\354\205\025\343\157\043\074\343\027\143"
	"\145\230\370\264\022\070\047\046\315\364\216\351\370\011\200\067"
	"\041\062\220\004\266\020\122\075\147\037\246\203\035\152\307\274"
	"\150\262\310\315\173\153\065\157\242\253\327\247\205\024\130\323"
	"\263\073\047\367\226\371\210\263\111\015\323\046\054\352\220\333"
	"\137\032\327\345\114\067\010\041\143\313\372\262\137\114\142\066"
	"\075\137\310\367\051\171\230\333\056\360\312\065\175\227\265\015"
	"\160\174\341\232\213\323\130\157\147\003\364\334\270\122\117\044"
	"\324\006\336\107\326\120\156\272\000\305\156\066\317\346\347\325"
	"\265\143\000\230\371\305\147\064\330\202\342\126\270\034\002\040"
	"\074\302\137\020\371\150\333\147\210\352\116\207\023\352\226\225"
	"\241\004\030\016\001\237\326\122\300\075\200\307\277\024\362\165"
	"\202\176\365\151\127\307\012\163\300\242\150\213\052\362\274\237"
	"\241\330\116\352\032\247\342\143\067\130\331\131\041\253\264\107"
	"\263\057\367\237\352\244\135\160\312\265\206\111\074\257\117\172"
	"\071\172\071\241\143\321\111\261\350\114\122\217\070\264\246\105"
	"\111\112\141\273\162\230\265\242\227\163\061\242\275\217\163\057"
	"\155\341\015\252\353\350\121\071\310\146\262\175\050\344\251\160"
	"\310\111\034\345\025\010\116\157\274\356\045\237\043\125\342\317"
	"\335\255\115\133\074\265\260\072\233\037\013\147\157\333\310\371"
	"\116\246\337\335\124\061\317\223\317\267\056\105\076\226\341\317"
	"\077\137\172\105\256\350\212\232\100\345\202\321\365\375\346\277"
	"\145\143\235\373\116\344\122\250\107\273\006\050\314\005\301\263"
	"\136\206\026\306\271\321\027\374\273\153\247\171\320\300\162\326"
	"\054\372\227\334\222\375\067\155\213\124\212\347\123\271\314\034"
	"\106\270\142\302\371\114\170\317\233\334\317\304\330\214\301\155"
	"\126\061\201\101\024\132\270\271\043\133\071\000\311\275\043\120"
	"\231\143\351\245\345\061\344\165\371\166\133\244\206\367\276\234"
	"\276\240\303\023\101\011\372\006\076\212\030\230\111\012\205\242"
	"\123\155\332\212\300\114\117\030\354\177\312\317\003\220\321\331"
	"\071\264\116\045\376\111\144\241\056\350\332\251\100\240\305\274"
	"\023\302\300\162\206\067\264\235\116\203\143\356\363\071\360\227"
	"\151\354\330\213\034\253\062\074\120\275\145\160\062\312\123\354"
	"\331\325\301\042\340\011\104\325\165\130\100\157\022\027\256\051"
	"\205\150\236\375\255\217\040\161\364\226\115\251\273\066\321\275"
	"\054\251\337\041\136\367\317\022\356\313\361\073\020\053\231\325"
	"\352\350\153\364\224\027\347\067\140\265\301\207\043\157\320\010"
	"\123\120\101\306\320\224\241\261\115\344\316\230\144\250\154\324"
	"\243\356\070\035\153\177\222\211\237\130\263\366\032\162\321\275"
	"\234\261\160\006\070\326\216\176\317\343\215\123\240\143\213\170"
	"\166\003\246\047\251\240\244\131\335\302\026\045\052\165\370\257"
	"\015\326\011\232\347\163\306\024\132\377\123\125\347\263\141\210"
	"\044\205\173\040\117\032\334\323\101\310\074\320\167\366\217\266"
	"\374\077\253\227\355\024\056\237\253\072\051\162\140\100\031\256"
	"\065\074\353\132\274\311\314\330\266\167\345\223\003\230\363\107"
	"\060\142\026\305\205\313\077\266\241\135\172\340\334\011\066\041"
	"\102\105\276\320\153\013\215\115\367\160\225\263\214\014\363\117"
	"\241\053\332\205\004\176\141\253\356\044\371\354\350\103\231\055"
	"\366\272\075\214\151\045\172\270\377\070\072\225\356\317\044\006"
	"\047\063\020\116\255\002\273\115\333\102\102\266\132\371\355\300"
	"\165\025\370\125\013\356\065\131\244\277\006\241\161\306\333\114"
	"\316\021\303\120\051\160\146\125\363\316\120\174\215\175\006\036"
	"\267\052\031\303\026\014\311\252\210\142\206\340\142\313\005\105"
	"\063\073\031\053\154\140\370\315\103\174\330\124\075\070\270\365"
	"\000\334\345\112\173\031\300\273\243\063\071\102\361\225\356\237"
	"\231\261\103\234\121\051\346\162\203\113\351\172\025\233\156\225"
	"\126\270\111\252\207\133\147\220\356\324\260\340\134\061\062\074"
	"\376\177\125\111\364\131\305\276\271\272\377\256\032\026\164\334"
	"\334\050\320\026\061\321\326\262\060\101\053\244\025\007\143\337"
	"\314\107\275\125\005\206\305\315\131\335\035\221\317\110\270\333"
	"\224\333\045\313\113\353\325\316\227\044\213\352\315\346\155\026"
	"\352\370\350\053\024\137\125\313\271\305\102\143\207\031\312\202"
	"\171\203\257\311\032\305\146\013\311\032\145\133\375\364\070\314"
	"\056\234\262\107\157\117\006\127\243\371\313\051\077\274\225\103"
	"\331\336\261\375\010\041\100\224\021\324\261\364\036\074\163\152"
	"\303\004\327\077\321\002\065\161\315\033\345\022\342\041\154\127"
	"\040\177\065\055\307\305\122\141\017\320\361\221\017\145\060\121"
	"\006\156\304\207\024\125\110\077\202\135\157\266\003\005\057\150"
	"\020\161\077\331\054\200\000\152\126\113\207\007\027\225\045\022"
	"\077\155\270\157\004\330\113\035\114\345\170\160\001\076\014\222"
	"\263\311\064\004\334\213\270\257\130\135\137\123\234\316\073\026"
	"\017\102\016\345\240\071\331\136\355\031\170\031\176\365\225\205"
	"\261\343\212\332\232\341\176\172\012\272\032\124\000\013\161\104"
	"\162\342\311\073\153\205\335\125\161\203\347\135\334\304\104\025"
	"\145\333\204\204\223\031\133\235\135\064\161\313\277\245\053\152"
	"\172\224\204\077\061\342\233\032\370\311\041\215\351\121\141\016"
	"\320\016\005\340\223\273\335\106\220\034\366\007\322\157\122\026"
	"\123\311\360\045\152\364\350\204\172\003\005\363\174\313\172\126"
	"\301\006\244\000\210\231\042\234\256\312\261\170\316\251\127\056"
	"\125\224\215\262\233\033\236\272\006\326\113\277\257\117\375\366"
	"\102\023\143\273\333\057\360\265\217\104\124\057\154\140\255\226"
	"\003\227\255\201\035\344\207\246\361\337\335\046\127\244\104\333"
	"\177\033\307\173\376\106\002\160\115\343\261\161\353\011\023\134"
	"\113\117\257\222\250\044\044\357\360\136\335\020\342\303\131\225"
	"\046\104\036\243\025\126\071\260\202\241\254\204\151\076\025\026"
	"\050\330\374\364\007\004\164\272\303\141\217\302\375\355\321\155"
	"\173\161\305\310\032\163\342\212\074\330\143\164\234\301\104\252"
	"\215\240\340\127\120\143\216\303\164\126\312\117\035\067\050\171"
	"\160\313\067\302\140\363\360\313\055\005\003\371\206\146\214\007"
	"\151\044\163\157\155\345\333\304\114\353\024\077\364\274\021\124"
	"\210\236\202\317\207\127\367\356\105\273\032\020\255\235\023\223"
	"\156\365\326\207\237\023\115\153\341\220\153\351\305\376\220\077"
	"\264\155\071\224\345\227\347\311\001\267\151\020\207\004\124\176"
	"\036\045\201\177\135\112\221\015\053\116\044\222\016\346\205\362"
	"\231\010\115\334\337\006\074\011\175\127\212\361\241\350\110\271"
	"\001\342\332\321\243\360\074\050\011\122\164\036\072\231\035\223"
	"\334\063\337\317\271\165\200\247\252\355\020\345\117\021\257\055"
	"\130\165\260\156\041\062\137\213\021\072\272\323\335\117\266\244"
	"\276\024\012\205\141\120\371\347\124\250\135\005\057\301\132\313"
	"\263\124\233\325\127\111\327\353\163\135\016\074\016\171\004\045"
	"\347\300\362\017\216\365\375\144\365\153\351\316\337\014\071\214"
	"\150\045\367\302\034\125\020\123\054\055\362\116\033\003\240\225"
	"\160\105\341\063\022\302\121\152\227\215\000\021\031\354\163\133"
	"\360\220\031\230\162\211\357\013\124\001\050\325\357\132\300\077"
	"\247\337\311\250\320\115\337\042\202\263\233\057\267\165\043\006"
	"\347\337\362\171\340\274\345\325\363\222\260\237\021\334\253\022"
	"\112\137\272\165\261\325\031\353\257\374\132\045\105\361\066\161"
	"\003\054\264\320\236\015\017\275\201\337\062\344\133\022\203\343"
	"\016\075\353\057\011\144\354\206\072\304\110\123\035\257\274\122"
	"\216\046\044\211\326\127\107\312\303\131\173\133\235\127\242\210"
	"\232\277\173\227\017\227\062\344\021\071\206\230\130\112\045\155"
	"\041\013\252\025\265\134\143\102\270\313\365\015\365\274\030\077"
	"\305\057\056\205\326\217\270\005\246\162\036\153\360\065\104\116"
	"\001\363\307\366\213\045\016\316\176\314\225\100\257\121\204\303"
	"\117\220\152\335\047\104\050\215\326\207\320\311\040\163\032\122"
	"\263\172\141\016\042\047\344\145\054\245\213\240\037\347\133\160"
	"\366\054\352\216\112\374\366\277\170\303\100\312\135\257\234\262"
	"\277\143\175\375\102\127\235\302\327\204\333\274\263\336\373\323"
	"\251\251\156\047\132\172\266\264\103\100\272\064\112\233\000\364"
	"\367\112\040\256\372\332\347\353\227\357\223\052\153\361\157\310"
	"\333\005\010\253\032\005\157\270\043\204\244\157\147\177\023\037"
	"\033\003\020\310\240\117\143\256\236\126\265\134\272\006\355\315"
	"\200\200\225\215\352\236\157\362\364\056\076\263\273\202\213\360"
	"\022\145\017\204\331\050\371\210\233\063\360\115\141\231\113\102"
	"\361\354\307\211\346\130\313\303\212\327\355\215\151\001\063\023"
	"\221\315\315\075\210\145\131\340\133\306\011\337\064\366\177\302"
	"\261\144\306\365\372\272\336\202\277\223\143\367\275\104\011\017"
	"\102\302\137\330\265\254\026\062\324\164\175\021\112\013\354\231"
	"\103\077\236\020\162\027\154\345\217\053\043\154\075\171\335\270"
	"\073\037\363\130\065\260\213\012\045\010\033\157\024\007\010\127"
	"\107\247\150\272\276\324\237\116\377\302\272\075\073\227\365\167"
	"\267\350\320\354\231\133\366\277\144\022\056\170\032\067\320\142"
	"\337\070\034\235\015\274\354\014\177\246\112\273\075\077\062\365"
	"\050\003\341\301\137\330\200\303\353\257\073\005\346\013\150\306"
	"\103\205\143\121\101\117\135\301\366\250\174\064\347\257\051\017"
	"\262\012\320\021\343\121\325\316\000\020\324\347\034\075\255\140"
	"\302\021\261\003\141\017\305\127\267\101\213\236\360\265\256\243"
	"\300\177\265\243\320\212\162\321\233\106\270\267\204\146\030\106"
	"\167\311\112\331\331\017\061\220\120\274\057\101\162\335\344\062"
	"\135\231\325\055\043\110\377\276\217\267\166\023\036\216\131\225"
	"\130\243\157\061\263\240\302\003\135\361\105\317\317\051\001\054"
	"\303\327\132\347\037\131\246\257\021\034\302\057\253\034\305\003"
	"\300\064\065\163\324\367\167\062\350\274\001\270\346\002\345\251"
	"\332\077\220\372\231\066\251\253\123\154\333\376\210\240\002\111"
	"\325\067\274\252\056\063\334\027\360\335\317\326\340\264\200\273"
	"\364\021\265\216\110\137\071\233\314\025\232\125\266\234\236\213"
	"\323\132\066\002\216\022\031\176\360\350\125\321\235\326\214\222"
	"\347\102\040\057\242\132\313\156\160\145\304\046\002\142\261\325"
	"\274\347\330\113\372\361\312\353\332\040\274\170\366\111\012\335"
	"\214\053\015\057\206\330\235\366\076\142\034\100\304\316\026\201"
	"\266\356\314\261\337\226\234\272\266\131\062\255\242\075\212\056"
	"\150\230\135\357\160\373\345\256\135\002\357\042\320\005\243\207"
	"\363\157\070\323\006\324\215\275\055\300\153\320\375\365\377\145"
	"\215\135\124\376\131\072\255\267\075\234\331\015\241\174\225\225"
	"\354\315\150\363\241\366\261\317\266\034\237\263\021\236\031\237"
	"\374\156\236\125\250\113\014\345\350\345\363\212\141\210\037\116"
	"\126\207\101\367\175\362\307\064\016\147\347\040\006\000\300\002"
	"\157\137\127\027\253\143\375\223\110\361\035\252\172\074\370\320"
	"\304\071\310\102\054\217\166\073\366\136\133\374\137\034\377\316"
	"\173\126\345\046\271\343\271\002\324\327\254\116\023\245\037\330"
	"\337\347\032\013\166\221\106\155\357\242\152\116\276\151\034\071"
	"\300\002\137\171\346\031\173\272\360\050\011\004\315\050\334\254"
	"\020\366\267\206\210\376\364\167\240\137\306\137\311\342\230\211"
	"\345\370\002\313\021\176\206\002\247\220\006\164"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
