#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -r -T -f ./submit50_2 
#endif

static  char data [] = 
#define      opts_z	1
#define      opts	((&data[0]))
	"\205"
#define      tst2_z	19
#define      tst2	((&data[2]))
	"\305\251\365\072\170\334\372\201\020\106\054\244\274\306\356\145"
	"\252\254\277\272\341\300\060\120"
#define      date_z	1
#define      date	((&data[25]))
	"\074"
#define      shll_z	10
#define      shll	((&data[26]))
	"\355\017\046\245\335\012\111\341\244\071\323\234"
#define      rlax_z	1
#define      rlax	((&data[38]))
	"\110"
#define      inlo_z	3
#define      inlo	((&data[39]))
	"\223\162\004"
#define      chk2_z	19
#define      chk2	((&data[42]))
	"\053\155\075\101\354\371\310\075\166\001\256\267\066\317\243\133"
	"\050\134\163\026\305\227\327"
#define      xecc_z	15
#define      xecc	((&data[65]))
	"\202\263\116\124\157\275\126\141\136\205\304\233\355\151\206\203"
	"\370"
#define      tst1_z	22
#define      tst1	((&data[84]))
	"\256\265\114\026\124\071\046\206\321\037\012\236\013\025\020\021"
	"\306\072\206\026\341\346\121\030\352\050\040\036"
#define      lsto_z	1
#define      lsto	((&data[110]))
	"\171"
#define      text_z	2228
#define      text	((&data[502]))
	"\006\337\064\233\307\114\217\335\022\047\264\121\055\155\325\046"
	"\353\072\340\231\360\312\302\020\351\001\030\332\335\314\074\344"
	"\253\160\177\162\275\016\120\317\066\005\041\143\162\366\212\136"
	"\061\152\367\042\065\271\062\036\273\113\371\230\027\065\174\303"
	"\246\374\066\143\013\206\062\101\214\124\245\377\113\057\135\174"
	"\232\124\236\320\016\321\356\312\035\347\143\065\034\340\371\303"
	"\334\057\046\347\266\131\051\102\255\316\101\371\376\236\165\231"
	"\363\024\151\002\346\127\314\004\077\057\071\134\017\062\037\354"
	"\142\105\324\030\237\375\132\114\313\234\105\312\072\273\143\056"
	"\320\315\060\267\044\375\273\144\055\364\300\075\047\340\051\211"
	"\045\375\241\305\373\374\021\307\230\127\221\323\023\365\001\344"
	"\302\062\233\347\060\126\113\135\113\014\233\162\354\304\373\022"
	"\302\235\327\275\231\351\204\062\101\026\005\124\014\007\070\316"
	"\072\324\265\152\052\001\310\165\015\143\350\372\050\343\014\353"
	"\201\343\251\033\315\056\115\016\105\123\142\121\133\233\037\225"
	"\157\325\000\232\327\311\017\345\055\367\337\125\333\354\101\135"
	"\320\352\170\235\031\305\253\136\031\016\257\165\252\317\012\031"
	"\245\013\264\174\324\303\141\002\273\101\127\227\055\231\364\375"
	"\204\154\233\235\062\106\373\114\124\253\301\377\172\314\030\037"
	"\327\314\234\254\220\375\256\114\077\006\344\155\237\330\152\043"
	"\105\005\301\167\114\274\304\241\147\205\240\342\121\271\001\051"
	"\206\235\326\027\233\205\143\333\213\107\110\053\040\263\117\145"
	"\270\021\335\005\315\241\246\065\047\107\030\171\000\032\242\207"
	"\270\171\236\123\376\002\057\212\111\167\265\152\052\005\317\343"
	"\026\255\350\344\116\217\032\235\161\042\067\227\341\070\260\020"
	"\335\135\300\273\234\100\020\064\372\271\302\144\062\204\240\016"
	"\374\273\346\245\344\250\256\277\306\331\315\166\335\152\060\301"
	"\353\122\006\146\242\120\204\264\156\155\241\234\320\073\310\206"
	"\300\220\323\063\244\046\067\372\167\251\317\327\022\025\107\166"
	"\041\303\230\126\347\165\355\163\006\376\137\126\217\147\376\100"
	"\270\261\372\130\347\357\254\350\342\004\341\327\321\001\061\040"
	"\177\022\002\240\251\161\353\340\040\303\142\045\304\101\371\150"
	"\142\272\223\063\113\316\353\314\227\242\164\237\244\227\032\223"
	"\315\150\214\051\131\034\332\234\030\343\251\371\346\017\213\046"
	"\373\045\132\307\230\002\050\243\322\114\300\367\071\323\215\107"
	"\150\255\336\077\177\232\005\043\133\305\270\217\167\314\337\357"
	"\260\116\047\354\251\347\301\312\354\121\335\133\321\226\223\113"
	"\052\033\114\027\045\116\151\073\247\312\367\042\313\227\117\240"
	"\215\333\052\116\073\025\277\312\153\300\071\136\167\216\203\256"
	"\361\256\256\247\372\020\141\224\370\313\220\054\351\142\306\011"
	"\077\305\123\307\105\035\102\226\034\231\227\170\162\111\156\261"
	"\053\364\176\113\060\130\207\370\156\271\023\032\161\301\210\337"
	"\126\277\066\003\040\022\256\335\075\206\324\320\204\250\301\246"
	"\262\126\254\074\250\335\362\264\002\037\200\353\143\165\174\004"
	"\013\211\152\037\245\362\221\373\366\037\144\252\151\257\076\070"
	"\001\025\074\004\015\110\206\152\242\123\217\064\275\024\232\150"
	"\236\165\245\170\065\220\053\164\377\006\100\310\275\136\315\023"
	"\343\101\163\100\312\253\026\301\353\136\147\020\001\221\006\150"
	"\306\343\130\144\021\342\313\201\035\240\330\056\247\041\367\154"
	"\167\375\320\120\034\065\234\076\373\266\047\061\374\074\250\101"
	"\040\343\137\254\015\045\042\103\051\015\240\337\146\162\020\074"
	"\145\041\107\072\222\202\270\331\365\373\315\303\226\071\100\307"
	"\245\262\057\231\343\357\050\155\325\117\041\355\266\325\327\035"
	"\212\303\134\244\002\271\220\377\212\375\015\102\007\233\262\223"
	"\167\215\277\301\060\265\364\012\104\114\026\216\004\150\231\012"
	"\206\167\223\324\003\003\025\222\035\342\243\300\006\247\142\234"
	"\011\103\342\307\122\057\020\207\164\011\050\133\131\231\025\053"
	"\226\237\270\077\313\372\360\003\374\353\121\212\154\167\320\155"
	"\342\357\072\253\106\250\265\071\043\176\032\111\257\263\371\022"
	"\224\147\206\170\022\217\223\155\311\004\236\324\343\014\042\037"
	"\000\073\362\257\002\353\175\047\013\212\374\067\372\074\017\003"
	"\003\050\067\113\224\373\165\243\120\231\167\125\015\065\227\363"
	"\115\222\354\126\357\063\344\161\302\227\016\066\214\045\111\157"
	"\240\275\321\001\125\220\124\150\027\324\251\236\062\051\134\263"
	"\062\324\235\216\111\216\241\000\152\016\262\360\132\241\056\252"
	"\137\172\126\063\023\012\113\206\320\324\055\054\317\167\247\076"
	"\073\244\355\336\314\002\053\010\245\160\171\210\073\162\077\221"
	"\104\345\264\005\300\132\157\101\127\160\216\022\136\175\312\255"
	"\147\352\074\360\160\060\174\121\233\051\312\320\313\154\316\177"
	"\346\235\264\122\223\267\372\023\030\132\205\060\043\366\046\106"
	"\114\325\172\144\320\266\053\115\076\127\346\143\252\251\017\025"
	"\311\070\142\203\377\156\225\227\124\257\113\124\175\256\361\271"
	"\060\306\024\162\334\071\320\322\243\061\206\033\045\033\267\253"
	"\345\205\111\232\003\344\057\100\334\140\250\216\352\354\002\361"
	"\137\341\124\277\265\357\271\155\336\252\137\277\040\214\340\214"
	"\321\030\072\260\223\315\221\114\301\247\103\234\224\313\155\326"
	"\346\264\215\235\017\216\110\156\200\367\253\302\226\141\270\267"
	"\141\113\154\003\162\016\145\360\005\357\217\375\254\026\073\305"
	"\224\335\377\370\352\114\026\100\315\017\252\216\232\214\070\212"
	"\300\220\360\272\365\267\343\336\113\171\205\373\241\014\100\206"
	"\065\322\111\371\151\253\243\316\146\040\216\354\214\042\264\223"
	"\156\111\151\362\115\211\314\207\226\034\325\344\217\327\236\037"
	"\357\107\370\303\066\312\134\050\272\012\367\104\173\262\265\214"
	"\356\255\202\364\365\002\040\314\313\351\054\210\166\145\327\156"
	"\333\110\235\166\005\024\107\210\277\234\270\212\261\017\300\200"
	"\074\123\160\034\210\374\351\231\006\070\042\214\311\132\226\307"
	"\131\377\337\347\061\320\340\061\033\132\117\033\356\023\050\331"
	"\147\151\164\021\017\247\250\131\147\223\357\245\134\211\073\076"
	"\302\166\130\232\275\067\363\355\173\262\365\221\037\103\367\377"
	"\244\316\101\311\244\105\333\014\024\376\250\345\202\374\010\170"
	"\142\253\037\207\035\331\223\273\150\325\302\251\244\104\222\073"
	"\211\205\264\344\373\145\261\064\346\077\005\321\166\133\147\060"
	"\060\007\240\177\224\224\214\250\277\220\274\247\254\260\143\026"
	"\361\126\030\140\023\312\311\217\117\176\035\077\122\361\343\040"
	"\362\300\363\341\177\164\226\124\237\046\065\305\375\167\300\115"
	"\377\225\376\003\146\100\035\137\302\121\100\351\057\004\205\136"
	"\302\353\156\052\041\076\001\175\326\171\235\255\271\106\040\325"
	"\044\201\034\270\300\233\026\024\160\101\327\141\271\065\320\357"
	"\144\076\060\011\371\321\227\202\235\376\054\275\064\124\236\032"
	"\165\022\116\066\072\211\246\216\154\127\220\000\102\107\202\135"
	"\116\050\341\061\043\166\013\024\031\101\110\012\003\002\372\071"
	"\125\313\207\364\330\041\065\354\317\276\024\371\372\360\101\030"
	"\213\352\135\055\345\310\235\267\115\247\164\316\260\270\342\007"
	"\202\263\132\354\325\375\377\044\114\027\005\125\327\151\032\157"
	"\131\352\344\157\255\010\361\020\057\102\146\320\150\104\372\062"
	"\024\365\313\042\117\220\217\370\327\004\232\235\125\345\057\373"
	"\165\075\271\310\323\326\315\030\145\275\360\153\361\261\154\337"
	"\020\146\024\041\275\354\151\314\026\234\366\365\105\215\163\035"
	"\014\257\231\224\001\263\304\345\164\332\065\130\142\121\260\076"
	"\075\357\131\246\063\336\147\154\117\037\135\300\057\103\377\066"
	"\015\306\220\011\065\324\011\040\167\364\220\315\015\306\250\211"
	"\354\353\025\176\346\001\353\023\335\333\156\242\167\204\334\366"
	"\056\132\263\125\324\113\140\150\237\240\072\070\053\053\107\060"
	"\065\363\257\230\367\020\301\307\135\371\215\141\234\263\265\034"
	"\330\207\077\111\202\044\114\010\222\012\362\270\206\355\125\312"
	"\135\024\064\163\360\373\122\355\212\233\325\230\245\101\240\273"
	"\314\201\212\176\025\033\351\230\000\211\263\060\223\052\134\112"
	"\252\244\335\170\175\050\377\041\070\010\350\167\105\057\355\223"
	"\252\162\337\343\227\142\153\116\243\205\347\273\234\271\261\252"
	"\146\357\307\344\367\205\145\210\026\265\135\011\036\242\266\354"
	"\240\241\305\312\025\136\067\277\113\003\026\141\306\374\247\165"
	"\301\211\331\022\221\362\344\101\140\261\104\241\321\313\021\222"
	"\211\164\220\133\201\304\357\345\305\044\017\103\221\245\372\076"
	"\247\145\254\126\126\143\071\124\275\162\276\141\164\264\277\101"
	"\347\375\256\245\073\036\146\337\060\143\131\364\077\316\305\274"
	"\335\312\143\123\066\222\142\340\206\203\340\031\304\171\055\046"
	"\320\220\105\077\267\060\043\345\106\024\055\340\213\024\047\222"
	"\251\372\113\214\006\241\056\176\276\241\256\321\042\210\270\256"
	"\270\200\250\371\160\051\273\100\376\062\002\114\340\165\333\015"
	"\265\305\364\243\013\173\312\330\054\073\055\106\253\372\326\136"
	"\206\040\126\141\110\120\244\331\265\366\050\124\100\116\025\116"
	"\054\207\366\151\317\222\000\221\176\124\316\365\362\327\065\010"
	"\221\103\043\132\151\036\154\036\245\147\140\350\050\026\065\072"
	"\064\206\020\106\115\320\342\172\047\315\317\277\132\142\174\366"
	"\136\177\002\162\356\127\212\212\163\222\043\344\213\227\144\361"
	"\202\375\047\245\266\276\355\243\247\034\052\056\131\164\114\103"
	"\124\011\070\011\210\274\032\063\223\221\212\217\350\226\266\155"
	"\326\152\173\202\165\160\317\010\354\025\221\210\314\233\065\260"
	"\227\327\145\376\040\260\301\042\126\037\077\037\367\237\065\016"
	"\031\264\213\154\063\264\161\143\327\017\117\046\375\103\041\240"
	"\334\351\014\236\314\030\021\154\067\025\055\276\007\010\330\077"
	"\000\362\042\010\304\232\121\201\310\273\161\267\160\334\044\261"
	"\032\040\353\064\023\115\243\005\266\022\073\213\327\317\241\111"
	"\331\067\174\212\145\125\277\121\307\117\173\070\205\306\276\025"
	"\205\236\221\017\070\271\306\250\121\014\362\000\062\151\142\165"
	"\250\011\315\045\176\060\106\067\005\264\113\004\077\001\345\152"
	"\367\145\275\170\350\115\140\234\120\166\137\106\215\124\334\172"
	"\374\207\117\165\214\325\205\041\056\131\323\176\075\225\305\310"
	"\327\117\252\047\151\306\213\045\111\225\300\032\306\124\266\340"
	"\121\246\361\235\362\040\374\250\307\113\353\371\005\137\307\210"
	"\321\200\025\371\172\201\104\026\226\231\351\036\327\370\123\177"
	"\241\114\076\341\247\375\351\307\365\046\067\044\042\336\033\142"
	"\320\230\245\167\346\133\042\340\044\236\356\244\041\346\063\040"
	"\320\163\144\074\272\046\363\355\323\333\315\323\316\047\247\055"
	"\101\356\227\152\243\276\370\251\067\036\376\257\326\311\011\013"
	"\335\322\365\077\355\065\220\017\303\246\241\160\060\055\256\065"
	"\107\242\211\300\071\331\266\364\024\056\222\210\157\253\335\236"
	"\071\066\023\041\272\316\027\310\165\164\034\206\371\254\300\072"
	"\165\137\043\316\272\254\244\120\306\275\062\276\257\211\045\270"
	"\152\021\267\342\177\076\046\123\322\371\137\055\231\333\221\376"
	"\071\116\017\036\207\175\141\151\166\045\166\013\254\044\116\226"
	"\231\213\147\270\342\201\224\237\121\214\306\336\124\344\265\155"
	"\014\021\333\013\237\353\004\127\066\234\365\240\307\063\114\354"
	"\304\263\026\137\150\245\050\372\370\116\325\166\327\062\357\330"
	"\114\222\137\005\013\375\131\011\000\210\223\111\377\111\264\051"
	"\117\203\015\145\060\366\112\177\206\144\365\135\227\345\065\344"
	"\167\225\351\202\223\102\214\223\312\040\335\311\151\221\363\271"
	"\024\001\036\105\367\150\305\175\315\273\333\144\240\020\110\030"
	"\245\061\233\071\163\047\314\075\110\251\007\262\072\373\153\117"
	"\374\211\225\364\362\132\161\300\026\114\044\267\135\155\317\003"
	"\236\152\074\022\222\010\120\332\261\127\214\354\123\367\073\120"
	"\201\321\104\164\053\265\064\101\002\130\371\140\306\310\143\144"
	"\063\237\166\306\250\306\240\132\036\055\106\162\045\202\302\247"
	"\123\006\033\177\274\120\301\277\251\272\037\157\203\202\323\266"
	"\042\112\174\313\021\035\045\060\113\154\242\161\356\145\030\102"
	"\153\064\301\050\204\203\350\056\075\007\235\300\212\161\167\255"
	"\273\364\170\315\022\236\375\136\012\240\317\371\005\350\074\161"
#define      msg1_z	42
#define      msg1	((&data[2953]))
	"\241\201\202\317\277\212\155\177\024\336\014\113\003\222\264\355"
	"\325\137\112\045\242\033\005\350\376\223\143\302\153\367\357\136"
	"\307\252\113\336\255\222\323\225\003\163\233\015\137\056\113\201"
	"\202\256\305\125\367\302\232\354\073\147"
#define      pswd_z	256
#define      pswd	((&data[3056]))
	"\134\344\005\054\335\013\024\031\174\061\030\027\323\231\231\243"
	"\130\043\020\330\070\356\320\372\211\274\065\360\272\016\126\027"
	"\363\133\103\320\147\130\352\344\211\002\373\135\234\224\000\364"
	"\270\020\315\360\377\235\352\240\112\246\137\102\257\302\170\074"
	"\165\362\121\304\030\142\264\211\324\311\354\324\107\360\261\004"
	"\321\250\233\253\000\255\113\112\123\253\214\002\155\005\076\342"
	"\370\220\247\020\362\134\231\306\046\205\233\155\165\115\162\107"
	"\365\016\362\365\273\076\100\016\351\315\021\127\322\120\072\312"
	"\340\341\332\323\076\164\232\144\371\066\322\157\203\104\266\171"
	"\123\251\156\016\347\257\035\321\174\057\050\116\177\142\031\140"
	"\104\364\064\202\151\316\347\142\004\271\322\210\376\210\001\121"
	"\061\160\140\031\037\175\352\233\254\023\352\054\166\004\215\272"
	"\370\301\075\141\217\045\304\224\336\226\035\334\037\036\056\120"
	"\216\216\152\256\013\124\111\270\150\064\345\336\070\162\231\061"
	"\063\327\222\303\374\127\130\332\356\165\267\015\223\345\136\042"
	"\163\310\320\177\035\032\070\205\116\035\143\206\217\375\270\303"
	"\324\112\206\320\242\336\253\220\123\142\236\347\107\374\012\273"
	"\305\332\073\342\365\163\150\104\221\314\313\040\311\203\344\236"
	"\316\152\156\160\111\032\001\235\174\240\204\304\234\216\200\142"
	"\151\273\105\137\057\255\243\210\131\040\171\023\057\317\053\042"
	"\053\157\362\222\307\335\166\121\340\161\256\174\006\256\161\276"
#define      chk1_z	22
#define      chk1	((&data[3338]))
	"\276\274\357\302\363\343\207\012\202\063\353\100\001\125\043\054"
	"\365\067\345\354\050\142\033\333\231\107\064"
#define      msg2_z	19
#define      msg2	((&data[3367]))
	"\350\217\163\343\111\317\073\237\372\120\112\251\031\326\353\130"
	"\063\171\267\237\054\221\012"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
