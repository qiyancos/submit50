#if 0
	shc Version 3.8.6, Generic Script Compiler
	Copyright (c) 1994-2006 Francisco Rosales <frosal@fi.upm.es>

	shc -r -f ./submit50 
#endif

static  char data [] = 
#define      msg1_z	42
#define      msg1	((&data[4]))
	"\260\245\106\233\272\164\237\162\247\331\125\014\202\256\057\142"
	"\363\261\154\107\324\237\147\244\377\313\170\174\004\172\263\201"
	"\271\143\062\276\266\150\024\120\344\354\372\211\323\212\361"
#define      text_z	2936
#define      text	((&data[435]))
	"\107\146\206\170\232\325\070\164\322\131\350\027\265\045\347\026"
	"\035\150\331\161\202\102\235\063\347\343\316\330\266\126\004\376"
	"\274\213\167\126\140\257\313\063\011\264\113\276\331\062\324\367"
	"\233\256\150\036\360\006\121\330\351\040\261\240\166\265\236\062"
	"\101\026\211\242\305\124\325\316\011\041\214\342\124\141\331\357"
	"\020\102\015\001\110\137\331\062\177\213\323\365\100\162\047\202"
	"\210\261\044\115\006\372\034\017\033\251\362\160\013\314\140\033"
	"\016\156\035\127\315\367\211\114\202\134\101\303\316\151\105\127"
	"\032\151\244\040\144\301\060\200\152\042\360\165\356\120\221\375"
	"\276\257\124\213\246\336\327\051\073\031\354\012\202\062\141\235"
	"\234\006\276\000\307\357\200\062\021\160\250\000\300\072\376\177"
	"\351\123\012\217\061\342\270\155\373\245\167\176\327\331\034\163"
	"\337\332\163\247\312\364\332\333\144\202\334\045\274\332\244\245"
	"\056\256\065\137\221\356\315\214\224\104\013\153\036\047\337\376"
	"\002\122\245\314\106\200\247\253\002\204\320\277\137\165\144\215"
	"\044\232\355\265\211\272\101\035\377\115\210\035\164\147\034\166"
	"\272\302\102\001\102\352\254\104\156\175\004\316\362\150\134\027"
	"\003\111\314\214\004\016\251\004\133\062\042\317\232\076\105\124"
	"\000\210\126\102\162\003\207\341\200\213\257\163\364\013\212\370"
	"\125\127\204\131\146\056\135\301\141\177\221\373\276\327\120\276"
	"\137\246\001\321\252\211\262\052\025\142\236\012\155\051\002\303"
	"\201\207\035\347\266\172\250\027\372\071\023\271\021\143\167\160"
	"\012\171\102\264\002\365\337\030\127\175\042\305\247\044\210\050"
	"\253\245\017\142\040\270\171\033\362\214\324\003\360\114\164\372"
	"\305\266\256\310\301\347\260\144\170\113\042\360\262\035\112\275"
	"\064\033\266\156\224\103\334\111\324\246\375\340\011\345\336\330"
	"\117\235\062\137\324\316\150\273\333\174\314\123\315\027\300\215"
	"\167\040\273\142\254\360\352\225\017\217\110\167\105\041\142\272"
	"\257\243\040\317\156\233\017\315\026\235\026\213\270\336\200\336"
	"\150\202\353\303\206\037\213\225\004\104\120\156\223\032\020\046"
	"\366\127\202\046\252\235\336\010\041\250\373\234\053\155\015\301"
	"\020\064\156\334\030\162\245\260\031\270\334\346\030\146\170\023"
	"\113\272\134\215\202\213\115\021\330\210\071\261\025\323\225\123"
	"\363\266\301\222\153\040\055\017\004\311\075\325\255\342\351\117"
	"\200\072\303\227\001\071\275\276\220\261\113\324\237\036\273\004"
	"\305\356\155\036\272\371\011\212\235\036\114\075\071\336\204\246"
	"\073\046\107\142\243\240\044\203\163\055\005\365\017\255\247\241"
	"\123\235\243\174\070\275\125\247\276\245\231\016\203\075\141\226"
	"\156\220\273\162\152\204\241\273\223\272\202\111\040\026\265\050"
	"\271\160\363\017\022\335\357\011\125\010\131\304\141\056\306\141"
	"\221\157\344\305\044\373\320\326\110\013\376\056\351\205\202\057"
	"\134\035\333\127\022\170\051\346\150\012\243\101\152\120\032\037"
	"\047\330\206\357\014\311\120\326\071\143\107\306\020\107\227\223"
	"\167\060\023\320\073\252\107\106\215\101\063\056\022\372\277\045"
	"\156\207\334\217\376\345\230\073\302\330\300\003\101\226\264\146"
	"\234\367\211\344\350\351\335\102\310\046\315\364\110\237\033\027"
	"\320\267\121\340\122\070\355\110\115\374\133\157\362\142\173\255"
	"\334\114\110\241\313\264\213\151\124\274\013\135\130\232\340\015"
	"\104\064\110\332\315\056\050\167\344\146\120\053\163\154\055\356"
	"\121\302\012\276\227\344\120\325\214\217\023\247\151\121\010\136"
	"\333\130\267\006\121\127\135\374\340\225\302\012\227\266\012\330"
	"\114\032\165\121\060\002\212\226\352\270\265\373\346\261\053\125"
	"\110\137\224\031\110\033\257\246\266\310\212\330\061\031\305\241"
	"\354\121\326\060\127\316\133\347\332\122\070\025\156\216\025\342"
	"\244\255\237\224\337\005\313\335\116\350\322\041\314\071\313\251"
	"\240\055\277\131\214\010\127\371\102\353\014\220\206\162\164\061"
	"\260\341\144\264\014\015\061\100\357\266\137\337\361\074\355\023"
	"\044\135\333\254\031\213\257\266\341\361\066\064\241\271\123\244"
	"\124\147\025\252\066\334\247\023\176\014\257\072\236\151\173\211"
	"\133\125\141\035\311\154\341\162\002\357\067\152\001\140\104\007"
	"\015\066\310\115\045\115\345\306\375\223\325\077\012\330\200\356"
	"\120\220\310\150\112\152\045\040\001\371\252\100\213\050\231\262"
	"\012\200\071\336\134\220\267\065\133\076\304\234\166\173\363\046"
	"\332\261\062\230\111\177\116\072\116\155\310\242\243\375\375\310"
	"\065\361\125\370\264\173\376\310\010\371\041\063\211\365\350\006"
	"\202\167\362\121\224\326\044\362\275\142\201\046\077\074\111\223"
	"\116\040\214\176\337\112\200\056\272\034\007\016\021\105\175\341"
	"\311\346\206\067\075\046\116\140\067\107\100\047\262\203\041\130"
	"\353\225\351\004\223\260\342\115\031\143\213\374\074\157\001\147"
	"\246\123\247\251\230\360\313\264\017\175\033\005\363\032\061\011"
	"\042\327\106\163\360\214\030\104\051\021\143\022\176\053\123\334"
	"\015\352\261\273\362\333\342\346\062\067\115\377\042\013\043\376"
	"\055\301\345\017\033\364\374\144\370\266\144\340\371\342\064\252"
	"\051\236\153\004\331\013\050\170\205\167\133\302\164\376\163\260"
	"\030\320\356\260\202\335\217\173\026\013\004\203\264\032\321\133"
	"\112\011\140\223\372\077\373\120\375\017\316\375\260\150\363\011"
	"\211\347\375\130\353\234\174\107\250\056\112\222\125\235\064\323"
	"\177\101\026\162\033\226\175\111\366\312\361\112\146\067\232\304"
	"\002\373\110\321\077\013\322\046\135\357\323\366\061\031\315\044"
	"\334\036\077\172\374\117\062\116\374\134\154\004\315\206\256\257"
	"\157\311\223\116\233\200\347\256\331\156\201\362\370\127\333\327"
	"\127\070\056\202\323\165\365\010\004\067\354\301\232\063\120\021"
	"\003\252\310\243\033\067\026\147\240\204\270\246\014\256\315\222"
	"\372\344\204\316\021\127\035\371\013\032\375\145\262\320\020\312"
	"\047\106\210\014\122\356\061\105\053\201\331\233\310\252\255\173"
	"\017\340\137\103\307\060\041\056\205\154\040\101\146\373\263\333"
	"\341\252\205\323\376\211\025\015\334\056\134\263\071\321\147\343"
	"\073\247\044\176\252\147\007\143\316\147\123\156\055\353\350\347"
	"\164\262\033\322\064\373\147\135\060\274\212\262\114\152\044\255"
	"\174\327\370\357\240\247\053\040\205\024\104\140\052\141\376\277"
	"\200\347\236\302\033\041\162\077\225\075\144\210\156\203\164\310"
	"\207\201\241\147\032\124\150\220\244\236\237\267\357\324\353\325"
	"\041\072\131\357\363\060\062\131\235\245\150\162\120\141\047\227"
	"\156\242\122\263\345\356\070\352\167\070\216\051\007\317\154\064"
	"\253\031\051\041\034\107\374\336\365\044\313\361\253\324\135\261"
	"\241\006\265\102\030\256\301\160\064\253\263\252\071\065\156\166"
	"\336\264\357\171\235\012\256\174\366\335\315\225\363\360\070\213"
	"\040\126\224\136\232\232\147\032\022\325\163\321\226\035\263\035"
	"\011\356\002\235\234\360\316\373\350\155\101\132\370\202\314\045"
	"\151\322\327\161\070\262\143\044\301\026\156\362\355\104\202\340"
	"\251\360\113\272\366\032\040\225\233\077\015\137\300\016\122\351"
	"\261\352\346\140\156\043\201\360\240\367\025\246\326\275\233\357"
	"\352\145\142\224\323\000\113\175\210\207\313\212\324\307\342\234"
	"\057\370\370\131\203\163\122\057\011\174\067\335\053\055\240\370"
	"\242\175\070\100\310\055\124\065\371\143\171\121\303\351\346\161"
	"\225\167\275\105\152\226\026\247\102\111\014\052\122\373\067\304"
	"\277\053\365\015\162\124\013\014\153\330\167\014\131\011\172\070"
	"\134\347\161\245\227\067\233\136\176\262\072\235\162\050\055\270"
	"\004\001\102\335\214\342\106\101\251\253\341\247\373\161\243\275"
	"\013\175\313\245\127\256\036\037\244\337\074\210\046\253\317\342"
	"\364\104\330\157\353\205\252\131\276\232\132\123\111\342\114\174"
	"\205\302\202\363\140\161\101\307\240\070\242\170\352\257\222\214"
	"\254\203\115\343\251\074\325\267\142\220\317\206\131\217\335\305"
	"\353\351\342\051\274\211\342\056\106\012\031\343\022\352\016\016"
	"\105\272\255\114\170\014\103\010\240\000\234\301\047\312\307\004"
	"\013\321\037\006\162\326\306\057\234\057\124\251\356\320\012\241"
	"\327\140\127\062\316\210\161\017\221\062\310\173\127\367\013\127"
	"\016\100\252\311\261\027\141\131\110\155\154\152\005\353\277\024"
	"\360\316\135\370\244\216\011\133\323\363\121\372\215\212\156\354"
	"\020\320\237\125\317\355\061\140\053\020\343\162\123\215\213\272"
	"\276\213\265\105\360\325\010\334\317\137\141\133\002\017\106\206"
	"\242\042\043\012\232\310\305\257\117\307\027\073\167\041\136\141"
	"\116\316\043\240\050\275\356\020\266\330\354\152\265\273\340\014"
	"\067\256\346\041\223\116\025\107\274\343\241\136\074\346\274\334"
	"\025\316\221\041\041\244\060\342\015\201\071\157\302\304\374\147"
	"\272\233\043\210\160\362\037\010\126\204\157\163\111\135\222\245"
	"\225\156\303\073\366\127\315\337\350\234\216\117\061\155\115\102"
	"\117\100\376\331\130\042\377\143\107\056\050\174\040\166\166\143"
	"\155\173\275\255\332\175\367\032\274\240\211\243\331\256\164\226"
	"\023\100\143\075\007\043\142\230\327\051\103\341\202\302\343\360"
	"\117\167\214\265\207\201\020\201\060\202\047\167\025\044\011\177"
	"\001\114\275\265\335\321\211\172\174\071\136\253\372\175\026\030"
	"\356\161\121\051\175\346\112\037\205\303\301\155\336\172\111\315"
	"\050\116\240\136\002\306\354\260\125\327\277\330\002\307\005\361"
	"\352\166\266\225\005\252\115\270\350\311\355\245\047\250\243\037"
	"\057\226\215\040\140\275\225\050\342\124\325\111\372\110\157\146"
	"\200\147\301\154\171\155\336\243\126\041\000\046\367\271\043\067"
	"\177\055\153\224\367\160\345\017\273\366\345\250\245\203\122\246"
	"\013\227\322\153\340\363\316\313\271\357\121\117\311\316\155\225"
	"\130\052\117\276\357\007\133\235\325\306\267\125\152\322\117\100"
	"\202\366\022\322\334\263\324\306\370\067\345\134\010\340\246\270"
	"\207\255\220\027\124\200\034\267\143\206\132\262\105\057\002\044"
	"\043\036\035\063\054\326\020\271\001\375\166\255\144\322\211\226"
	"\305\340\005\046\116\253\115\163\302\022\072\304\210\127\241\064"
	"\064\374\103\206\261\033\345\056\312\303\222\352\354\241\237\136"
	"\076\304\341\323\311\060\314\027\074\376\004\316\130\047\337\117"
	"\345\273\267\373\034\200\201\060\035\207\324\252\070\064\047\251"
	"\042\057\022\060\230\266\115\227\141\335\057\013\147\143\226\042"
	"\337\333\150\326\374\016\034\223\207\064\111\234\254\061\077\247"
	"\213\161\040\347\205\055\060\110\366\213\037\251\372\070\144\170"
	"\102\331\110\357\013\225\311\124\211\103\023\140\113\326\046\174"
	"\346\106\137\300\240\127\153\364\033\104\037\173\342\003\243\332"
	"\003\233\011\026\313\321\147\006\171\270\071\171\325\266\034\165"
	"\370\012\364\266\300\000\354\340\076\321\155\150\061\047\150\060"
	"\360\370\156\115\060\336\010\033\232\204\343\060\102\115\041\106"
	"\325\004\263\261\314\075\121\114\341\053\076\371\122\316\075\211"
	"\153\124\021\064\106\371\020\262\246\360\014\142\140\241\325\265"
	"\154\307\353\006\150\324\274\366\207\150\112\072\224\122\365\115"
	"\230\005\216\074\362\133\075\256\264\146\252\374\040\316\305\013"
	"\262\374\111\347\345\142\001\204\350\252\235\126\147\046\223\260"
	"\125\015\041\223\274\306\244\021\220\142\065\237\346\234\022\360"
	"\344\053\200\063\227\366\066\031\142\332\243\207\277\200\372\122"
	"\256\024\261\152\074\041\361\005\112\220\262\246\341\032\103\267"
	"\335\220\060\367\014\047\031\154\164\043\010\265\167\137\337\045"
	"\344\173\224\307\053\077\176\210\155\020\240\244\161\140\006\363"
	"\370\101\347\056\314\141\163\162\324\365\154\237\313\347\026\102"
	"\315\241\033\171\331\270\020\110\315\351\175\202\017\140\033\064"
	"\313\126\107\263\207\175\212\101\333\132\162\017\202\367\100\206"
	"\112\002\343\127\002\137\010\256\051\076\366\236\333\047\354\306"
	"\274\265\156\042\063\156\264\232\236\242\250\265\247\030\256\111"
	"\356\002\354\232\163\101\061\342\115\015\373\324\206\203\212\162"
	"\360\052\240\375\205\216\131\110\317\363\357\146\300\364\065\244"
	"\225\077\300\107\020\335\317\133\002\017\142\362\230\210\274\335"
	"\104\044\123\173\127\061\273\314\211\002\133\237\332\111\300\216"
	"\144\372\306\246\157\266\056\314\365\000\060\055\257\113\201\117"
	"\362\363\115\113\011\322\017\275\312\112\310\232\262\363\050\246"
	"\363\342\376\350\142\342\021\030\372\333\171\273\022\204\026\356"
	"\101\273\106\237\271\032\022\306\251\267\253\203\067\210\031\134"
	"\372\251\102\114\252\015\036\174\352\072\361\376\252\146\034\030"
	"\027\340\071\345\306\057\074\175\150\304\064\066\004\024\122\162"
	"\207\305\351\021\117\077\105\030\343\246\333\020\010\300\357\077"
	"\130\022\167\142\066\027\264\015\350\050\146\302\170\142\372\153"
	"\336\270\050\227\253\236\201\174\375\234\253\260\073\247\056\061"
	"\100\057\345\101\144\275\030\146\367\274\370\072\215\107\213\124"
	"\217\014\124\361\057\213\376\103\247\207\321\037\037\065\234\004"
	"\026\112\247\250\362\272\175\204\013\060\344\272\073\204\056\073"
	"\055\265\123\234\072\172\246\253\367\322\152\324\221\047\312\145"
	"\204\306\270\255\244\125\345\253\007\043\200\252\275\162\115\112"
	"\206\254\133\213\146\113\263\223\040\242\172\133\241\314\361\362"
	"\075\040\226\213\320\102\305\071\016\147\052\035\113\313\202\370"
	"\030\223\362\363\112\057\337\164\263\271\107\232\104\133\045\244"
	"\015\103\307\241\030\160\215\234\163\204\014\046\031\037\254\353"
	"\121\313\024\224\137\124\325\076\043\027\320\056\303\077\012\366"
	"\126\303\073\356\357\140\114\163\361\057\111\035\225\232\152\342"
	"\170\325\347\273\120\277\157\313\022\031\205\375\072\306\246\344"
	"\276\032\224\303\177\045\076\343\016\032\124\200\034\144\074\065"
	"\073\012\212\324\101\327\127\110\232\346\157\356\213\121\107\231"
	"\377\167\210\307\044\211\026\152\254\174\146\010\113\321\111\357"
	"\136\154\242\215\272\320\262\014\131\370\172\210\103\126\015\024"
	"\325\352\316\240\063\061\033\250\321\167\302\204\365\211\250\224"
	"\151\007\250\005\320\133\073\374\160\161\027\320\133\027\205\156"
	"\220\003\272\013\144\027\355\334\251\242\076\341\273\365\371\111"
	"\027\046\146\023\311\073\334\166\036\320\306\164\066\142\327\330"
	"\064\167\137\032\271\211\023\027\055\315\013\245\334\267\077\373"
	"\000\355\257\046\166\213\203\201\303\341\152\233\241\374\017\020"
	"\032\345\126\151\001\345\303\127\370\160\337\357\111\112\101\044"
	"\123\357\250\044\350\167\322\231\022\054\135\146\026\162\112\165"
	"\020\176\073\030\344\042\000\064\006\207\317\340\254\216\340\003"
	"\013\002\311\263\047\122\333\323\370\353\065\031\243\256\064\225"
	"\073\011\230\053\125\015\045\033\303\324\344\157\142\305\163\156"
	"\307\075\041\356\217\375\302\207\350\367\240\213\245\325\041\341"
	"\337\272\014\065\307\061\120\213\006\065\373\150\372\156\326\301"
	"\254\370\260\073\365\163\303\336\152\144\151\020\072\213\361\031"
	"\105\375\116\015\057\237\230\065\324\223\236\316\002\164\220\256"
	"\155\101\352\142\264\255\100\036\022\252\057\114\066\040\145\174"
	"\036\263\211\115\122\041\203\047\265\041\365"
#define      rlax_z	1
#define      rlax	((&data[3498]))
	"\125"
#define      lsto_z	1
#define      lsto	((&data[3499]))
	"\045"
#define      inlo_z	3
#define      inlo	((&data[3500]))
	"\333\027\133"
#define      chk2_z	19
#define      chk2	((&data[3506]))
	"\021\121\311\344\241\201\254\166\171\342\335\330\220\055\137\052"
	"\231\171\325\311\135\313\135\207\352"
#define      opts_z	1
#define      opts	((&data[3528]))
	"\107"
#define      tst1_z	22
#define      tst1	((&data[3532]))
	"\311\256\331\140\056\317\133\315\375\347\042\262\361\131\207\230"
	"\157\316\212\242\362\053\013\246\221\360\144"
#define      pswd_z	256
#define      pswd	((&data[3614]))
	"\220\154\203\223\063\325\371\257\324\237\111\345\361\023\103\171"
	"\375\006\174\005\175\011\133\106\270\064\067\035\056\035\072\277"
	"\212\276\122\275\223\113\154\147\353\266\115\334\311\220\125\306"
	"\227\322\314\024\334\047\133\225\134\222\324\071\261\346\154\233"
	"\072\040\260\265\005\137\320\023\267\032\323\106\223\060\357\062"
	"\143\231\261\106\336\254\276\247\153\222\341\034\170\116\270\262"
	"\156\150\150\163\310\070\207\177\122\133\305\346\214\264\030\357"
	"\116\311\066\054\165\364\324\341\206\266\376\376\005\266\261\163"
	"\036\031\347\347\122\157\146\245\312\054\213\126\341\244\105\057"
	"\156\173\134\344\157\061\305\365\347\303\364\354\172\246\140\231"
	"\277\110\200\022\267\347\270\202\023\103\330\365\350\035\044\126"
	"\231\201\072\010\262\000\376\232\304\363\207\077\231\350\330\131"
	"\060\130\153\350\077\043\152\123\147\103\110\120\141\155\246\372"
	"\357\341\003\242\342\002\074\247\365\303\346\216\254\276\350\335"
	"\027\123\305\127\167\060\252\337\164\363\057\325\141\326\320\120"
	"\270\324\362\232\327\057\101\314\363\050\133\237\346\103\174\375"
	"\227\102\124\017\162\377\357\347\363\036\275\125\365\215\246\255"
	"\142\231\110\071\310\212\006\274\262\141\133\230\245\327\226\074"
	"\032\353\114\215\353\073\164\336\132\061\064\117\277\332\374\041"
	"\163\105\133\074\317\141\370\201\303\124\262\213\260\355\112\072"
	"\253"
#define      msg2_z	19
#define      msg2	((&data[3881]))
	"\351\145\247\324\366\300\172\207\075\004\172\072\207\204\242\134"
	"\034\166\324\002\224\214\114\033"
#define      date_z	8
#define      date	((time_t*)(&data[3904]))
	"\205\006\253\222\210\056\045\105\361\226\312\034\331"
#define      chk1_z	22
#define      chk1	((&data[3915]))
	"\240\020\071\214\040\232\013\312\304\370\156\136\011\156\057\023"
	"\115\171\325\332\312\322\353\214\112\374\037"
#define      shll_z	10
#define      shll	((&data[3942]))
	"\352\277\377\151\361\106\121\323\026\107\130\323\012"
#define      tst2_z	19
#define      tst2	((&data[3956]))
	"\325\131\314\313\162\077\075\232\336\074\347\367\314\102\267\025"
	"\243\031\264\203\057"
#define      xecc_z	15
#define      xecc	((&data[3976]))
	"\203\077\024\175\342\251\273\153\373\021\335\105\324\255\225\215"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned)chkenv;
	mask ^= (unsigned)getpid() * ~mask;
	sprintf(buff, "x%x", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%u %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%u %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && date[0]<time(NULL))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
