#if 0
	shc Version 3.8.6, Generic Script Compiler
	Copyright (c) 1994-2006 Francisco Rosales <frosal@fi.upm.es>

	shc -r -f ./submit50_1 
#endif

static  char data [] = 
#define      text_z	2889
#define      text	((&data[181]))
	"\221\366\105\312\157\116\055\264\355\253\273\153\131\335\071\326"
	"\242\323\355\226\375\346\333\274\245\127\343\312\045\043\064\267"
	"\032\171\202\211\310\257\076\265\132\371\041\263\326\133\212\171"
	"\056\167\020\054\136\353\350\003\103\314\315\150\360\001\037\012"
	"\173\241\224\103\120\322\371\253\314\032\137\243\165\352\035\244"
	"\141\055\320\277\031\271\303\134\205\220\305\166\222\345\200\016"
	"\206\025\121\327\350\113\202\264\145\342\130\333\314\165\200\056"
	"\243\120\356\274\012\261\031\220\101\337\006\324\304\207\342\113"
	"\235\064\042\205\177\245\072\345\207\223\301\124\010\101\202\254"
	"\222\160\151\234\041\202\055\143\141\064\070\046\273\032\161\131"
	"\116\223\336\315\071\031\263\301\254\164\025\265\265\230\141\110"
	"\010\312\345\052\115\142\120\212\243\006\300\117\001\254\035\140"
	"\250\254\316\344\313\205\165\052\054\303\075\341\373\065\136\157"
	"\314\144\040\172\155\104\253\075\110\166\364\100\312\336\077\303"
	"\361\143\220\101\064\254\251\001\204\100\161\062\357\022\361\157"
	"\161\254\326\305\060\172\163\004\114\370\322\336\161\334\030\052"
	"\246\122\250\302\367\176\135\341\077\255\120\324\044\354\146\344"
	"\142\347\223\350\031\146\140\013\354\144\254\257\101\146\342\067"
	"\265\252\273\151\071\327\231\264\112\177\212\127\005\344\043\231"
	"\006\044\227\103\060\225\312\163\364\265\251\351\044\370\027\164"
	"\200\116\375\276\132\253\026\214\141\121\065\162\355\211\151\160"
	"\347\246\204\261\144\005\375\162\137\004\327\043\214\334\160\272"
	"\243\166\266\166\274\131\054\226\164\267\352\226\157\050\001\163"
	"\360\150\270\033\337\012\234\324\171\225\024\276\215\150\016\150"
	"\006\223\215\114\200\071\136\343\060\135\074\200\034\224\273\005"
	"\375\271\245\054\221\342\040\130\240\060\023\353\146\175\054\136"
	"\226\041\111\161\210\305\072\357\024\204\347\240\120\055\057\005"
	"\353\361\360\230\221\366\306\155\320\271\340\362\145\335\315\172"
	"\113\325\303\326\205\174\111\213\127\265\356\072\341\171\115\137"
	"\325\106\222\261\300\267\014\176\227\351\245\143\165\232\110\152"
	"\104\103\057\045\011\200\032\031\243\033\255\255\116\276\215\175"
	"\243\227\217\115\167\243\112\010\355\005\220\216\221\231\247\232"
	"\255\235\016\161\140\120\237\147\321\360\103\076\022\116\073\165"
	"\000\007\036\341\243\072\364\332\171\051\341\312\221\304\113\230"
	"\060\371\301\023\135\227\261\052\220\226\215\270\026\070\350\340"
	"\330\133\170\021\200\306\173\201\252\243\175\252\272\264\131\102"
	"\366\032\222\352\070\145\260\252\250\066\361\364\221\255\101\255"
	"\112\076\320\111\135\261\300\262\017\177\165\272\152\137\144\264"
	"\337\316\334\354\107\006\173\155\170\343\122\074\326\152\255\024"
	"\212\276\333\365\205\167\065\137\011\254\015\110\165\227\044\127"
	"\342\101\244\307\352\105\367\256\071\341\236\303\304\073\303\035"
	"\276\204\213\035\051\070\103\033\070\304\222\030\167\254\344\226"
	"\232\360\326\134\046\054\071\156\053\320\375\064\016\115\174\032"
	"\231\343\132\376\130\130\003\120\155\334\006\210\157\355\271\047"
	"\247\237\360\357\050\371\266\253\041\344\274\314\152\273\233\040"
	"\105\340\335\061\231\052\200\016\223\155\032\242\321\225\337\276"
	"\131\050\340\145\325\136\265\322\153\311\250\204\116\326\111\206"
	"\363\312\247\073\110\316\035\267\052\040\061\322\374\111\110\116"
	"\241\212\144\331\031\177\277\020\236\306\347\252\203\310\225\277"
	"\264\230\302\304\325\076\172\055\010\133\016\037\302\040\250\320"
	"\175\144\320\352\147\310\353\212\145\111\155\264\247\252\036\171"
	"\145\164\056\302\037\260\300\054\264\071\125\223\034\056\010\252"
	"\355\271\025\061\266\274\127\361\376\157\370\007\373\211\204\060"
	"\002\067\022\051\166\246\115\067\255\141\341\172\167\161\025\204"
	"\360\170\114\262\262\060\125\153\232\214\044\176\241\012\015\273"
	"\325\100\077\131\110\142\266\331\274\277\166\021\063\234\221\025"
	"\250\355\171\303\030\054\377\036\015\047\242\205\252\206\344\226"
	"\071\237\257\323\006\021\206\306\254\116\124\104\272\172\204\363"
	"\105\336\203\116\107\244\262\146\106\063\325\312\161\031\270\060"
	"\162\300\141\016\216\101\137\045\106\016\230\050\350\027\337\157"
	"\036\075\061\372\301\127\035\301\353\167\056\213\225\322\360\336"
	"\372\155\121\164\371\202\240\365\003\170\355\206\064\164\072\074"
	"\261\150\173\035\204\126\151\227\353\261\324\014\051\320\035\342"
	"\350\362\105\327\153\220\003\213\374\066\175\011\147\205\132\230"
	"\165\131\332\073\256\230\002\276\365\215\012\117\233\351\034\326"
	"\375\106\356\377\300\120\315\037\157\277\357\172\252\335\131\353"
	"\162\313\305\131\244\027\054\310\310\267\345\212\127\365\004\346"
	"\366\356\032\062\305\313\341\167\255\161\311\074\053\002\224\324"
	"\034\213\233\200\030\024\337\144\116\201\106\234\034\274\256\066"
	"\234\354\202\007\204\040\254\233\261\327\225\011\176\036\067\057"
	"\172\171\311\210\277\104\127\240\213\310\057\165\077\107\135\024"
	"\014\257\130\031\341\140\124\214\027\132\257\050\326\151\016\322"
	"\207\241\312\312\077\033\076\206\254\272\306\363\235\227\001\331"
	"\155\153\251\231\370\343\021\122\073\327\174\130\236\316\036\305"
	"\235\212\014\265\351\114\245\325\306\304\324\261\173\132\171\023"
	"\201\352\062\253\173\200\374\346\133\311\302\075\135\153\213\363"
	"\003\005\307\001\114\112\055\305\355\156\147\167\374\152\053\034"
	"\106\375\031\002\375\024\045\041\114\070\014\241\163\322\134\134"
	"\270\175\020\210\171\126\344\115\347\374\056\254\247\172\303\074"
	"\305\201\303\271\106\250\033\336\246\110\055\260\213\112\263\303"
	"\273\350\203\222\053\243\167\231\100\337\135\250\272\241\171\313"
	"\074\023\077\265\160\272\225\123\015\061\260\174\306\071\234\321"
	"\302\224\233\243\023\254\077\351\174\244\260\314\030\071\372\236"
	"\234\335\065\130\375\223\075\120\337\177\000\240\110\250\156\066"
	"\057\225\333\270\315\163\204\153\036\137\012\122\053\017\011\232"
	"\375\134\315\241\062\232\045\246\142\173\001\007\201\207\155\235"
	"\360\331\027\010\370\005\342\255\312\024\100\241\267\063\306\123"
	"\036\001\377\366\360\235\367\316\170\340\227\132\233\270\117\054"
	"\144\232\145\161\047\300\316\276\001\217\131\376\143\161\203\151"
	"\334\361\374\074\027\074\347\011\026\371\022\134\354\157\124\164"
	"\111\231\167\067\044\147\015\355\210\306\160\171\271\150\343\057"
	"\231\226\375\334\154\153\037\342\073\050\064\143\135\104\226\146"
	"\110\270\173\366\031\247\011\035\221\346\112\012\227\273\225\036"
	"\366\175\064\276\145\033\361\157\274\147\115\243\225\163\166\223"
	"\314\112\140\026\361\062\076\140\350\154\170\360\120\005\023\320"
	"\320\371\101\126\117\225\122\153\322\345\174\072\247\024\322\317"
	"\127\242\312\161\057\013\061\372\224\247\035\260\174\321\005\045"
	"\201\220\360\310\074\255\272\036\023\171\112\160\135\211\013\312"
	"\070\241\342\044\325\357\016\047\331\075\014\353\330\163\020\101"
	"\041\101\146\017\366\003\321\366\063\002\030\247\141\123\022\161"
	"\075\315\177\047\044\063\053\146\333\232\257\001\337\213\356\213"
	"\257\312\276\315\313\162\345\235\006\057\306\315\012\052\176\104"
	"\375\161\263\167\303\210\375\333\070\043\107\357\255\172\374\035"
	"\300\003\046\070\313\251\065\072\114\356\123\351\376\250\134\236"
	"\127\272\253\131\156\276\140\126\117\055\354\270\037\026\012\055"
	"\120\362\166\166\205\146\153\045\045\222\030\224\225\111\200\121"
	"\174\267\153\273\235\334\005\020\007\026\274\351\360\261\125\271"
	"\115\175\152\041\223\366\172\270\073\315\113\136\245\215\327\207"
	"\340\212\066\121\021\214\353\237\213\264\053\360\021\012\110\222"
	"\002\327\353\033\366\255\041\237\171\000\354\313\051\036\107\346"
	"\061\042\335\016\260\377\164\345\256\245\016\300\262\323\011\114"
	"\370\004\344\273\202\304\065\017\156\326\201\276\211\372\176\336"
	"\247\230\304\130\113\354\175\200\111\344\043\144\150\221\277\221"
	"\205\314\350\224\325\045\013\237\356\264\140\164\152\271\224\115"
	"\305\176\313\352\131\246\165\346\355\011\302\151\314\201\255\166"
	"\162\203\240\271\277\204\333\031\006\120\361\123\204\222\131\310"
	"\007\352\344\231\063\212\313\366\172\206\005\307\044\364\214\315"
	"\333\327\373\143\114\005\144\075\001\140\231\256\231\157\221\227"
	"\160\131\257\155\252\045\336\041\054\153\330\246\251\121\264\250"
	"\310\155\116\146\165\276\303\363\012\152\174\164\172\203\176\155"
	"\067\023\163\016\151\060\122\233\020\342\026\263\121\360\127\214"
	"\267\327\013\135\235\102\351\123\207\010\367\336\136\142\071\153"
	"\323\214\171\063\072\117\052\143\156\121\256\047\324\221\374\332"
	"\142\115\032\313\001\145\303\075\346\114\027\176\271\157\334\130"
	"\200\337\217\265\246\333\366\360\031\255\200\313\172\052\250\164"
	"\163\271\045\125\245\245\074\110\353\152\045\245\272\020\320\173"
	"\117\246\263\001\021\375\337\145\375\130\155\054\300\042\325\141"
	"\340\220\363\223\274\352\253\024\103\001\340\212\101\274\172\366"
	"\237\002\262\126\174\042\114\031\263\203\162\062\116\252\130\157"
	"\045\351\134\266\235\317\037\221\253\127\277\376\076\353\051\136"
	"\040\231\110\060\313\320\000\166\355\302\144\233\311\036\213\203"
	"\154\131\244\144\305\305\046\115\014\134\211\350\053\246\261\127"
	"\225\024\123\152\321\061\120\240\170\062\156\022\050\231\300\027"
	"\106\217\152\300\356\375\021\037\052\344\227\222\236\361\232\006"
	"\150\317\200\103\216\013\232\266\141\370\147\317\237\171\256\260"
	"\304\127\301\333\136\367\373\070\326\101\300\143\301\030\012\126"
	"\377\361\222\312\217\220\252\133\327\223\261\224\000\134\024\302"
	"\117\152\044\315\071\262\307\025\255\204\215\112\263\200\356\204"
	"\241\325\146\220\335\161\234\230\240\140\055\070\321\243\134\051"
	"\237\106\140\033\250\365\206\363\312\272\351\215\020\141\233\265"
	"\107\140\057\177\007\244\030\077\223\011\072\010\376\312\361\126"
	"\175\277\334\024\152\270\371\103\140\345\330\205\022\170\024\130"
	"\000\033\211\052\314\301\371\177\050\005\257\305\133\113\146\135"
	"\230\167\102\372\324\146\255\367\025\032\041\061\055\257\251\161"
	"\334\111\251\133\157\167\003\117\164\314\373\045\326\053\302\073"
	"\130\011\215\265\001\234\000\247\051\321\201\213\324\075\375\327"
	"\246\215\033\160\117\211\351\056\305\370\321\001\203\230\202\121"
	"\332\275\277\220\033\024\163\326\311\104\100\273\043\035\007\134"
	"\174\055\174\070\026\065\166\361\272\020\304\043\333\330\243\322"
	"\364\004\043\232\067\204\164\024\136\210\104\001\310\342\322\136"
	"\302\150\053\234\317\022\231\127\306\322\245\352\041\014\001\167"
	"\006\373\240\340\362\124\007\141\073\110\255\170\211\341\144\161"
	"\347\336\145\172\072\300\222\207\377\204\063\314\136\337\246\023"
	"\346\324\043\152\174\107\253\253\265\220\224\127\160\367\175\210"
	"\076\357\172\063\361\000\200\024\041\336\032\020\313\276\115\205"
	"\145\327\246\334\265\054\117\055\327\306\032\166\027\275\236\317"
	"\116\022\356\225\373\153\042\357\376\207\201\001\307\137\301\303"
	"\060\105\210\022\376\366\130\227\307\150\142\022\240\326\331\153"
	"\161\247\341\373\260\071\102\125\266\343\341\070\132\025\233\213"
	"\305\204\274\275\040\335\024\154\103\365\102\066\172\014\045\264"
	"\330\321\307\134\370\201\151\347\231\324\270\223\031\233\363\074"
	"\070\013\371\152\330\205\133\134\163\350\336\157\334\325\175\276"
	"\022\051\067\133\154\343\147\247\040\353\153\003\007\143\355\053"
	"\301\100\300\206\155\175\325\052\333\216\237\171\310\007\226\154"
	"\045\316\212\342\214\366\257\370\060\001\247\056\000\372\251\153"
	"\122\010\004\224\354\173\242\131\020\115\205\344\264\266\002\325"
	"\337\024\377\160\144\045\314\315\334\101\176\234\242\247\307\050"
	"\116\176\307\367\171\264\260\314\105\315\035\106\132\131\034\122"
	"\274\121\354\371\034\263\315\132\025\106\052\136\336\051\131\023"
	"\116\173\134\100\127\262\051\210\273\075\133\013\352\337\055\370"
	"\374\161\002\306\121\031\175\051\173\017\357\052\043\060\074\044"
	"\350\162\132\142\044\027\032\060\251\105\223\166\130\130\142\225"
	"\044\343\001\053\160\071\262\017\324\206\007\107\273\010\162\035"
	"\251\255\020\010\031\220\205\313\161\066\077\301\343\305\171\144"
	"\076\172\056\101\057\123\040\177\265\346\026\372\331\066\210\377"
	"\102\233\345\170\000\142\222\064\215\251\377\110\140\263\355\143"
	"\127\161\351\012\003\207\364\177\125\276\303\324\271\241\304\336"
	"\356\127\237\031\133\121\230\332\123\370\275\331\011\322\235\216"
	"\303\361\322\262\036\253\065\040\352\171\370\170\357\301\161\232"
	"\037\233\070\145\306\075\013\032\171\225\111\050\361\134\137\010"
	"\054\367\022\300\367\115\350\245\230\254\007\005\147\011\250\354"
	"\176\267\170\124\121\340\150\025\141\347\172\213\006\077\076\046"
	"\350\237\305\312\075\310\022\320\123\041\132\300\055\031\107\365"
	"\121\356\373\100\144\217\340\210\225\156\226\151\346\317\130\114"
	"\303\366\346\101\151\053\201\031\175\260\034\237\227\051\325\023"
	"\117\202\220\003\067\171\103\242\117\302\075\237\013\120\074\351"
	"\055\304\354\173\242\147\301\026\040\326\374\277\277\177\174\104"
	"\361\235\130\371\016\326\275\027\236\030\226\004\134\343\305\071"
	"\132\204\355\215\033\365\332\244\302\030\163\176\113\216\341\216"
	"\331\273\125\302\353\347\145\300\353\344\175\224\332\261\022\011"
	"\131\224\226\107\323\075\254\241\153\334\160\115\321\356\151\357"
	"\364\162\136\102\230\271\017\112\040\364\105\023\230\145\022\216"
	"\257\106\306\325\002\341\106\133\057\332\072\375\023\123\260\325"
	"\377\044\353\264\332\203\025\042\214\340\007\266\055\031\105\334"
	"\140\014\261\143\355\370\276\034\322\371\032\346\114\312\273\113"
	"\357\246\000\311\051\025\354\265\366\363\154\043\015\262\377\156"
	"\276\261\321\253\251\220\310\174\211\343\142\326\255\035\041\235"
	"\304\041\147\355\067\123\243\055\107\020\121\125\303\121\303\202"
	"\002\225\056\254\046\366\050\260\331\212\206\207\250\247\045\154"
	"\311\214\132\001\340\375\057\047\016\200\175\322\321\100\124\324"
	"\326\202\200\374\170\250\254\122\063\062\332\333\332\000\107\244"
	"\214\241\246\155\237\325\225\255\126\022\177\047\123\324\374\051"
	"\126\174\046\317\045\323\042\130\006\374\063\340\375\172\205\212"
	"\033\054\367\272\001\214\150\130\236\350\200\362\274\174\033\022"
	"\370\102\342\035\025\004\166\033\001\251\374\376\043\202\210\077"
	"\256\177\372\260\014\143\010\253\114\210\235\010\005\271\033\375"
	"\373\375\033\021\001\221\054\002\073\051\001\137\253\211\236\132"
	"\011\231\012\025\375\023\300\111\234\136\122\241\027\155\237\023"
	"\153\273\045\155\114\122\160\210\173\161\347\047\372\206\201\003"
	"\037\214\031\034\237\332\145\073\070\267\335\120\045\174\144\221"
	"\067\211\376\204\333\156\014\127\340\363"
#define      tst1_z	22
#define      tst1	((&data[3375]))
	"\000\336\230\214\370\022\161\222\315\242\253\037\277\117\366\153"
	"\263\153\115\216\363\226\262\350\171\262\061\265\054"
#define      tst2_z	19
#define      tst2	((&data[3399]))
	"\043\257\074\313\103\052\253\320\234\105\335\067\007\175\347\220"
	"\115\354\127\013\323"
#define      inlo_z	3
#define      inlo	((&data[3420]))
	"\113\077\023"
#define      opts_z	1
#define      opts	((&data[3423]))
	"\065"
#define      chk2_z	19
#define      chk2	((&data[3425]))
	"\174\076\325\120\005\252\355\063\307\252\350\273\042\221\372\164"
	"\030\367\326\107\046\367"
#define      chk1_z	22
#define      chk1	((&data[3448]))
	"\174\373\230\150\112\073\325\346\107\156\022\365\323\307\254\250"
	"\021\214\265\063\365\321\323\210\262\366\373\220\217"
#define      msg2_z	19
#define      msg2	((&data[3477]))
	"\264\133\035\357\004\305\261\022\020\233\131\374\331\014\303\171"
	"\113\346\207\015\174\140"
#define      msg1_z	42
#define      msg1	((&data[3501]))
	"\141\302\053\042\376\007\122\210\343\364\236\307\212\037\047\247"
	"\037\125\146\327\112\231\114\017\344\371\154\307\153\076\066\301"
	"\250\017\123\274\342\067\325\303\261\066\251\326\117\220\203\265"
#define      date_z	8
#define      date	((time_t*)(&data[3552]))
	"\230\363\065\041\160\014\236\342\164\163\312\334\344\021\350"
#define      lsto_z	1
#define      lsto	((&data[3560]))
	"\312"
#define      rlax_z	1
#define      rlax	((&data[3561]))
	"\126"
#define      pswd_z	256
#define      pswd	((&data[3617]))
	"\245\064\310\301\233\373\042\135\047\105\341\335\140\256\033\370"
	"\242\121\032\022\136\270\177\035\114\350\155\160\331\106\330\176"
	"\172\240\100\025\234\142\163\303\250\124\240\010\003\274\001\245"
	"\015\034\270\153\324\070\211\032\277\046\071\105\040\341\025\331"
	"\236\177\234\127\167\007\147\154\362\120\110\215\316\206\254\012"
	"\174\177\342\110\116\323\142\015\372\233\122\032\174\150\363\033"
	"\347\217\163\137\227\332\314\211\053\025\027\371\233\303\003\030"
	"\103\346\140\222\272\302\237\264\135\362\316\332\133\302\365\103"
	"\122\150\242\352\103\157\164\156\205\213\147\041\117\153\071\223"
	"\122\231\045\014\133\305\300\271\270\217\223\023\122\211\126\245"
	"\362\371\217\065\151\003\243\356\217\013\017\336\167\110\161\311"
	"\342\226\325\076\134\226\367\024\046\213\050\170\025\176\035\007"
	"\170\255\075\341\260\341\320\077\355\337\036\144\050\217\055\012"
	"\046\003\110\202\231\100\227\277\314\277\070\341\075\125\351\266"
	"\003\046\230\263\010\150\363\365\110\021\132\160\241\207\173\310"
	"\212\304\112\044\005\341\343\321\241\034\262\337\161\234\225\165"
	"\303\055\050\313\226\034\301\336\056\033\117\320\243\313\230\055"
	"\220\343\122\225\305\066\147\146\122\031\105\304\266\332\071\171"
	"\010\142\104\237\176\006\176\255\042\316\175\305\231\026\363\051"
	"\371\105\277\276\173\046\044\041\040\366\222\371\074\152\167\267"
	"\013\267\315\247\032\101\153\302\226\014\313\231\311\315\077\326"
	"\351"
#define      shll_z	10
#define      shll	((&data[3899]))
	"\374\330\336\157\156\316\250\012\077\317\060\313"
#define      xecc_z	15
#define      xecc	((&data[3912]))
	"\161\210\167\272\252\001\054\221\014\311\062\212\324\176\230\155"
	"\111\376\334"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned)chkenv;
	mask ^= (unsigned)getpid() * ~mask;
	sprintf(buff, "x%x", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%u %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%u %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && date[0]<time(NULL))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
