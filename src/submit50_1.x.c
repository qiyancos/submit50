#if 0
	shc Version 3.8.6, Generic Script Compiler
	Copyright (c) 1994-2006 Francisco Rosales <frosal@fi.upm.es>

	shc -r -f ./submit50_1 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\306"
#define      tst1_z	22
#define      tst1	((&data[6]))
	"\247\242\267\346\363\120\001\307\234\264\221\131\037\047\346\261"
	"\227\334\157\264\336\311\241\047\336\346\267\011\350\156\167"
#define      chk1_z	22
#define      chk1	((&data[34]))
	"\042\166\146\024\261\276\145\175\220\256\212\235\341\277\205\242"
	"\040\034\345\074\065\271\222\035\036\163\373\023\021"
#define      date_z	8
#define      date	((time_t*)(&data[64]))
	"\270\223\173\217\020\157\273\103\015\022\041"
#define      lsto_z	1
#define      lsto	((&data[72]))
	"\232"
#define      tst2_z	19
#define      tst2	((&data[75]))
	"\214\053\062\004\155\365\020\054\033\320\220\336\264\363\033\313"
	"\061\144\245\064\336"
#define      text_z	3101
#define      text	((&data[440]))
	"\335\132\215\124\326\347\107\370\136\146\153\132\172\175\212\011"
	"\216\103\234\012\254\065\166\220\276\223\035\351\147\217\010\104"
	"\352\225\230\300\175\337\270\333\106\044\065\300\241\300\311\060"
	"\003\145\072\260\233\261\101\132\105\136\104\254\355\114\360\327"
	"\342\210\230\137\150\121\073\256\165\160\157\027\061\071\110\065"
	"\237\203\346\073\065\047\226\172\205\332\047\163\047\027\113\011"
	"\240\343\151\011\065\244\270\253\025\047\303\107\141\013\174\000"
	"\217\142\074\304\212\322\077\020\255\147\203\324\176\317\336\037"
	"\263\110\050\350\355\340\224\002\010\127\111\151\143\306\152\362"
	"\051\247\267\263\171\367\304\047\136\110\373\335\027\332\374\313"
	"\043\045\264\020\006\110\023\016\237\134\170\002\043\343\365\114"
	"\212\254\000\004\244\304\053\002\014\047\340\044\002\335\357\045"
	"\002\243\066\010\353\111\027\213\245\220\215\311\163\203\026\376"
	"\057\026\003\324\333\056\327\350\126\267\014\130\224\373\176\227"
	"\237\264\237\213\375\267\026\243\107\244\154\273\047\202\271\127"
	"\231\274\054\165\353\003\135\101\272\151\232\117\145\030\346\004"
	"\315\206\220\312\075\247\156\205\113\333\100\163\136\372\313\367"
	"\266\367\155\241\372\312\343\265\063\175\004\231\226\352\236\143"
	"\160\056\056\256\325\235\063\041\170\164\225\326\156\140\316\044"
	"\130\073\306\123\005\252\010\071\050\014\322\276\367\160\042\150"
	"\236\121\027\164\356\112\225\146\277\052\075\055\213\013\122\344"
	"\106\031\067\114\303\077\205\353\114\127\327\265\373\022\054\261"
	"\071\242\131\047\124\270\372\226\241\307\233\347\256\026\104\077"
	"\043\033\263\074\316\265\377\074\104\144\266\006\343\061\006\310"
	"\277\313\305\124\357\315\226\164\207\113\305\004\266\310\117\050"
	"\043\320\011\235\335\032\061\125\242\355\147\205\025\145\044\213"
	"\077\263\375\360\135\226\335\170\004\113\135\167\112\346\044\002"
	"\304\222\117\052\142\200\064\236\017\243\025\270\003\145\003\064"
	"\337\074\335\240\122\200\206\241\346\176\344\342\215\327\353\331"
	"\231\150\155\154\124\153\136\333\147\211\215\326\301\245\067\334"
	"\140\043\265\035\126\045\265\354\040\211\204\307\324\035\205\034"
	"\314\111\255\344\241\374\213\164\006\316\113\243\134\377\026\365"
	"\140\133\172\067\040\262\134\235\061\173\125\063\114\144\347\064"
	"\155\365\074\056\112\244\170\002\070\176\250\027\145\050\213\365"
	"\111\027\173\152\154\147\260\034\066\354\271\220\023\140\030\121"
	"\310\260\221\201\202\114\355\244\115\074\106\353\331\113\051\010"
	"\370\341\257\130\040\071\356\203\040\225\315\322\057\300\151\365"
	"\250\160\163\213\012\271\006\302\321\161\100\010\064\233\372\001"
	"\220\204\257\072\033\254\351\035\067\214\303\273\353\231\122\154"
	"\153\364\201\264\206\146\177\130\345\163\036\315\276\131\047\054"
	"\300\000\206\301\052\037\235\156\232\077\034\274\332\220\364\146"
	"\360\342\245\175\142\032\050\330\075\301\352\367\346\227\267\260"
	"\162\353\231\274\300\004\314\221\107\163\342\174\247\031\120\241"
	"\240\115\141\313\000\223\253\033\277\113\266\053\215\151\023\021"
	"\303\050\101\320\112\051\240\375\076\161\327\267\211\001\224\060"
	"\364\035\101\155\343\105\041\020\000\011\323\275\237\116\061\302"
	"\220\014\014\222\115\374\374\346\075\040\216\104\065\106\063\037"
	"\216\155\377\331\006\264\355\207\112\301\340\153\070\276\150\251"
	"\266\034\112\105\242\333\150\174\002\331\164\036\377\141\176\225"
	"\120\022\163\031\224\035\227\047\102\346\260\074\240\160\125\307"
	"\150\124\151\011\035\041\375\316\034\337\012\130\040\015\012\275"
	"\026\200\233\202\166\350\140\023\175\335\377\131\166\342\342\223"
	"\132\120\366\162\047\245\304\163\323\367\177\163\333\022\103\146"
	"\140\102\362\300\224\375\275\105\375\151\361\203\147\210\376\305"
	"\170\222\156\120\145\174\303\365\046\002\262\102\332\075\116\154"
	"\205\066\043\360\061\105\163\022\040\172\223\307\375\312\135\247"
	"\020\071\312\020\332\041\321\154\176\351\106\062\177\341\165\103"
	"\102\330\343\135\021\004\172\316\152\355\057\075\246\327\063\160"
	"\106\076\247\363\363\010\177\346\016\022\011\305\154\227\055\307"
	"\377\026\356\201\154\030\320\012\211\250\346\222\177\034\123\243"
	"\235\071\066\331\026\246\101\232\002\101\326\112\011\041\132\205"
	"\017\105\357\100\041\237\056\372\231\235\236\057\131\122\241\065"
	"\336\022\244\042\230\003\206\176\117\047\052\014\105\056\140\056"
	"\030\304\100\127\320\103\340\044\276\045\165\140\164\225\276\265"
	"\046\274\161\205\061\026\261\074\210\340\262\321\061\207\110\050"
	"\221\011\120\021\154\004\153\151\175\005\265\122\363\041\114\113"
	"\321\066\257\104\301\132\126\126\144\162\011\247\140\360\100\013"
	"\217\011\310\200\121\003\331\011\300\052\007\012\242\367\033\332"
	"\036\012\140\120\030\051\376\040\131\157\021\367\357\070\334\053"
	"\363\367\060\236\223\006\162\206\026\205\213\162\172\072\245\352"
	"\051\145\174\237\265\351\111\361\342\117\021\117\025\331\146\031"
	"\113\243\100\024\253\363\055\001\010\011\154\127\165\274\120\063"
	"\217\350\017\261\016\261\164\374\236\167\172\000\000\320\044\064"
	"\310\203\133\127\163\146\123\017\025\310\107\304\015\021\352\006"
	"\262\204\026\134\150\127\236\226\222\335\345\167\347\226\005\366"
	"\356\357\050\213\024\346\076\232\377\026\043\067\040\150\155\127"
	"\223\332\123\100\142\360\173\206\115\240\325\010\033\001\021\020"
	"\166\122\315\162\200\367\127\056\374\252\060\053\241\053\256\245"
	"\102\245\204\165\372\255\262\141\262\020\375\331\074\225\200\047"
	"\047\312\167\322\327\235\217\372\276\332\261\141\056\307\307\035"
	"\065\273\243\156\355\131\345\036\372\014\071\324\037\101\170\272"
	"\062\245\336\255\342\310\157\044\366\254\225\363\007\203\232\072"
	"\076\041\166\235\363\214\021\373\052\102\107\347\020\264\167\142"
	"\317\176\267\372\152\302\273\315\045\345\134\000\036\304\160\221"
	"\017\272\352\122\046\351\007\317\124\214\376\357\305\123\062\252"
	"\255\164\236\041\112\340\255\012\106\275\074\100\333\054\353\035"
	"\234\172\020\114\010\266\144\250\350\152\124\320\007\273\213\232"
	"\131\071\220\045\255\104\262\253\175\150\302\153\305\355\324\340"
	"\335\264\227\376\374\161\030\177\121\003\245\021\347\217\112\157"
	"\077\272\021\161\250\174\022\247\024\146\344\002\055\152\011\263"
	"\323\272\237\262\243\021\141\227\335\357\200\043\247\061\263\155"
	"\117\307\211\340\124\176\207\020\030\040\150\356\362\206\245\235"
	"\315\170\266\267\206\364\251\107\265\122\372\127\034\204\260\174"
	"\157\245\110\240\121\165\024\133\235\042\122\231\046\156\300\023"
	"\355\204\065\144\155\320\177\205\070\127\031\125\206\070\143\353"
	"\072\004\037\000\377\376\167\100\342\351\047\306\304\161\144\227"
	"\161\135\012\013\240\232\213\366\015\162\024\102\057\020\100\223"
	"\103\165\115\143\162\022\274\365\131\246\156\076\020\130\365\310"
	"\045\124\244\365\143\340\176\154\046\172\263\163\054\231\127\164"
	"\037\323\231\207\016\013\272\024\301\144\300\312\100\322\163\210"
	"\071\201\155\175\215\000\106\104\305\312\361\236\253\076\151\302"
	"\304\357\023\074\361\042\004\305\233\013\074\173\342\137\207\352"
	"\153\112\327\113\303\267\163\271\247\073\342\026\251\266\160\342"
	"\205\213\267\065\331\344\126\243\025\304\220\072\340\267\134\065"
	"\161\221\246\017\306\155\327\337\205\337\015\151\276\325\045\105"
	"\312\313\073\376\364\005\272\251\247\256\233\232\173\204\227\134"
	"\155\122\213\032\142\160\253\216\365\137\363\010\012\024\075\006"
	"\156\236\204\003\000\171\233\023\225\153\242\176\041\273\001\165"
	"\141\164\024\077\330\116\314\113\326\120\061\055\004\330\140\243"
	"\000\165\135\043\140\276\017\016\111\134\264\255\300\004\346\146"
	"\015\016\025\256\047\143\163\234\225\032\365\130\151\067\144\136"
	"\364\311\071\133\210\127\302\065\140\051\371\036\044\302\137\301"
	"\051\357\275\036\310\026\263\350\331\041\363\221\315\202\023\360"
	"\040\346\015\244\366\363\027\357\213\315\267\312\054\253\120\176"
	"\011\156\254\107\052\115\120\250\263\115\173\175\321\053\363\076"
	"\150\310\217\021\034\052\343\034\201\136\101\247\165\351\361\360"
	"\242\000\326\011\140\061\044\304\203\144\325\254\176\014\160\037"
	"\200\233\126\046\055\065\024\256\031\036\361\252\164\130\227\130"
	"\272\014\044\071\004\210\245\375\072\267\047\120\036\202\362\130"
	"\340\147\226\242\362\032\315\344\350\224\053\132\031\003\165\027"
	"\317\311\011\014\235\245\124\276\151\001\256\315\273\361\016\335"
	"\026\264\176\115\010\302\257\151\100\214\107\036\023\064\130\111"
	"\216\377\154\002\134\303\035\021\345\131\246\364\235\240\221\255"
	"\122\243\055\024\032\340\303\217\312\053\214\165\070\047\121\167"
	"\164\103\250\343\070\304\135\001\221\153\047\036\322\017\245\042"
	"\015\250\257\150\120\357\067\010\361\075\235\221\247\221\233\043"
	"\070\322\320\013\376\246\143\135\317\264\310\104\375\250\321\177"
	"\346\316\134\020\245\267\206\205\314\067\017\145\363\260\232\233"
	"\242\354\337\132\230\201\207\151\052\246\150\113\246\162\336\330"
	"\161\113\147\075\274\304\013\312\117\001\130\034\125\010\135\066"
	"\303\367\262\356\037\237\241\275\155\015\330\346\136\257\070\350"
	"\336\326\344\202\356\007\373\106\243\060\033\055\002\267\337\122"
	"\030\120\203\230\165\052\306\001\040\233\304\007\374\256\114\075"
	"\057\271\306\001\301\052\154\137\341\312\023\056\021\033\273\014"
	"\363\122\250\263\031\176\045\123\375\343\003\215\025\314\352\147"
	"\131\212\357\324\026\147\341\322\227\042\267\010\076\032\253\316"
	"\250\374\146\122\353\027\335\325\142\265\054\230\174\272\055\372"
	"\055\127\124\213\347\315\142\315\132\212\063\055\323\371\231\032"
	"\224\333\024\300\044\340\312\311\023\210\243\326\033\303\274\346"
	"\317\236\213\143\103\046\050\152\173\326\326\177\165\371\372\301"
	"\011\250\146\120\134\125\103\300\174\323\221\064\265\331\156\117"
	"\135\202\167\134\230\261\254\013\136\165\067\135\144\135\172\035"
	"\311\115\364\051\255\206\067\173\026\213\110\371\047\004\315\146"
	"\216\262\173\303\037\260\162\121\127\044\250\274\110\062\305\307"
	"\204\115\162\134\142\325\030\331\053\175\145\071\301\277\271\123"
	"\341\243\255\074\003\157\377\362\313\325\021\302\346\141\334\041"
	"\002\035\206\114\050\222\302\255\055\355\346\005\244\253\163\017"
	"\175\166\227\315\033\147\376\237\155\202\176\042\345\015\357\023"
	"\156\247\240\326\047\254\033\220\165\360\163\102\335\272\165\241"
	"\227\070\112\146\256\033\362\336\147\143\073\274\027\323\016\177"
	"\360\155\201\275\331\161\066\375\072\362\112\306\364\235\242\337"
	"\073\024\216\160\160\051\162\014\204\343\361\354\361\135\173\246"
	"\043\273\070\012\237\224\121\042\034\065\046\167\171\177\124\102"
	"\322\033\014\066\311\275\172\351\371\377\367\037\253\000\253\372"
	"\251\110\365\226\364\276\037\152\150\232\323\307\344\111\120\075"
	"\110\121\130\203\246\330\052\311\022\137\346\055\043\035\267\110"
	"\346\073\267\071\031\251\354\245\340\333\356\155\036\245\162\013"
	"\317\105\124\152\224\327\215\215\214\020\210\115\042\221\046\063"
	"\237\027\025\064\157\244\165\365\256\350\003\326\254\245\155\263"
	"\052\056\342\226\013\176\100\154\011\064\021\061\150\063\144\371"
	"\305\332\004\034\322\050\217\246\336\311\102\027\306\031\110\317"
	"\335\010\151\121\006\004\032\233\225\354\126\124\316\153\002\153"
	"\037\074\045\316\374\162\022\252\033\356\000\147\204\304\205\002"
	"\076\113\217\323\235\100\107\004\227\270\152\041\275\060\270\160"
	"\027\223\154\245\313\356\010\123\221\115\102\311\251\276\376\317"
	"\056\073\236\367\124\001\371\271\317\263\125\340\262\346\305\210"
	"\002\121\154\335\146\021\136\374\034\175\275\157\153\227\210\307"
	"\153\275\005\240\103\126\061\254\100\053\347\150\313\207\355\167"
	"\044\052\146\374\160\303\101\164\111\272\305\264\024\241\142\164"
	"\321\137\034\305\104\053\013\303\261\365\240\326\346\131\113\313"
	"\336\033\346\244\024\330\004\163\165\227\176\303\215\317\300\126"
	"\153\266\061\115\353\201\063\015\336\350\272\103\350\011\100\342"
	"\011\130\320\157\232\244\033\265\214\311\342\302\116\251\010\076"
	"\040\176\370\034\065\340\327\212\044\022\302\246\141\031\165\167"
	"\117\010\171\242\042\026\115\020\334\022\366\107\016\220\077\156"
	"\100\231\300\204\366\077\276\363\324\302\271\137\342\044\311\234"
	"\202\110\006\205\107\355\052\036\102\161\037\201\165\343\105\227"
	"\067\111\166\126\015\346\115\062\022\222\145\327\072\030\231\351"
	"\176\306\022\206\357\305\043\062\145\355\345\377\354\176\343\064"
	"\260\112\257\341\160\077\370\047\161\222\031\055\301\047\003\256"
	"\034\120\266\231\247\170\270\332\247\073\302\365\042\045\255\223"
	"\161\367\373\236\364\327\215\242\015\153\373\340\132\044\363\315"
	"\033\126\227\126\227\200\330\043\044\120\066\246\331\173\100\042"
	"\336\346\013\243\212\256\300\054\353\131\316\262\061\242\106\124"
	"\275\265\105\244\212\336\335\344\234\201\335\314\006\226\037\127"
	"\244\170\314\244\346\113\143\132\220\352\102\312\265\073\016\016"
	"\211\366\370\021\210\366\244\255\232\363\012\011\207\333\153\130"
	"\112\146\124\062\160\361\351\054\344\127\366\212\077\210\047\125"
	"\350\224\211\341\321\112\054\147\257\353\340\171\264\231\112\076"
	"\122\113\001\011\235\252\054\162\225\314\371\073\052\363\174\222"
	"\103\304\314\257\343\050\376\333\003\356\175\270\104\016\156\230"
	"\221\215\132\022\303\033\246\370\025\352\142\147\255\124\330\244"
	"\066\303\165\035\350\131\057\361\141\122\256\172\022\321\325\222"
	"\156\135\015\351\053\125\211\100\035\201\203\254\105\257\062\002"
	"\112\257\263\322\027\374\140\036\064\347\231\003\026\243\036\236"
	"\023\003\311\375\036\134\154\312\254\132\106\037\345\226\142\313"
	"\233\125\360\327\026\123\305\162\036\374\360\372\066\351\334\242"
	"\316\214\310\276\022\264\247\326\201\145\122\141\367\102\310\341"
	"\306\255\156\053\240\074\221\013\316\232\156\122\212\313\216\267"
	"\334\356\233\321\102\233\111\020\136\170\005\307\156\006\122\042"
	"\232\172\214\350\237\337\045\167\300\004\137\375\204\074\005\056"
	"\124\132\150\276\025\325\027\265\073\175\041\374\155\365\105\177"
	"\257\335\147\164\254\025\224\105\371\043\050\332\212\075\173\307"
	"\152\316\064\364\317\261\256\040\362\014\207\150\016\136\224\262"
	"\305\356\212\074\053\132\143\065\036\145\272\365\165\150\363\267"
	"\231\301\374\154\361\330\343\201\016\266\337\333\327\266\230\027"
	"\204\017\230\134\100\306\362\013\250\060\151\055\175\355\241\347"
	"\071\242\264\146\236\370\114\346\162\165\266\223\330\226\077\372"
	"\023\312\346\215\336\147\321\270\114\265\244\177\316\016\336\151"
	"\256\010\075\140\207\141\161\222\216\246\306\355\051\047\006\171"
	"\101\166\325\043\351\013\165\127\340\106\274\330\306\011\357\152"
	"\114\324\164\342\212\103\050\141\015\267\205\150\304\147\267\140"
	"\310\202\124\052\265\141\000\030\142\322\343\320\020\205\200\342"
	"\112\302\377\051\201\125\344\376\151\137\053\042\312\210\111\321"
	"\076\017\062\134\067\104\101\321\216\220\124\363\045\201\312\221"
	"\055\132\054\366\022\122\047\252\104\310\315\254\147\036\303\333"
	"\015\016\161\163\315\234\260\372\047\274\115\014\003\146\103\117"
	"\051\202\325\025\317\055\300\023\365\215\277\134\254\203\067\271"
	"\222\251\055\137\105\336\132\155\232\247\171\235\015\274\354\067"
	"\077\301\115\016\357\015\042\344\233\342\100\107\145\170\001\367"
	"\041\056\127\147\014\261\324\246\131\115\104\147\012\061\237\112"
	"\362\354\131"
#define      chk2_z	19
#define      chk2	((&data[3637]))
	"\306\226\135\007\117\172\364\251\023\304\372\244\165\153\265\352"
	"\025\116\365\034\226\163\104\335\303"
#define      msg2_z	19
#define      msg2	((&data[3662]))
	"\241\015\022\011\326\070\353\154\054\200\366\334\261\047\253\042"
	"\255\200\161\207\220\276\120\031\304\335"
#define      opts_z	1
#define      opts	((&data[3684]))
	"\054"
#define      pswd_z	256
#define      pswd	((&data[3719]))
	"\065\045\200\050\022\331\012\014\124\321\243\262\330\200\166\130"
	"\137\061\372\155\104\003\207\010\340\107\047\014\114\255\102\202"
	"\322\303\105\004\202\246\050\135\010\030\207\332\333\357\121\352"
	"\361\070\030\212\322\047\230\024\333\126\222\311\244\215\027\256"
	"\037\134\263\242\003\333\000\014\363\207\347\316\166\070\271\150"
	"\161\321\362\103\371\212\130\324\341\353\235\206\170\265\064\230"
	"\022\347\072\026\303\073\042\266\302\012\205\071\103\076\242\264"
	"\020\224\370\012\037\121\336\000\074\174\206\264\061\273\115\104"
	"\243\207\132\146\302\175\035\205\207\242\277\312\341\141\177\361"
	"\366\167\373\025\310\332\026\004\127\235\271\210\131\006\315\374"
	"\216\047\143\121\245\200\327\055\043\226\370\004\367\167\366\355"
	"\356\362\003\267\314\032\274\043\267\166\254\021\174\172\016\013"
	"\241\161\134\107\362\063\164\025\312\155\032\301\344\020\257\323"
	"\002\262\213\317\314\107\363\204\275\240\225\072\032\243\105\274"
	"\025\242\003\007\326\170\035\240\345\067\142\312\110\021\236\113"
	"\303\051\033\220\161\016\024\057\257\251\151\311\115\257\205\142"
	"\122\211\151\051\002\207\312\350\276\054\263\007\076\121\122\002"
	"\173\155\222\354\174\247\033\053\120\205\364\236\065\172\000\207"
	"\004\151\253\344\234\266\361\361\207\224\244\137\025\032\267"
#define      msg1_z	42
#define      msg1	((&data[3991]))
	"\342\217\265\371\011\141\344\345\211\141\341\044\112\050\241\365"
	"\305\263\000\127\050\035\106\347\011\215\212\125\216\167\210\137"
	"\100\132\342\200\314\210\271\031\234\265\366\024\105\152\230\226"
	"\262\277\242\376"
#define      shll_z	10
#define      shll	((&data[4042]))
	"\077\250\261\340\212\110\376\376\032\137\366\330\054"
#define      inlo_z	3
#define      inlo	((&data[4053]))
	"\250\072\205"
#define      xecc_z	15
#define      xecc	((&data[4056]))
	"\233\127\237\036\147\100\372\247\153\102\336\121\021\113\236\252"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned)chkenv;
	mask ^= (unsigned)getpid() * ~mask;
	sprintf(buff, "x%x", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%u %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%u %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && date[0]<time(NULL))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
