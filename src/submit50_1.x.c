#if 0
	shc Version 3.8.6, Generic Script Compiler
	Copyright (c) 1994-2006 Francisco Rosales <frosal@fi.upm.es>

	shc -r -f ./submit50_1 
#endif

static  char data [] = 
#define      tst2_z	19
#define      tst2	((&data[0]))
	"\140\011\142\117\161\221\216\215\140\363\354\022\052\220\336\053"
	"\036\315\062\314\361\074"
#define      tst1_z	22
#define      tst1	((&data[24]))
	"\051\111\225\033\161\042\326\212\326\043\160\300\375\265\250\200"
	"\313\303\143\062\302\121\002\132\051\254\133\125"
#define      msg2_z	19
#define      msg2	((&data[52]))
	"\071\222\175\002\242\155\177\134\362\071\305\004\120\025\363\120"
	"\254\252\366\144\073"
#define      rlax_z	1
#define      rlax	((&data[71]))
	"\026"
#define      lsto_z	1
#define      lsto	((&data[72]))
	"\136"
#define      inlo_z	3
#define      inlo	((&data[73]))
	"\234\103\061"
#define      opts_z	1
#define      opts	((&data[76]))
	"\371"
#define      chk2_z	19
#define      chk2	((&data[77]))
	"\300\125\015\100\137\133\150\310\046\050\274\246\037\321\367\323"
	"\333\350\162\331\114\030"
#define      xecc_z	15
#define      xecc	((&data[99]))
	"\375\170\075\044\024\004\376\211\310\133\334\335\057\235\106\231"
#define      date_z	8
#define      date	((time_t*)(&data[120]))
	"\206\230\136\215\321\311\360\176\215\062\037\105\133\361\052"
#define      pswd_z	256
#define      pswd	((&data[167]))
	"\025\142\363\342\123\260\065\046\230\105\305\161\221\336\301\230"
	"\037\133\311\015\120\120\245\257\335\167\240\010\130\062\252\156"
	"\225\235\121\350\116\067\034\010\271\055\373\046\051\256\035\146"
	"\375\203\205\126\317\233\145\117\220\130\265\150\356\267\317\010"
	"\044\356\152\060\046\207\070\337\264\064\005\336\342\042\104\340"
	"\246\312\066\165\145\234\304\366\364\171\137\342\061\057\353\126"
	"\035\125\206\104\334\277\043\221\363\050\157\326\113\264\266\361"
	"\176\354\147\344\210\054\333\175\246\072\140\327\152\113\056\210"
	"\241\265\314\176\164\357\017\150\030\177\076\143\064\364\125\262"
	"\341\275\227\152\351\162\347\220\255\110\150\027\223\226\237\065"
	"\113\153\263\300\132\302\050\162\102\147\326\166\134\054\051\075"
	"\351\301\250\323\063\217\143\340\330\313\367\154\141\227\241\255"
	"\002\124\155\134\027\226\317\131\376\245\320\132\321\372\230\273"
	"\273\100\216\356\320\361\317\250\274\307\024\036\136\265\314\140"
	"\012\072\275\041\320\214\173\317\062\113\051\004\105\302\277\000"
	"\002\115\357\323\077\276\173\373\205\220\032\343\106\346\104\120"
	"\040\001\162\361\216\355\300\301\070\352\305\176\255\205\176\257"
	"\322\156\202\022\054\376\015\261\217\050\225\325\016\331\045\057"
	"\333\227\040\152\205\206\017\346\313\325\130\135\263\032\366\323"
	"\165\300\340\306\020\206\166\356\376\027\366\127\112\240\306\337"
	"\076\030\310\215\237\327\163\153\254\313\310\137\345"
#define      text_z	3031
#define      text	((&data[614]))
	"\176\023\041\217\232\230\175\231\257\163\361\371\024\267\331\123"
	"\320\241\340\157\170\124\333\045\037\243\205\005\142\270\140\341"
	"\314\202\160\147\033\355\000\312\141\361\304\166\251\235\312\172"
	"\076\253\352\267\377\305\335\037\151\142\044\314\033\205\255\347"
	"\010\036\116\043\014\117\356\156\100\262\345\352\120\257\144\217"
	"\133\116\107\132\023\044\171\175\207\236\111\242\044\367\212\055"
	"\025\331\120\042\050\077\220\151\362\166\123\102\045\270\321\201"
	"\006\030\333\032\075\125\227\304\364\341\147\030\330\361\105\355"
	"\312\226\020\363\326\241\134\310\027\257\012\075\150\333\276\157"
	"\364\231\211\061\357\041\365\175\331\312\256\331\200\253\326\005"
	"\320\270\315\316\106\230\107\056\100\262\127\270\334\340\200\215"
	"\067\147\077\256\263\357\342\123\252\120\373\337\311\244\261\271"
	"\363\150\320\200\316\302\221\243\102\316\131\375\116\144\014\356"
	"\225\164\115\030\042\304\012\123\025\337\065\040\156\343\117\363"
	"\300\103\236\226\166\056\126\151\312\345\337\275\020\033\267\115"
	"\146\036\031\352\372\130\142\301\214\330\052\044\306\214\322\005"
	"\023\307\242\015\214\374\203\302\040\172\164\165\146\314\142\341"
	"\145\311\276\317\141\263\044\267\041\155\345\072\216\042\314\134"
	"\362\072\125\300\032\312\352\154\052\054\023\004\007\224\006\346"
	"\333\260\341\335\351\274\333\213\066\024\130\237\373\314\142\270"
	"\073\157\006\302\320\126\211\306\323\364\216\171\321\220\271\277"
	"\314\106\165\126\304\007\143\245\312\157\273\003\022\311\375\164"
	"\103\165\242\117\226\246\031\221\040\372\111\101\044\015\146\122"
	"\137\135\050\232\346\362\253\142\335\202\105\350\123\375\140\260"
	"\237\325\177\130\373\055\101\141\144\136\270\313\261\144\103\053"
	"\351\057\100\342\155\370\201\330\164\351\040\272\160\147\320\266"
	"\362\226\226\121\162\076\213\172\021\003\231\000\055\017\335\036"
	"\167\344\344\304\242\065\340\336\347\260\174\240\173\015\057\016"
	"\271\350\317\147\270\024\053\342\244\206\243\377\006\241\007\145"
	"\056\352\213\133\141\364\045\200\156\072\212\342\073\253\301\301"
	"\304\201\226\055\074\126\241\073\335\322\015\337\341\063\342\200"
	"\016\075\263\320\224\172\066\245\020\165\341\337\167\232\335\244"
	"\114\317\040\226\163\305\057\343\134\226\230\107\172\332\254\052"
	"\277\207\076\167\115\265\170\242\274\011\250\172\127\321\232\012"
	"\132\172\330\234\243\377\332\163\300\141\270\164\127\333\154\354"
	"\121\361\374\061\056\006\235\352\015\305\146\011\347\307\300\077"
	"\012\062\253\311\300\140\322\073\363\073\010\276\132\023\126\242"
	"\226\230\323\201\057\041\263\275\365\343\373\107\271\224\114\363"
	"\331\206\334\304\256\167\303\361\050\063\261\316\217\022\337\300"
	"\012\340\134\070\115\176\315\075\315\215\247\231\200\351\057\260"
	"\076\321\364\374\242\315\257\121\317\154\003\062\375\205\104\125"
	"\240\205\334\264\011\275\002\256\211\152\210\101\073\127\170\333"
	"\052\061\261\034\115\017\030\224\363\243\125\152\224\065\375\164"
	"\100\176\052\132\045\377\003\043\271\115\224\163\234\213\341\165"
	"\356\364\301\101\264\341\115\101\030\136\076\276\324\055\152\002"
	"\157\305\053\131\315\262\250\174\262\020\135\332\354\101\241\362"
	"\245\273\126\242\027\022\132\135\315\034\344\247\013\303\127\342"
	"\010\374\145\110\053\327\257\134\052\357\151\072\002\240\015\102"
	"\163\160\155\053\374\004\260\111\006\225\311\210\224\036\155\053"
	"\025\131\360\364\070\152\251\110\073\262\114\331\024\016\134\226"
	"\315\023\271\166\102\260\141\014\236\206\327\065\363\276\126\314"
	"\335\034\043\240\333\121\107\162\256\132\130\332\316\021\333\066"
	"\207\246\320\351\116\060\047\160\371\341\070\147\277\304\277\346"
	"\033\214\126\033\366\257\264\146\330\352\010\310\121\207\056\144"
	"\273\343\112\053\034\127\337\360\126\037\024\255\005\321\012\003"
	"\273\204\146\076\340\000\150\315\306\240\073\035\054\040\250\326"
	"\155\137\153\115\365\013\223\337\257\134\232\204\364\215\340\005"
	"\253\242\225\366\356\122\225\311\307\321\135\155\070\222\054\253"
	"\276\234\310\303\012\241\115\223\254\053\276\025\123\356\365\055"
	"\217\200\034\303\236\175\233\353\233\160\027\156\103\234\126\035"
	"\354\227\066\206\000\321\320\074\132\143\257\120\017\005\244\171"
	"\160\272\177\115\115\045\377\035\222\256\232\234\333\332\041\372"
	"\065\257\264\326\017\131\341\044\320\202\114\363\164\304\367\131"
	"\063\056\255\170\263\052\177\244\253\345\156\035\077\151\257\003"
	"\361\244\132\030\212\200\227\145\325\335\251\171\245\207\310\353"
	"\131\334\217\053\147\067\213\221\263\264\233\362\371\271\375\345"
	"\226\307\264\123\140\120\036\300\177\072\304\237\061\317\322\340"
	"\374\247\132\031\276\231\215\040\276\144\205\333\305\165\052\042"
	"\324\007\005\140\311\017\376\036\057\375\175\041\377\233\377\041"
	"\174\062\147\235\034\250\254\122\253\142\070\031\362\330\212\033"
	"\225\143\371\205\213\145\321\043\054\136\224\336\166\045\145\032"
	"\147\240\130\157\112\135\052\363\016\323\047\205\003\246\307\153"
	"\346\366\272\054\274\151\354\207\104\253\271\202\174\320\160\347"
	"\206\164\073\013\207\356\361\160\374\237\326\056\011\351\001\055"
	"\272\000\333\357\227\101\054\277\024\157\220\222\100\214\371\161"
	"\013\310\176\142\023\232\165\146\005\063\273\062\326\271\121\334"
	"\110\227\134\007\134\247\277\140\062\212\270\253\160\256\007\013"
	"\337\042\227\260\171\062\314\255\336\373\043\257\325\212\155\071"
	"\167\142\064\152\073\022\117\306\050\037\045\316\233\122\265\246"
	"\060\112\174\236\014\376\106\270\004\224\104\162\004\114\006\106"
	"\034\307\353\256\243\207\355\121\163\127\326\056\060\140\123\161"
	"\134\107\122\034\310\214\274\321\256\273\371\376\332\051\154\316"
	"\372\302\054\357\327\241\214\226\327\216\203\343\347\245\241\366"
	"\252\127\053\274\247\075\161\103\362\327\167\053\144\315\223\047"
	"\335\304\226\226\160\113\105\230\137\255\166\275\353\136\335\316"
	"\331\354\157\064\237\172\335\147\260\255\027\216\165\263\011\145"
	"\344\356\154\157\001\353\131\371\276\272\320\312\224\042\003\370"
	"\040\033\221\256\152\157\034\313\117\303\266\312\133\116\142\053"
	"\270\227\106\325\110\151\067\123\026\371\147\145\230\002\127\170"
	"\177\112\334\377\261\237\056\064\173\175\354\305\305\333\141\064"
	"\214\115\250\261\204\347\350\065\063\130\220\013\073\320\017\323"
	"\266\300\241\105\343\034\020\013\213\246\214\170\117\022\316\327"
	"\310\312\030\074\255\234\161\104\330\267\313\332\131\137\175\067"
	"\371\302\121\144\217\130\234\005\161\250\370\221\161\266\273\322"
	"\034\070\346\224\145\153\137\142\252\027\112\116\122\076\245\060"
	"\155\303\005\227\371\225\325\314\310\314\177\342\064\034\276\105"
	"\130\012\327\362\201\330\307\016\015\243\111\147\051\102\210\321"
	"\310\260\371\204\165\150\230\077\143\221\374\155\103\046\303\016"
	"\354\104\176\035\212\235\237\251\257\236\060\344\232\165\346\067"
	"\042\151\312\250\072\235\077\155\366\153\264\267\210\260\105\141"
	"\025\262\242\353\135\143\250\243\303\057\270\375\234\021\251\312"
	"\245\121\246\143\244\372\157\232\276\011\131\152\357\063\260\143"
	"\231\134\170\022\372\215\115\325\234\070\262\002\176\030\345\251"
	"\305\331\166\235\022\372\141\034\262\141\137\076\333\046\105\027"
	"\044\062\141\160\146\052\305\242\171\300\146\257\065\377\372\361"
	"\243\247\221\112\133\322\234\030\013\041\113\050\107\127\265\207"
	"\245\267\017\046\021\231\074\200\255\046\042\164\365\217\231\153"
	"\214\172\164\305\171\040\203\253\244\140\240\227\002\037\114\176"
	"\311\156\230\066\322\061\332\270\220\151\077\332\207\271\161\132"
	"\146\046\174\127\172\361\113\122\045\237\256\126\106\125\103\217"
	"\064\013\365\031\161\067\177\320\055\213\236\212\240\306\112\012"
	"\353\355\017\154\033\071\302\315\234\230\332\161\222\227\013\256"
	"\036\135\300\373\025\137\343\005\115\041\372\042\114\161\215\120"
	"\337\265\055\173\054\301\356\146\064\172\023\273\342\251\077\205"
	"\121\140\060\000\362\355\244\320\222\326\273\013\353\262\111\356"
	"\077\233\307\143\106\260\142\263\363\335\302\003\230\305\023\274"
	"\006\306\015\035\004\311\110\373\225\213\274\056\364\265\060\223"
	"\055\346\306\150\324\341\315\061\303\142\067\023\315\017\232\365"
	"\244\142\372\020\025\111\202\142\017\061\241\163\333\212\361\027"
	"\225\201\232\170\237\154\114\160\051\251\073\102\272\171\101\336"
	"\015\324\165\325\245\170\377\350\365\054\266\022\315\202\024\241"
	"\052\202\146\302\200\262\302\212\346\073\222\332\044\041\071\115"
	"\327\230\255\314\343\331\321\266\100\044\364\205\012\364\001\142"
	"\341\361\207\072\264\247\120\247\177\040\150\301\300\156\076\157"
	"\127\116\256\261\170\213\341\126\062\065\143\055\306\055\333\031"
	"\005\347\324\067\130\305\234\251\376\347\104\021\175\000\320\141"
	"\121\116\354\264\152\371\021\334\313\057\016\256\114\326\127\257"
	"\164\247\011\161\023\272\265\247\204\341\101\351\223\013\151\267"
	"\160\162\331\223\120\366\071\323\012\307\153\141\310\021\214\052"
	"\307\211\002\325\137\342\134\300\240\255\172\153\100\155\001\262"
	"\370\335\007\163\273\275\330\222\146\054\132\216\275\305\156\045"
	"\032\200\016\364\224\226\043\002\254\337\247\044\302\200\121\160"
	"\071\177\275\237\014\346\304\306\156\337\204\335\240\231\040\302"
	"\377\313\050\025\337\246\256\023\320\174\344\042\256\343\355\154"
	"\013\354\032\025\251\251\073\247\031\202\303\362\164\255\261\130"
	"\277\236\062\171\056\355\010\361\314\267\147\076\072\342\121\242"
	"\176\352\223\225\170\076\230\212\100\276\306\064\361\344\045\105"
	"\106\255\343\011\303\353\332\326\075\013\006\022\024\075\331\177"
	"\157\215\117\014\041\251\330\206\316\025\054\000\255\241\117\205"
	"\251\347\315\112\257\322\077\030\045\043\150\061\140\204\106\251"
	"\054\373\046\025\175\323\352\006\201\113\373\124\031\117\303\317"
	"\374\225\024\354\073\020\315\204\251\004\262\355\333\323\011\001"
	"\277\076\224\125\336\022\252\044\221\207\113\161\236\061\003\234"
	"\332\237\047\103\326\044\251\356\240\270\046\376\215\333\277\052"
	"\200\217\313\256\130\140\204\377\211\000\273\131\162\016\012\354"
	"\063\332\306\252\132\261\247\350\061\234\166\162\274\071\220\063"
	"\001\365\030\216\256\276\057\215\040\161\300\126\360\047\256\001"
	"\260\054\170\367\350\334\311\152\324\226\312\162\241\342\316\110"
	"\160\152\031\373\327\050\045\076\045\142\057\332\364\336\045\325"
	"\100\052\204\276\153\223\333\371\273\057\052\226\303\076\203\371"
	"\200\101\272\132\057\303\034\262\233\172\067\074\256\254\237\170"
	"\375\137\200\226\005\346\200\201\256\210\331\065\200\100\022\135"
	"\376\253\210\277\011\176\227\104\003\150\065\054\031\361\057\242"
	"\370\344\365\127\164\020\326\136\317\141\316\311\123\126\110\060"
	"\325\132\076\072\260\243\224\276\252\265\025\076\302\057\210\357"
	"\340\373\136\043\164\234\305\137\273\206\006\201\132\276\247\024"
	"\153\041\017\007\255\366\024\350\111\340\303\244\327\067\321\234"
	"\237\061\263\230\153\020\100\145\317\022\364\024\307\036\333\022"
	"\127\331\361\165\367\007\006\141\200\262\375\171\152\020\320\176"
	"\127\060\357\206\114\144\163\243\100\021\043\002\226\251\230\212"
	"\244\166\276\122\146\352\071\366\041\250\360\143\364\366\137\110"
	"\235\106\254\077\202\352\236\252\323\140\253\072\065\064\116\116"
	"\110\030\164\255\372\362\175\075\035\074\305\275\175\306\005\342"
	"\154\167\064\313\377\167\274\353\014\315\177\205\226\372\301\143"
	"\302\000\265\213\050\173\346\066\163\237\174\202\234\217\376\041"
	"\175\270\374\116\343\160\301\346\056\172\327\205\263\077\160\217"
	"\327\367\375\312\050\000\145\324\132\031\107\220\076\220\037\062"
	"\300\377\135\303\335\237\217\334\043\351\354\027\265\244\140\154"
	"\306\364\153\303\315\361\065\327\144\377\334\263\161\242\035\177"
	"\004\211\274\247\056\147\263\105\271\043\316\370\055\363\153\275"
	"\103\233\024\310\154\071\104\372\132\376\377\265\334\146\214\031"
	"\320\301\256\261\055\202\320\135\016\274\271\016\353\100\073\041"
	"\063\244\305\345\126\146\276\371\374\115\271\071\166\145\151\352"
	"\132\217\330\251\210\327\032\001\223\173\246\114\154\016\234\110"
	"\250\250\213\062\256\007\367\267\000\277\111\003\204\061\247\031"
	"\120\017\212\051\044\045\116\147\257\020\155\024\373\160\023\344"
	"\164\161\314\157\314\177\333\151\254\306\117\022\204\300\336\260"
	"\352\257\362\312\217\144\005\106\261\050\046\203\224\234\153\232"
	"\201\117\115\042\365\343\052\316\377\252\224\067\224\262\375\321"
	"\046\347\054\045\316\313\047\361\251\024\331\334\013\216\240\041"
	"\276\141\216\240\065\123\012\212\210\364\207\116\166\012\046\000"
	"\307\031\377\141\341\327\106\206\375\373\220\210\110\267\206\044"
	"\006\151\031\122\233\114\066\361\305\037\353\276\147\307\377\073"
	"\174\112\151\165\132\005\213\347\176\143\262\267\362\227\002\312"
	"\332\162\140\032\324\160\326\061\317\367\274\254\226\151\160\215"
	"\337\016\144\045\044\362\036\317\104\361\043\220\265\351\075\353"
	"\032\214\111\202\240\122\106\006\174\204\150\104\105\276\144\067"
	"\042\111\214\254\213\356\327\063\310\173\134\306\335\010\016\114"
	"\212\357\031\247\004\015\063\156\345\154\223\166\136\324\273\066"
	"\167\003\202\372\146\117\174\360\232\373\216\353\317\365\316\115"
	"\160\257\126\303\251\122\173\015\267\155\023\345\231\330\065\334"
	"\217\306\056\333\106\240\301\350\333\335\245\055\350\220\372\052"
	"\155\123\070\346\061\372\016\155\071\125\311\031\001\176\217\017"
	"\304\101\125\027\067\342\111\373\035\256\057\160\311\201\311\334"
	"\316\053\350\341\247\053\042\042\056\374\323\337\106\212\145\341"
	"\122\200\032\363\210\064\323\357\263\265\272\131\006\212\125\300"
	"\222\060\076\354\157\027\257\135\301\010\114\013\116\177\275\060"
	"\374\375\352\370\174\131\056\025\343\377\227\277\376\150\346\266"
	"\212\234\374\362\317\354\063\226\103\275\130\135\311\022\343\003"
	"\135\373\333\116\101\311\031\330\331\014\256\172\150\167\221\030"
	"\201\316\201\135\214\360\121\046\172\203\025\233\171\370\236\326"
	"\364\172\044\066\103\076\016\034\113\275\226\264\064\050\314\266"
	"\366\115\023\203\076\145\251\270\350\276\123\142\267\362\070\254"
	"\155\135\342\260\233\361\314\346\257\143\232\343\213\147\232\201"
	"\265\256\005\363\023\256\253\374\155\377\136\045\362\226\321\137"
	"\363\263\017\217\244\334\166\123\077\021\067\312\170\322\114\056"
	"\200\121\041\223\000\315\220\156\314\356\223\277\205\144\036\171"
	"\027\056\011\274\012\177\020\112\220\110\025\011\032\141\067\232"
	"\263\131\056\264\046\276\042\363\255\265\262\063\032\321\254\061"
	"\377\266\356\012\065\376\124\306\106\151\317\140\313\007\373\177"
	"\140\051\064\206\350\126\172\225\014\054\311\046\375\165\130\375"
	"\053\106\007\141\105\134\047\213\306\367\354\221\376\350\021\137"
	"\021\105\345\372\234\137\217\250\214\130\317\212\316\047\207\372"
	"\155\217\134\262\353\204\076\261\173\053\103\172\023\125\331\045"
	"\232\277\037\066\037\257\337\253\010\256\065\326\325\275\321\103"
	"\114\056\366\067\262\065\351\056\140\055\250\164"
#define      chk1_z	22
#define      chk1	((&data[3918]))
	"\034\101\270\243\123\246\240\157\021\057\201\002\116\111\137\120"
	"\001\042\310\166\227\035\250\067\340\123\140\150"
#define      shll_z	10
#define      shll	((&data[3943]))
	"\314\342\110\376\120\054\154\167\350\045\341"
#define      msg1_z	42
#define      msg1	((&data[3957]))
	"\376\030\373\115\105\246\131\050\311\302\007\121\244\011\366\173"
	"\327\065\050\367\073\331\121\125\003\241\214\064\211\263\330\102"
	"\201\074\103\315\164\205\063\117\316\055\063\302\043\113\106\362"
	"\202\371\047\154"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned)chkenv;
	mask ^= (unsigned)getpid() * ~mask;
	sprintf(buff, "x%x", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%u %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%u %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && date[0]<time(NULL))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
