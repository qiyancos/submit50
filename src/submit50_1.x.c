#if 0
	shc Version 3.8.6, Generic Script Compiler
	Copyright (c) 1994-2006 Francisco Rosales <frosal@fi.upm.es>

	shc -r -f ./submit50_1 
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[2]))
	"\150\112\022\106\205\112\350\104\053\174\042\116\001\350\055\243"
	"\304\141\250\146\044\212\111\226\212"
#define      tst2_z	19
#define      tst2	((&data[26]))
	"\263\243\152\137\137\303\162\044\235\155\074\045\055\017\330\037"
	"\076\335\146\202\162\341\166\242"
#define      opts_z	1
#define      opts	((&data[49]))
	"\255"
#define      chk1_z	22
#define      chk1	((&data[52]))
	"\230\375\150\255\055\250\372\005\333\356\065\305\302\365\305\024"
	"\123\311\161\052\320\214\071\354\327\354\051\216\310"
#define      text_z	3035
#define      text	((&data[479]))
	"\264\357\236\076\070\065\311\043\233\275\327\016\236\115\260\147"
	"\222\111\374\371\111\224\366\041\201\040\257\111\365\066\236\251"
	"\046\075\350\137\162\261\202\016\156\132\035\014\247\316\164\072"
	"\027\160\064\140\005\052\202\206\112\061\317\100\150\155\352\216"
	"\252\323\355\035\204\160\054\362\312\111\377\162\027\163\254\057"
	"\344\341\220\351\013\022\157\126\104\077\227\254\255\202\073\127"
	"\125\051\165\331\231\242\314\144\353\314\326\003\100\203\062\045"
	"\144\303\016\160\325\176\306\032\276\136\306\153\340\002\303\065"
	"\053\070\017\305\332\333\051\306\250\000\312\350\204\375\016\350"
	"\300\034\131\226\233\040\260\131\176\167\304\136\171\210\223\245"
	"\300\243\153\233\176\225\142\046\225\054\017\031\051\035\002\352"
	"\072\133\200\326\173\061\057\372\250\364\130\042\174\354\310\075"
	"\217\063\331\016\310\073\065\136\150\105\170\222\143\172\174\235"
	"\326\375\164\122\056\243\114\326\230\245\371\025\221\301\122\041"
	"\364\053\057\275\147\145\033\317\252\223\141\015\015\336\253\344"
	"\333\037\066\012\303\202\340\133\047\332\160\271\233\303\332\220"
	"\357\012\115\126\160\150\046\032\373\210\050\011\146\323\355\102"
	"\363\043\114\266\246\055\022\315\007\203\207\243\107\142\063\066"
	"\154\200\215\335\350\264\367\344\074\037\355\243\363\332\346\347"
	"\376\062\236\244\140\261\162\150\064\372\013\174\134\077\263\311"
	"\277\100\246\250\365\235\214\061\275\172\325\261\125\273\231\124"
	"\355\067\371\116\350\154\266\035\146\301\231\302\000\114\213\300"
	"\215\061\151\202\317\366\264\215\160\211\077\306\104\330\032\062"
	"\017\023\200\367\177\066\025\345\370\256\250\370\373\063\271\211"
	"\145\042\013\065\030\300\303\211\111\002\117\215\332\151\300\352"
	"\321\202\330\147\262\273\020\236\234\273\267\010\262\370\375\375"
	"\055\350\002\226\302\070\370\225\027\260\277\220\025\074\105\221"
	"\226\161\133\002\177\146\050\153\363\240\370\372\317\240\007\134"
	"\144\366\315\156\240\001\032\202\372\346\345\377\317\322\162\375"
	"\241\057\315\065\176\053\052\274\135\226\215\262\175\032\027\267"
	"\217\101\234\057\202\101\044\153\047\046\066\231\165\200\025\173"
	"\263\125\116\147\002\314\226\044\364\354\253\370\044\052\335\326"
	"\355\323\363\132\367\005\043\110\012\306\322\236\123\326\175\242"
	"\200\276\166\046\152\130\253\054\345\052\273\246\134\042\314\144"
	"\275\247\362\357\022\023\346\155\001\337\361\313\212\171\101\320"
	"\135\325\150\324\116\071\066\365\303\235\046\170\173\304\326\240"
	"\052\265\171\126\017\133\127\261\263\071\076\351\126\310\040\020"
	"\233\320\322\141\300\235\373\365\367\223\014\321\373\210\011\217"
	"\354\224\105\012\302\240\225\173\002\350\332\064\272\056\157\103"
	"\100\234\012\045\041\262\260\213\332\140\247\161\367\310\117\306"
	"\342\257\224\361\240\105\206\126\354\377\200\057\224\256\142\066"
	"\331\200\260\247\341\160\300\121\335\336\156\361\140\006\145\307"
	"\366\371\030\073\103\005\152\324\035\264\145\015\173\106\045\163"
	"\317\231\037\040\040\252\342\131\127\062\017\130\035\117\237\163"
	"\066\121\037\034\220\333\245\335\110\155\317\351\265\117\007\134"
	"\216\115\214\045\341\217\351\125\041\113\320\307\363\110\034\255"
	"\214\345\114\132\036\007\060\146\311\143\367\236\120\124\003\241"
	"\163\363\161\244\317\161\075\143\152\166\352\137\360\114\071\375"
	"\056\160\221\161\005\026\072\205\002\347\211\213\000\112\363\273"
	"\244\230\361\217\030\146\162\140\225\220\241\214\170\074\122\256"
	"\264\325\151\165\222\266\133\344\076\266\170\220\215\341\005\031"
	"\174\327\321\032\361\350\263\373\300\324\325\136\164\075\115\256"
	"\307\370\163\055\304\316\222\122\240\051\330\006\120\221\171\376"
	"\312\060\023\061\105\210\347\266\033\242\073\101\045\065\245\130"
	"\165\137\127\157\353\175\106\040\152\001\255\335\254\260\156\200"
	"\240\045\031\220\254\100\232\004\211\210\360\230\177\246\233\245"
	"\136\243\271\264\252\033\027\026\053\020\060\346\141\243\057\316"
	"\133\344\070\156\130\160\000\072\121\067\277\365\356\344\314\166"
	"\372\260\031\134\145\372\170\203\240\317\320\071\210\230\105\025"
	"\263\220\317\117\145\372\157\236\221\066\045\167\201\201\152\335"
	"\324\363\265\320\324\236\266\120\111\352\160\147\113\111\051\321"
	"\043\262\177\004\221\060\330\360\373\212\034\347\160\163\124\013"
	"\367\141\032\160\101\022\260\024\214\175\155\204\150\251\333\374"
	"\265\246\331\305\227\050\060\357\270\254\353\260\350\102\072\026"
	"\325\355\036\022\250\143\160\206\042\142\274\106\364\343\315\124"
	"\303\127\077\042\151\165\034\223\113\044\222\314\004\251\061\222"
	"\323\270\015\366\253\115\271\207\365\207\126\150\176\014\102\265"
	"\333\023\176\271\017\036\176\135\011\015\011\210\175\011\241\250"
	"\240\321\111\332\205\307\341\345\077\073\242\152\030\276\152\361"
	"\374\354\111\302\353\207\325\147\360\063\354\223\216\174\374\223"
	"\370\112\362\320\251\230\017\033\246\322\172\037\150\060\005\107"
	"\173\223\072\255\207\017\306\375\243\221\023\177\204\163\012\077"
	"\016\230\264\232\373\064\377\266\274\167\267\202\025\070\036\304"
	"\277\051\276\213\054\163\024\032\203\257\342\317\164\100\064\132"
	"\076\161\373\322\255\356\226\021\005\037\015\370\222\240\141\171"
	"\315\376\345\043\144\341\120\027\102\070\021\221\066\303\051\347"
	"\030\346\252\366\117\147\142\137\067\063\176\141\270\014\255\177"
	"\243\026\277\023\357\152\153\311\350\377\112\111\223\151\352\076"
	"\274\047\037\326\364\045\152\203\015\322\046\106\112\245\105\233"
	"\021\071\137\212\016\074\032\167\251\364\325\153\337\207\245\055"
	"\206\065\103\256\274\377\014\227\304\141\175\264\223\304\207\302"
	"\366\136\362\344\275\366\141\372\212\160\117\352\151\073\161\127"
	"\172\073\253\211\151\070\374\023\031\032\037\155\134\265\200\340"
	"\213\211\140\006\361\244\062\223\236\246\306\001\133\012\056\011"
	"\246\327\246\111\322\214\366\266\164\370\013\244\161\335\320\347"
	"\103\365\242\314\147\204\147\265\035\106\034\111\352\020\170\355"
	"\313\077\252\207\025\015\371\263\075\255\327\145\154\256\356\213"
	"\061\064\063\346\042\343\067\014\304\053\304\247\300\120\362\355"
	"\117\010\224\064\136\133\312\046\374\202\072\175\056\042\222\176"
	"\212\060\114\156\357\366\114\334\022\374\302\325\270\062\372\237"
	"\054\011\051\100\233\061\003\061\073\237\024\111\336\024\112\325"
	"\071\252\131\131\012\166\335\263\365\032\304\050\273\155\113\274"
	"\034\266\332\325\074\073\243\323\162\363\214\360\244\263\212\171"
	"\273\277\364\053\022\137\040\355\262\006\144\070\017\227\236\064"
	"\172\244\122\312\315\222\003\136\057\341\236\370\100\240\350\236"
	"\220\222\137\352\043\232\374\343\077\147\342\247\165\141\345\375"
	"\331\342\243\243\171\144\017\350\241\310\054\133\247\207\337\002"
	"\102\333\157\211\222\236\175\374\012\175\003\314\344\041\156\150"
	"\356\123\053\022\320\313\234\345\272\160\306\243\041\271\375\325"
	"\206\176\344\374\064\000\221\305\221\110\205\012\023\334\304\055"
	"\001\176\122\044\004\061\373\223\006\244\075\366\124\053\173\334"
	"\250\304\046\267\276\033\323\205\107\317\075\162\073\051\133\145"
	"\172\231\256\212\051\166\155\161\225\247\275\303\346\147\323\376"
	"\065\030\203\312\213\364\033\273\217\277\054\350\134\302\366\201"
	"\043\323\135\205\115\277\006\135\357\067\110\117\001\067\256\144"
	"\212\126\046\326\001\307\037\223\324\362\251\337\107\373\206\357"
	"\107\214\222\063\107\033\074\044\252\342\224\073\262\116\375\270"
	"\253\001\020\151\266\203\276\243\363\254\071\062\164\331\335\067"
	"\235\161\020\036\162\031\124\303\015\263\344\221\376\365\346\305"
	"\017\152\022\003\001\132\304\115\360\106\320\111\005\226\355\075"
	"\061\057\326\115\253\216\151\016\355\161\346\172\034\046\110\247"
	"\135\121\064\127\211\323\073\225\267\365\304\173\043\334\200\121"
	"\153\056\252\200\150\242\351\146\173\276\364\131\175\246\264\142"
	"\000\354\176\045\134\005\170\273\166\365\157\360\143\127\325\156"
	"\073\336\304\267\327\002\221\010\212\241\060\357\144\363\240\330"
	"\340\263\121\153\262\364\233\247\005\311\106\016\127\212\150\255"
	"\032\014\352\176\205\121\250\167\366\077\310\110\062\274\051\370"
	"\131\374\230\341\113\237\374\164\206\314\170\332\336\266\204\244"
	"\060\377\213\307\305\330\372\147\111\134\055\060\124\313\275\322"
	"\162\207\103\236\015\154\275\070\315\222\236\347\256\227\236\030"
	"\333\210\144\142\124\034\171\312\006\103\312\252\052\113\113\241"
	"\215\044\230\324\344\340\217\256\053\131\066\356\245\254\312\130"
	"\273\372\031\066\001\144\135\167\225\113\373\050\116\164\063\377"
	"\136\111\314\203\122\201\206\151\315\174\227\142\330\024\360\277"
	"\110\026\047\150\356\143\366\011\027\363\202\273\057\001\027\241"
	"\030\035\212\203\372\354\105\261\176\221\122\032\000\230\134\365"
	"\353\353\155\026\241\042\056\011\260\063\325\145\370\365\116\004"
	"\262\056\045\204\255\105\104\171\134\235\160\076\123\020\331\200"
	"\076\173\200\103\153\332\157\015\270\125\305\320\270\262\073\357"
	"\144\001\345\360\221\314\000\213\143\174\046\146\200\107\352\107"
	"\045\114\023\360\362\160\316\137\340\306\261\372\344\265\217\261"
	"\316\174\365\020\310\357\265\103\142\214\066\370\017\356\314\120"
	"\152\014\130\306\250\154\140\125\303\176\244\225\054\141\357\021"
	"\314\206\106\156\034\254\137\043\333\220\020\117\034\077\007\074"
	"\132\234\346\372\305\352\060\235\114\101\065\313\213\313\107\172"
	"\136\316\112\364\215\255\375\317\360\223\255\034\224\141\236\250"
	"\205\311\364\070\003\034\010\034\055\133\144\275\127\362\150\303"
	"\053\053\313\217\363\314\375\305\234\345\050\226\313\253\000\120"
	"\244\312\104\345\121\372\161\360\255\342\023\361\325\025\356\333"
	"\253\127\132\363\256\113\244\066\361\214\060\016\214\031\107\077"
	"\310\114\313\375\342\364\203\032\066\160\363\042\115\151\251\230"
	"\315\131\205\036\023\070\247\150\277\277\040\372\053\213\011\164"
	"\200\201\136\153\002\141\257\121\227\262\140\253\045\063\016\260"
	"\046\345\066\066\141\000\124\016\343\301\316\345\370\213\310\224"
	"\277\147\036\200\354\266\064\176\322\254\040\164\375\236\166\035"
	"\014\011\164\065\164\345\255\022\137\071\262\205\007\235\331\320"
	"\055\100\147\136\260\123\210\012\142\244\144\265\262\223\377\224"
	"\161\060\255\050\060\354\077\334\161\356\113\151\106\124\200\157"
	"\302\115\347\170\242\126\012\375\103\346\113\300\340\130\166\303"
	"\220\260\264\173\000\021\243\047\071\000\273\370\322\040\201\325"
	"\062\303\155\142\242\121\031\300\216\341\167\050\106\160\016\260"
	"\276\323\146\232\070\167\246\340\330\352\254\323\342\205\001\271"
	"\242\163\116\046\174\053\167\267\142\076\233\375\141\307\317\106"
	"\227\250\057\174\265\007\206\053\253\301\146\115\330\201\357\064"
	"\171\164\007\171\312\074\146\305\055\355\350\303\227\124\025\015"
	"\012\153\360\161\350\051\376\271\167\203\335\137\132\030\041\151"
	"\272\043\162\231\046\160\331\360\251\060\322\333\066\014\073\361"
	"\051\324\233\223\304\143\333\330\241\310\331\217\240\375\074\055"
	"\227\015\035\236\253\250\143\072\177\335\305\302\136\117\112\203"
	"\011\164\024\262\071\111\267\344\031\110\045\271\350\215\066\177"
	"\234\137\212\157\171\311\276\177\056\326\125\144\001\237\272\346"
	"\375\124\202\034\061\362\265\210\313\153\310\235\031\130\103\321"
	"\043\054\010\350\101\060\152\016\365\313\214\360\370\117\146\077"
	"\114\047\052\356\206\350\137\027\023\272\372\041\366\250\103\205"
	"\343\317\265\121\335\060\313\036\300\375\126\353\023\002\205\000"
	"\100\273\326\346\047\100\314\266\116\342\201\200\007\166\302\071"
	"\217\066\267\225\314\005\341\212\357\216\211\003\005\223\363\135"
	"\214\317\137\156\077\354\321\171\044\363\353\046\061\267\226\362"
	"\226\203\276\267\364\364\006\345\323\050\364\272\065\135\201\076"
	"\146\244\316\322\133\350\342\105\207\200\124\070\151\060\036\200"
	"\107\042\060\116\200\370\244\115\053\363\213\075\324\036\367\246"
	"\227\360\152\311\006\124\135\165\324\200\103\022\041\033\354\021"
	"\303\016\353\255\240\006\376\011\312\021\002\110\217\204\320\225"
	"\223\002\372\236\273\215\135\037\110\256\160\124\153\231\170\372"
	"\016\151\354\226\006\064\371\064\131\231\024\300\100\207\354\331"
	"\115\146\366\225\030\023\041\040\156\104\357\041\015\352\164\324"
	"\117\370\161\151\257\305\067\033\154\210\205\101\222\272\320\242"
	"\064\250\370\320\013\243\312\017\155\220\271\072\007\315\257\215"
	"\113\077\034\073\060\131\354\237\335\331\016\057\140\042\104\350"
	"\372\356\246\362\274\063\142\245\210\100\200\001\346\112\050\315"
	"\251\343\105\364\340\304\130\262\300\247\275\113\012\007\154\324"
	"\000\024\067\006\367\252\145\362\145\113\377\172\341\310\215\131"
	"\337\371\276\145\030\335\301\055\221\046\111\214\015\023\162\170"
	"\036\037\174\274\024\203\374\312\173\054\141\244\140\004\064\376"
	"\215\323\224\371\255\141\302\135\010\316\101\055\125\235\245\126"
	"\242\107\012\273\133\060\040\257\254\225\330\334\155\127\112\054"
	"\170\043\230\374\265\007\333\226\203\315\152\352\035\326\171\224"
	"\252\000\271\212\055\150\235\075\067\143\075\232\375\270\127\137"
	"\212\274\133\355\313\004\343\275\360\056\170\041\307\273\222\174"
	"\242\135\201\274\135\162\054\111\030\046\202\332\155\305\041\127"
	"\330\146\031\335\241\011\276\136\045\333\027\066\272\243\320\070"
	"\333\026\030\252\065\133\125\103\007\305\205\163\067\115\153\364"
	"\367\321\142\235\127\332\226\251\301\164\166\350\154\150\246\273"
	"\365\326\014\024\221\063\001\124\163\154\235\052\304\204\112\156"
	"\163\310\161\011\302\037\231\157\342\200\326\353\027\013\325\111"
	"\066\222\360\275\247\065\325\134\241\225\365\263\152\174\100\362"
	"\225\344\266\007\106\212\217\270\151\255\126\270\373\041\010\010"
	"\111\012\003\002\030\014\245\107\010\107\350\136\337\371\127\033"
	"\235\331\271\274\163\353\051\270\023\266\343\023\166\137\124\370"
	"\140\227\034\325\222\133\053\227\323\046\040\064\062\174\245\354"
	"\047\351\150\361\004\170\246\247\044\311\257\351\305\104\103\113"
	"\012\230\021\130\173\153\173\272\145\234\357\015\133\231\145\115"
	"\376\240\211\050\335\115\225\047\057\102\060\321\216\311\173\233"
	"\052\216\023\122\373\047\257\046\104\165\247\033\073\035\206\300"
	"\365\034\336\352\173\100\352\123\131\260\030\141\346\114\147\337"
	"\112\041\001\261\065\067\327\352\021\064\316\061\256\100\052\353"
	"\241\325\032\231\225\303\243\162\324\161\037\304\306\374\112\306"
	"\312\326\156\373\270\353\100\272\342\023\004\373\351\010\077\214"
	"\315\056\327\223\303\323\005\265\354\250\265\167\345\357\206\022"
	"\275\150\016\262\323\165\113\206\315\373\177\225\375\257\224\316"
	"\315\362\020\277\044\270\141\117\012\111\263\326\021\304\376\245"
	"\217\052\375\174\340\043\107\374\264\232\100\364\062\304\051\077"
	"\240\262\355\327\265\011\231\261\234\366\156\220\024\353\170\130"
	"\361\175\004\251\336\025\366\333\154\027\232\055\322\034\153\142"
	"\345\242\313\072\347\077\205\064\325\000\167\175\100\342\375\166"
	"\367\343\156\246\213\147\242\277\041\053\045\103\067\132\134\367"
	"\036\345\101\040\065\317\373\237\217\345\035\317\307\032\106\277"
	"\375\265\145\211\035\007\110\076\063\155\202\152\310\337\142\346"
	"\305\243\007\372\163\002\231\002\347\266\322\256\321\030\156\316"
	"\316\323\127\353\333\240\052\016\015\255\171\326\214\334\275\121"
	"\200\304\114\363\306\346\366\255\235\310\134\156\341\312\075\260"
	"\236\225\233\171\065\306\210\103\164\002\031\001\336\327\122\136"
	"\233\237\122\141\205\110\017\043\021\153\221\362\066\317\242\324"
	"\144\076\115\231\005\326\335\171\330\367\172\266\316\315\025\151"
	"\155\150\313\363\260\332\026\302\106\250\265\174\167\127\120\333"
	"\226\236\165\234\164\122\025\114\112\220\003\030\136\031\202\313"
	"\201\115\276\062\050\324\364\156\175\251\352\364\001\072\320\230"
	"\331\105\064\115\230\112\232\343\332\236\373\070\267\176\004\070"
	"\313\302\153\363\227\137\141\024\011\114\010\012\207\331\242\140"
	"\036\326\256\267\041\111\232\373\347\226\064\237\024\070\330\340"
	"\373\103\324\222\243\066"
#define      msg2_z	19
#define      msg2	((&data[3768]))
	"\260\266\011\260\064\101\104\245\143\061\205\263\077\123\223\112"
	"\105\236\324\276\115\360\211\131"
#define      lsto_z	1
#define      lsto	((&data[3789]))
	"\347"
#define      msg1_z	42
#define      msg1	((&data[3794]))
	"\142\372\115\112\125\244\312\356\302\122\053\133\252\332\366\114"
	"\161\023\164\155\042\334\272\365\055\240\343\126\322\346\035\246"
	"\014\367\010\213\244\020\241\027\340\104\012\224\150\053\221\201"
	"\351"
#define      rlax_z	1
#define      rlax	((&data[3839]))
	"\022"
#define      tst1_z	22
#define      tst1	((&data[3844]))
	"\132\110\250\221\272\175\066\361\373\251\072\003\307\356\256\164"
	"\066\233\250\147\230\100\125\256\265\335"
#define      pswd_z	256
#define      pswd	((&data[3887]))
	"\240\013\035\051\145\210\322\226\241\062\347\004\055\065\116\276"
	"\267\067\144\161\371\211\155\057\312\112\321\040\101\154\205\337"
	"\056\227\363\204\071\375\323\166\304\056\322\175\051\063\150\145"
	"\206\112\171\176\323\347\256\235\061\200\275\162\354\103\122\032"
	"\332\106\237\024\103\162\212\007\241\134\205\312\217\356\057\026"
	"\070\251\225\014\220\104\252\302\304\147\065\260\252\207\313\205"
	"\315\153\232\020\336\044\030\177\201\236\112\021\214\172\050\305"
	"\043\275\321\264\002\173\166\306\343\253\167\216\063\102\024\000"
	"\256\256\021\214\323\052\014\124\311\126\146\125\321\216\033\365"
	"\114\355\251\116\150\040\025\114\313\214\333\377\317\357\377\175"
	"\236\021\012\161\073\026\306\005\155\054\133\076\273\166\063\007"
	"\143\335\126\314\375\153\031\311\370\364\310\307\343\310\105\201"
	"\331\117\363\025\145\272\032\323\347\165\022\242\354\105\252\117"
	"\043\000\034\040\154\065\351\144\051\262\054\015\172\161\216\123"
	"\300\202\151\046\074\203\372\043\371\014\306\345\122\160\065\165"
	"\161\121\225\335\207\177\102\260\061\157\275\254\340\114\000\241"
	"\317\151\310\014\355\302\060\347\316\366\314\041\146\002\226\330"
	"\124\054\266\333\254\353\047\377\106\160"
#define      date_z	8
#define      date	((time_t*)(&data[4152]))
	"\374\352\001\010\044\043\152\213\207\231\151\072\010"
#define      shll_z	10
#define      shll	((&data[4162]))
	"\375\150\033\046\057\037\061\242\341\321\164\004"
#define      inlo_z	3
#define      inlo	((&data[4173]))
	"\344\070\063"
#define      xecc_z	15
#define      xecc	((&data[4177]))
	"\204\332\061\311\012\227\320\307\316\264\146\223\102\236\261\370"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned)chkenv;
	mask ^= (unsigned)getpid() * ~mask;
	sprintf(buff, "x%x", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%u %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%u %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && date[0]<time(NULL))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
