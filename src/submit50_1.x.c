#if 0
	shc Version 3.8.6, Generic Script Compiler
	Copyright (c) 1994-2006 Francisco Rosales <frosal@fi.upm.es>

	shc -r -f ./submit50_1 
#endif

static  char data [] = 
#define      tst2_z	19
#define      tst2	((&data[2]))
	"\350\100\114\216\261\206\141\221\162\177\051\317\177\140\073\120"
	"\365\065\121\265\335\156"
#define      inlo_z	3
#define      inlo	((&data[22]))
	"\157\076\043"
#define      shll_z	10
#define      shll	((&data[25]))
	"\071\346\000\277\041\363\142\013\250\233"
#define      text_z	2837
#define      text	((&data[73]))
	"\146\020\263\015\123\132\277\370\351\327\167\302\054\173\233\154"
	"\144\064\304\114\165\063\232\044\304\322\101\336\251\117\111\017"
	"\140\375\035\263\127\334\220\125\331\016\312\167\273\054\253\132"
	"\177\342\075\151\035\027\057\061\062\015\023\114\046\346\054\244"
	"\177\127\125\377\160\337\107\134\061\251\247\131\005\047\317\171"
	"\226\240\361\305\125\126\124\125\174\177\046\326\142\244\372\006"
	"\265\226\141\023\106\315\326\121\376\345\052\213\362\127\071\266"
	"\277\060\175\277\065\157\307\322\325\200\050\363\147\344\322\247"
	"\332\074\376\112\231\215\035\312\333\364\122\220\300\256\165\153"
	"\167\024\131\307\346\070\264\066\005\014\356\221\340\210\001\014"
	"\357\313\177\127\131\367\127\217\174\347\205\005\152\116\126\370"
	"\156\337\062\333\132\003\253\156\205\124\133\221\370\066\021\307"
	"\242\162\026\015\360\010\077\304\077\167\266\377\035\117\107\163"
	"\037\162\323\022\205\265\202\053\265\011\011\113\347\153\166\002"
	"\117\102\014\207\342\033\240\266\262\004\041\141\376\223\154\130"
	"\262\236\251\246\006\013\013\023\115\316\267\260\337\000\051\132"
	"\374\167\117\214\354\104\332\002\132\133\356\104\306\043\203\152"
	"\013\352\043\225\105\312\060\254\155\001\134\303\026\121\327\245"
	"\060\332\027\044\114\301\224\163\237\275\157\377\105\076\336\167"
	"\026\376\321\316\316\060\264\205\075\343\022\151\342\064\071\171"
	"\121\225\336\055\370\266\231\207\317\063\370\062\371\263\127\200"
	"\015\371\154\150\075\150\071\172\303\243\105\052\134\071\374\134"
	"\235\064\352\172\211\252\215\315\366\211\302\360\142\263\243\313"
	"\322\154\367\237\117\242\335\114\277\167\123\057\306\231\216\227"
	"\167\371\233\022\122\034\316\326\345\015\152\216\044\003\065\060"
	"\346\012\232\071\112\312\240\133\165\232\250\055\030\242\212\151"
	"\326\000\253\212\066\045\055\243\277\013\353\062\302\210\155\235"
	"\311\150\005\260\050\113\011\316\001\141\136\135\030\324\237\215"
	"\135\073\035\036\144\313\351\014\004\210\231\146\353\054\143\123"
	"\067\167\167\350\372\225\106\133\063\351\067\050\212\331\063\216"
	"\115\231\314\035\132\007\104\170\110\266\171\305\304\355\251\370"
	"\024\046\375\007\151\371\304\231\351\060\046\302\172\341\256\365"
	"\356\370\332\120\002\055\052\370\073\377\262\121\302\244\127\334"
	"\323\016\271\007\333\103\125\334\363\274\206\336\042\077\077\107"
	"\236\014\003\132\117\211\106\023\213\243\142\325\076\257\374\320"
	"\075\345\121\206\126\177\017\211\142\164\355\244\007\276\301\102"
	"\305\107\031\067\350\321\162\025\021\312\001\311\345\113\140\013"
	"\315\243\325\151\354\026\245\320\066\202\322\276\244\003\151\141"
	"\337\123\232\113\020\042\120\124\040\015\126\246\334\163\153\346"
	"\122\267\112\246\011\355\327\266\064\250\242\057\173\305\344\373"
	"\257\236\177\354\062\106\015\121\107\322\154\350\044\265\043\276"
	"\367\016\050\306\151\166\312\151\211\300\322\164\023\240\072\163"
	"\043\202\055\055\037\154\165\266\042\312\170\231\031\277\315\332"
	"\205\317\134\007\245\255\132\272\317\270\373\041\225\010\065\355"
	"\234\167\033\074\242\341\253\316\371\252\301\277\252\060\024\052"
	"\163\057\023\373\151\013\362\072\331\133\052\205\033\224\254\326"
	"\271\277\216\241\256\074\151\031\042\214\155\140\122\003\061\170"
	"\351\266\325\017\272\125\202\230\174\151\071\051\377\213\270\101"
	"\067\021\231\014\203\200\271\312\073\274\140\272\026\377\370\023"
	"\144\106\345\271\023\361\107\364\303\014\202\207\065\361\137\054"
	"\164\163\046\065\037\037\224\253\126\263\231\277\244\047\036\351"
	"\141\040\023\254\024\012\107\205\211\224\363\362\322\251\215\107"
	"\117\157\262\272\316\226\323\236\150\210\100\226\062\110\011\311"
	"\230\315\152\170\234\114\210\153\217\375\131\020\213\165\007\127"
	"\245\170\044\315\320\101\367\274\166\222\117\364\301\120\074\266"
	"\276\177\270\346\315\357\042\232\356\057\257\275\215\104\355\260"
	"\036\340\251\013\247\164\233\326\233\322\153\305\372\021\054\067"
	"\016\250\242\175\004\014\101\050\046\326\161\070\214\135\033\050"
	"\372\327\144\235\224\032\021\230\077\254\315\253\256\304\120\213"
	"\107\126\235\161\364\131\253\224\312\057\222\127\115\131\171\137"
	"\336\104\155\235\374\077\230\247\013\247\143\312\026\304\306\015"
	"\206\162\167\250\154\275\134\040\205\315\365\260\000\310\153\322"
	"\277\047\022\336\320\051\131\007\311\342\124\210\157\136\113\172"
	"\012\323\252\066\265\051\166\274\327\020\023\346\322\354\323\264"
	"\227\345\077\227\262\217\356\360\361\210\177\264\327\251\221\324"
	"\334\060\070\142\045\266\160\111\356\243\327\272\246\305\073\307"
	"\171\227\015\067\151\016\244\150\147\124\337\360\105\057\363\032"
	"\104\036\260\013\023\327\011\265\246\377\132\312\326\317\215\054"
	"\271\130\260\175\366\333\311\141\122\366\001\006\136\132\000\146"
	"\212\323\134\004\242\027\020\347\115\113\222\265\110\317\100\164"
	"\145\310\237\347\253\305\154\060\025\363\205\064\107\040\350\272"
	"\070\320\120\245\323\053\320\014\354\210\143\202\027\334\220\306"
	"\110\007\135\161\046\023\076\117\030\215\055\112\166\127\324\111"
	"\000\113\302\137\057\253\033\126\001\050\246\014\166\366\242\117"
	"\053\266\307\344\252\333\202\001\247\130\072\242\310\033\035\022"
	"\344\115\105\052\051\317\165\060\137\055\110\140\062\174\057\007"
	"\022\001\243\317\156\270\307\273\142\215\240\213\200\251\115\222"
	"\320\072\237\351\005\260\100\150\113\330\233\014\141\076\357\026"
	"\322\056\204\242\254\312\076\047\137\235\314\202\126\343\161\252"
	"\126\056\234\017\321\142\307\301\067\070\277\346\141\020\201\102"
	"\072\071\300\247\010\015\043\351\115\121\246\022\175\236\162\245"
	"\204\204\267\250\356\276\162\367\374\162\124\342\075\053\230\134"
	"\034\212\350\034\271\110\010\200\311\210\146\331\025\200\031\050"
	"\014\321\120\245\165\120\133\273\063\225\250\316\334\160\203\157"
	"\162\146\337\236\110\327\107\310\065\057\242\105\273\373\242\346"
	"\341\310\073\172\133\251\142\177\011\364\151\263\313\335\376\007"
	"\163\061\321\232\145\007\076\001\167\110\160\154\254\146\037\211"
	"\064\076\203\353\216\135\061\274\031\255\157\353\356\210\103\201"
	"\126\033\074\313\040\377\141\203\070\054\012\261\125\020\062\201"
	"\111\026\360\343\020\072\113\143\211\234\054\251\073\151\141\365"
	"\346\363\055\072\360\036\054\037\036\224\034\145\235\003\035\216"
	"\256\151\266\002\254\102\051\237\311\276\354\306\206\354\316\240"
	"\342\376\350\146\111\051\077\122\340\061\066\122\142\331\334\247"
	"\155\121\113\335\312\203\170\055\330\103\105\067\162\247\046\310"
	"\067\000\046\025\044\265\375\125\357\224\163\155\105\257\356\015"
	"\050\216\325\225\133\145\065\217\333\231\321\365\134\135\273\264"
	"\153\330\114\252\127\111\356\121\274\351\250\242\056\116\053\113"
	"\147\117\233\137\243\260\301\137\347\321\344\372\055\340\143\020"
	"\127\076\144\050\012\322\257\241\040\314\272\036\302\035\175\245"
	"\140\207\333\010\302\351\134\222\126\226\166\276\031\235\363\207"
	"\030\135\134\142\302\243\247\224\343\030\355\010\121\175\335\152"
	"\024\115\207\056\151\073\300\227\124\214\114\377\365\035\116\270"
	"\014\311\263\241\104\332\276\137\235\175\336\316\076\111\022\170"
	"\327\167\306\325\270\203\356\354\155\331\232\141\071\254\025\025"
	"\302\140\102\165\334\121\134\054\076\305\161\364\244\313\130\164"
	"\304\232\120\141\306\237\002\017\332\043\005\377\157\231\255\030"
	"\307\020\216\142\353\024\303\133\022\301\004\010\004\336\310\073"
	"\256\273\176\271\322\207\042\340\217\126\064\217\266\052\370\325"
	"\305\056\145\200\077\266\314\204\210\250\235\036\372\004\146\271"
	"\325\066\235\130\016\304\346\320\126\260\376\144\354\242\215\374"
	"\173\150\275\314\061\350\272\336\231\352\214\312\261\234\005\111"
	"\356\333\361\237\037\047\212\216\241\045\343\152\140\125\350\272"
	"\130\264\177\254\037\124\370\236\145\304\036\067\212\323\277\356"
	"\355\264\271\002\203\343\126\115\170\310\216\003\070\003\032\146"
	"\063\075\210\273\017\243\337\231\204\212\137\275\243\356\155\144"
	"\170\016\324\156\124\171\110\252\054\050\142\367\171\247\073\020"
	"\074\002\276\031\311\235\170\306\367\370\016\166\037\330\171\021"
	"\056\004\035\152\243\356\206\140\334\236\216\063\263\031\146\350"
	"\007\204\275\006\245\053\015\107\141\356\006\152\040\115\011\177"
	"\324\306\065\062\066\230\265\023\175\105\073\063\022\334\157\361"
	"\204\036\330\303\307\076\232\061\073\175\352\222\026\013\216\221"
	"\235\045\240\244\323\215\043\344\011\000\353\137\370\345\341\007"
	"\060\154\275\336\021\107\060\264\133\052\012\075\202\242\142\247"
	"\150\317\071\344\132\137\341\324\315\010\167\026\225\037\046\054"
	"\370\252\101\346\306\047\314\215\173\216\323\241\274\047\236\160"
	"\376\257\162\201\062\316\252\300\377\262\354\353\175\037\032\155"
	"\027\167\234\131\035\210\006\310\022\177\023\314\014\137\102\162"
	"\234\024\070\377\041\003\101\174\275\342\142\244\243\340\212\135"
	"\136\225\002\321\135\170\114\126\375\216\153\214\111\324\055\164"
	"\123\074\161\133\266\054\347\166\073\041\375\114\075\210\137\372"
	"\167\153\171\337\102\026\231\357\077\040\314\022\146\216\044\216"
	"\177\040\237\173\367\030\145\327\021\270\326\250\105\132\212\173"
	"\354\332\154\137\030\014\061\262\115\343\135\171\004\216\127\336"
	"\052\200\002\206\015\161\114\375\100\072\232\374\064\246\033\272"
	"\042\100\001\163\330\327\273\310\124\227\156\160\242\106\041\167"
	"\145\277\246\153\235\264\107\026\355\201\253\101\130\130\222\223"
	"\314\323\206\174\265\300\363\301\114\242\015\171\367\364\002\271"
	"\055\032\027\145\000\235\202\174\004\252\254\060\124\263\266\126"
	"\043\137\122\344\242\137\162\136\271\254\325\365\175\205\303\073"
	"\014\301\217\001\275\165\041\347\334\374\313\366\233\344\306\371"
	"\343\221\233\044\124\332\344\202\051\070\002\157\020\156\257\155"
	"\335\136\344\350\245\100\301\100\363\003\044\117\075\047\316\327"
	"\123\173\376\111\270\064\341\072\237\251\357\255\125\250\255\140"
	"\063\002\237\032\174\017\132\077\144\232\224\137\365\226\361\265"
	"\254\254\267\267\321\367\270\334\146\211\360\070\053\275\213\116"
	"\377\113\247\347\211\372\276\277\224\143\265\051\210\116\225\172"
	"\262\345\224\272\364\105\242\336\012\233\104\156\337\263\345\274"
	"\270\063\146\135\275\375\105\044\346\215\037\036\217\323\210\014"
	"\070\345\313\100\322\255\130\214\073\176\054\376\130\005\220\010"
	"\247\350\024\252\344\022\331\116\023\100\344\141\116\022\353\316"
	"\044\042\173\012\010\123\110\377\232\120\220\367\063\045\050\336"
	"\057\353\373\212\220\211\240\267\341\013\363\335\173\222\206\207"
	"\034\114\131\261\104\254\266\315\053\363\107\234\076\072\215\150"
	"\155\353\305\005\336\141\336\265\044\050\344\064\046\304\347\376"
	"\304\052\214\010\344\370\151\043\270\057\016\353\136\336\351\254"
	"\354\014\331\254\321\006\252\135\337\125\037\073\362\154\276\012"
	"\033\112\006\056\165\156\233\056\201\346\264\000\117\117\316\000"
	"\005\221\132\160\161\305\015\212\154\255\026\007\011\141\250\237"
	"\244\034\201\201\375\106\172\177\012\053\171\005\317\336\306\337"
	"\054\130\001\142\144\327\115\043\270\143\253\252\026\105\366\123"
	"\331\166\046\275\161\160\364\046\040\342\034\333\061\165\372\064"
	"\207\064\317\264\361\012\122\216\024\276\211\236\164\040\250\022"
	"\047\114\315\207\166\126\025\175\070\042\174\027\307\102\262\250"
	"\057\351\233\064\114\237\073\032\252\241\015\366\210\226\026\225"
	"\254\007\255\104\064\313\245\166\205\123\052\156\007\033\246\243"
	"\126\077\144\313\161\360\370\246\112\223\257\243\374\327\254\117"
	"\257\200\306\245\257\321\350\162\204\310\056\174\112\001\071\237"
	"\247\205\046\322\340\147\260\323\154\047\116\371\366\334\004\271"
	"\047\217\265\007\012\225\157\273\074\003\140\072\146\215\132\362"
	"\242\371\203\002\217\122\005\372\310\335\227\144\360\102\227\046"
	"\373\204\127\023\306\026\047\042\224\176\065\163\107\367\266\306"
	"\240\100\153\320\132\355\052\325\304\057\053\236\034\240\131\063"
	"\326\150\107\040\263\307\321\323\273\247\117\112\202\121\261\346"
	"\253\120\027\117\335\335\244\320\125\257\015\033\010\273\335\210"
	"\211\062\112\031\166\116\123\263\155\351\146\025\141\303\345\220"
	"\057\106\050\036\133\226\311\075\017\336\203\201\050\213\123\063"
	"\001\130\033\365\133\231\220\235\101\372\101\243\302\147\214\350"
	"\243\130\311\203\104\003\027\020\141\377\223\110\211\024\014\113"
	"\032\073\143\156\353\327\166\220\146\361\331\363\073\110\011\354"
	"\306\147\066\246\017\075\066\144\001\303\103\253\101\263\043\003"
	"\340\236\237\115\003\324\021\117\111\104\352\155\011\274\257\347"
	"\145\376\061\165\136\056\222\022\206\157\276\307\043\341\313\003"
	"\200\152\121\204\076\142\323\207\247\276\365\260\173\244\230\340"
	"\243\311\126\001\370\351\024\176\130\322\105\174\264\020\200\065"
	"\173\321\271\271\064\215\100\334\113\066\215\306\332\045\247\176"
	"\356\376\200\346\347\224\145\100\147\253\274\033\273\074\121\067"
	"\016\013\360\102\230\060\036\344\147\253\253\101\320\123\300\277"
	"\121\100\246\070\324\013\170\073\267\065\127\162\161\251\252\177"
	"\264\232\302\115\313\340\062\062\214\335\164\135\060\064\035\201"
	"\164\303\272\110\317\063\204\206\150\334\371\332\205\243\132\072"
	"\075\034\210\011\374\272\073\211\227\257\346\310\343\003\112\127"
	"\307\004\240\227\067\045\035\240\001\027\172\207\273\324\302\371"
	"\360\112\002\355\004\075\166\234\354\135\145\320\140\257\047\047"
	"\264\310\277\354\355\334\214\357\364\006\167\257\333\071\251\313"
	"\204\253\271\211\350\060\045\325\215\213\245\356\072\315\025\357"
	"\225\324\333\202\261\147\162\246\156\351\125\111\043\377\025\247"
	"\252\317\060\223\377\126\151\214\341\016\172\034\334\220\013\161"
	"\145\346\364\027\116\146\275\275\120\023\006\163\022\034\032\275"
	"\353\113\120\353\242"
#define      rlax_z	1
#define      rlax	((&data[3208]))
	"\227"
#define      opts_z	1
#define      opts	((&data[3209]))
	"\244"
#define      msg2_z	19
#define      msg2	((&data[3212]))
	"\026\351\150\217\262\050\332\321\215\037\077\340\111\307\076\121"
	"\232\211\350\244\222\222\013\001"
#define      chk2_z	19
#define      chk2	((&data[3236]))
	"\236\302\215\252\343\151\353\341\252\313\031\244\247\211\257\345"
	"\215\205\345\240\371\323\245\066"
#define      pswd_z	256
#define      pswd	((&data[3307]))
	"\243\256\234\363\231\076\255\021\302\166\005\142\033\211\016\062"
	"\162\241\075\164\203\260\063\041\162\006\307\251\354\211\371\217"
	"\067\226\202\321\325\060\343\227\246\350\372\302\161\011\364\344"
	"\253\216\030\245\255\172\243\364\225\305\274\306\271\224\203\264"
	"\347\010\122\017\264\316\154\307\044\024\272\326\262\155\233\311"
	"\374\264\156\252\056\022\236\303\327\133\212\221\357\016\106\327"
	"\026\230\346\313\146\122\222\212\147\114\141\031\272\375\342\266"
	"\261\121\140\340\143\377\244\073\132\056\315\112\074\023\041\123"
	"\253\007\036\021\132\260\234\302\375\376\333\270\373\276\156\255"
	"\017\317\215\163\317\061\257\052\140\174\164\234\217\225\357\072"
	"\235\016\114\370\277\351\272\275\350\226\165\344\124\344\221\144"
	"\263\037\327\203\120\207\255\260\003\042\115\222\270\075\315\125"
	"\113\032\116\012\004\011\307\354\237\075\320\363\041\142\130\325"
	"\201\057\130\321\266\006\202\272\050\320\114\340\015\032\066\131"
	"\065\205\144\071\216\053\045\055\151\366\041\212\130\171\137\331"
	"\251\270\253\140\276\056\032\347\376\147\307\014\201\376\145\267"
	"\203\311\360\022\365\026\077\136\014\141\351\144\333\110\076\204"
	"\001\351\344\277\030\377\247\026\146\156\042\350\155\210\237\361"
	"\122\220\003\107\246\102\246\262\244\217\027\177\330\125\003\331"
	"\077\061\130\056\342\213\117\125\222\027\376\176\240\370\015\330"
	"\216\220\251\143\301"
#define      chk1_z	22
#define      chk1	((&data[3588]))
	"\165\365\052\346\377\011\332\350\015\315\324\231\325\372\236\261"
	"\233\271\167\044\370\342\336\241\200\231\375\036\312"
#define      msg1_z	42
#define      msg1	((&data[3615]))
	"\330\062\257\377\234\261\334\073\027\051\141\221\371\246\373\153"
	"\053\151\155\021\345\153\113\130\070\177\362\240\133\161\257\132"
	"\327\040\104\332\026\106\305\055\026\261\012\275\370\050"
#define      tst1_z	22
#define      tst1	((&data[3659]))
	"\205\271\363\037\052\366\372\046\273\316\345\246\244\235\017\133"
	"\140\020\360\111\263\142\240\300"
#define      date_z	8
#define      date	((time_t*)(&data[3688]))
	"\270\014\137\141\160\040\057\313\122\232\307\210\152\043\356\153"
#define      xecc_z	15
#define      xecc	((&data[3699]))
	"\262\014\165\027\021\116\157\110\124\037\026\226\057\146\147\171"
	"\112"
#define      lsto_z	1
#define      lsto	((&data[3715]))
	"\252"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned)chkenv;
	mask ^= (unsigned)getpid() * ~mask;
	sprintf(buff, "x%x", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%u %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%u %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && date[0]<time(NULL))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		if (text_z < hide_z) {
			/* Prepend spaces til a hide_z script size. */
			scrpt = malloc(hide_z);
			if (!scrpt)
				return 0;
			memset(scrpt, (int) ' ', hide_z);
			memcpy(&scrpt[hide_z - text_z], text, text_z);
		} else {
			scrpt = text;	/* Script text */
		}
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, argv[0]);
		} else {
			scrpt = argv[0];
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
