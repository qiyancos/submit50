#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	shc -r -T -f ./submit50 
#endif

static  char data [] = 
#define      opts_z	1
#define      opts	((&data[0]))
	"\251"
#define      inlo_z	3
#define      inlo	((&data[1]))
	"\211\211\263"
#define      pswd_z	256
#define      pswd	((&data[48]))
	"\315\035\260\006\066\100\243\072\154\065\263\375\326\340\374\200"
	"\175\044\247\335\225\317\251\243\031\371\062\271\006\342\233\323"
	"\377\113\331\065\213\174\157\370\262\043\366\210\123\241\305\011"
	"\203\377\002\034\330\220\366\300\327\066\226\127\313\047\256\366"
	"\306\245\072\032\010\307\263\252\305\321\324\030\162\232\042\365"
	"\231\044\022\161\264\011\061\213\077\310\343\013\360\222\001\266"
	"\067\074\321\100\004\205\352\311\126\277\342\310\131\004\276\362"
	"\051\320\144\336\331\225\151\031\136\115\044\116\340\046\005\027"
	"\143\326\130\147\134\103\061\262\002\023\172\133\030\071\115\101"
	"\011\262\037\343\107\211\375\246\327\041\365\267\110\372\317\253"
	"\321\047\022\056\152\103\340\154\127\133\307\157\224\025\261\236"
	"\307\320\202\017\132\177\266\061\240\253\350\351\246\267\224\170"
	"\337\247\246\111\353\206\265\102\342\175\262\166\223\143\025\133"
	"\064\227\153\216\026\041\277\267\314\250\240\163\140\064\353\077"
	"\333\222\211\306\030\077\011\373\274\274\161\120\037\207\253\123"
	"\036\026\342\064\070\242\354\004\113\214\170\253\301\143\353\235"
	"\365\164\144\016\263\155\011\160\051\173\301\111\002\155\235\041"
	"\203\177\125\274\042\102\300\155\316\071\030\217\234\004\054\222"
	"\170\220\240\054\376\252\235\050\046\137\161\050\003\362\011\201"
	"\026\260\136\254\177\007\120\231\001\202\123\007\144\357\332\144"
	"\072\264\232\306\061\011\277\343\055\265\153\060\250\164\261\277"
	"\044\017\153\244\027\273\076\030\075\222\040\242\201\373\006\274"
	"\260\240\202\341\252"
#define      shll_z	10
#define      shll	((&data[363]))
	"\370\060\072\074\020\222\263\103\035\061\336\006\010\240"
#define      msg2_z	19
#define      msg2	((&data[378]))
	"\312\311\313\114\033\121\331\166\124\074\364\041\261\176\320\210"
	"\044\237\350\133\061\212\157"
#define      tst2_z	19
#define      tst2	((&data[400]))
	"\371\304\003\130\161\126\132\030\274\005\113\240\240\173\130\024"
	"\041\132\100\057\157\077\032\147"
#define      text_z	1495
#define      text	((&data[454]))
	"\175\306\016\000\247\271\102\155\221\072\235\231\333\103\123\073"
	"\015\034\006\174\375\214\052\367\121\152\022\270\053\050\046\251"
	"\365\061\305\144\275\022\205\061\054\263\215\257\161\005\230\017"
	"\240\301\211\132\137\007\073\264\137\367\241\266\157\325\133\243"
	"\370\374\217\274\201\154\340\213\363\305\052\106\204\321\016\205"
	"\070\266\140\230\303\126\162\073\263\177\265\145\075\274\026\063"
	"\340\010\242\112\115\303\050\130\212\064\111\013\310\254\104\267"
	"\332\133\357\136\231\213\271\067\360\035\024\124\330\324\362\307"
	"\135\170\272\214\151\326\227\270\154\233\065\052\042\276\344\014"
	"\003\154\054\036\207\077\217\064\137\336\143\156\145\300\233\236"
	"\124\222\215\343\245\342\216\043\337\244\075\206\000\104\305\065"
	"\147\267\217\212\165\070\146\070\173\370\071\377\037\036\175\213"
	"\354\165\042\236\353\016\157\061\176\354\225\162\007\115\104\011"
	"\016\052\013\151\211\044\141\074\337\176\264\026\205\377\344\253"
	"\121\353\347\140\312\320\372\304\242\243\311\374\306\121\033\145"
	"\055\067\114\021\170\341\371\335\123\264\313\200\003\127\052\271"
	"\252\034\221\237\020\360\362\172\302\242\204\240\100\271\304\333"
	"\010\214\055\106\361\312\257\272\354\362\157\021\366\226\210\043"
	"\323\014\037\237\150\353\035\343\175\216\264\127\117\272\221\324"
	"\102\012\074\204\126\365\256\346\201\237\067\162\002\227\301\107"
	"\130\242\152\103\045\315\021\330\342\056\024\074\023\315\233\040"
	"\267\231\263\151\322\126\221\066\332\216\367\314\065\356\347\240"
	"\304\247\321\374\336\107\160\000\142\221\011\323\213\317\030\111"
	"\057\175\213\361\214\211\371\205\312\030\234\006\100\355\061\120"
	"\222\057\254\362\062\275\125\256\052\023\176\035\010\011\300\074"
	"\311\256\245\130\043\051\045\143\073\022\247\216\261\015\015\123"
	"\274\321\305\167\313\237\073\327\023\025\050\212\063\054\310\322"
	"\174\116\174\053\260\244\216\000\117\267\043\031\040\070\031\361"
	"\134\075\342\362\053\007\134\351\105\146\105\246\033\163\033\075"
	"\324\203\134\136\307\241\255\064\133\243\146\244\164\355\224\122"
	"\001\052\223\316\300\023\110\131\220\261\053\247\204\207\313\071"
	"\373\311\171\234\164\330\142\073\075\113\024\270\033\372\157\165"
	"\346\343\114\220\012\166\227\255\134\031\002\341\011\125\121\253"
	"\225\173\207\370\060\305\004\136\145\142\333\234\024\312\320\202"
	"\252\253\174\306\071\342\101\137\126\236\372\021\006\022\077\003"
	"\044\307\264\267\346\213\305\053\203\332\345\263\326\106\314\305"
	"\377\251\053\362\276\165\350\371\353\205\124\001\307\166\315\376"
	"\353\310\145\243\311\204\373\150\305\121\300\004\277\375\364\032"
	"\152\365\113\140\031\117\266\151\206\171\007\033\162\270\077\002"
	"\171\062\376\337\141\250\352\177\242\261\075\053\363\057\351\124"
	"\204\213\167\140\253\236\356\073\302\146\105\121\206\016\042\167"
	"\341\004\074\247\360\256\137\153\031\217\107\372\176\301\255\376"
	"\363\063\365\226\311\021\062\033\102\043\241\014\304\124\106\266"
	"\056\043\353\143\162\167\375\324\051\206\060\041\270\072\047\004"
	"\213\312\351\012\334\333\105\127\302\054\013\007\066\076\114\235"
	"\101\114\257\006\025\006\313\271\120\117\213\054\023\033\002\377"
	"\111\020\052\201\252\007\070\337\216\030\213\263\274\016\232\242"
	"\260\372\154\132\364\054\370\322\011\142\073\242\144\125\117\022"
	"\024\201\005\220\270\327\305\255\064\327\051\061\004\037\101\120"
	"\337\132\020\376\145\065\253\065\375\324\165\223\042\152\123\046"
	"\004\205\201\126\325\254\303\155\252\163\261\130\116\117\040\344"
	"\313\211\336\071\042\074\074\047\163\253\107\305\353\343\324\040"
	"\363\061\077\260\276\247\317\356\072\056\155\101\207\171\370\041"
	"\077\303\067\377\107\005\236\250\376\354\325\003\124\337\103\064"
	"\134\012\336\173\221\312\327\215\257\130\265\165\202\260\137\261"
	"\126\263\016\230\373\342\132\250\264\066\221\271\170\012\004\374"
	"\252\354\103\361\113\071\233\314\102\076\244\317\250\356\163\200"
	"\340\360\237\055\370\370\124\011\103\241\210\050\044\104\217\054"
	"\061\165\073\221\307\274\320\001\342\115\136\110\004\325\214\037"
	"\134\304\201\134\154\031\262\337\326\055\135\374\314\061\324\103"
	"\021\077\053\241\301\215\053\165\126\240\165\062\027\017\260\107"
	"\165\234\243\361\227\213\307\137\117\230\244\356\257\051\225\362"
	"\135\142\077\177\361\240\342\010\373\077\114\071\121\227\070\013"
	"\076\040\241\242\036\114\000\137\044\246\215\171\100\126\227\177"
	"\275\003\260\277\162\125\032\144\247\102\271\153\315\256\234\006"
	"\115\135\256\051\233\371\360\005\361\120\170\262\262\050\331\014"
	"\015\241\332\134\300\020\222\100\334\261\102\255\260\040\004\207"
	"\144\074\177\216\166\214\161\235\325\366\136\006\205\352\351\205"
	"\157\026\102\200\357\365\123\253\123\203\375\223\077\302\074\322"
	"\376\363\201\133\152\157\367\207\057\207\215\014\374\375\006\322"
	"\240\167\272\013\017\251\335\007\323\206\355\347\135\231\317\121"
	"\105\202\244\361\237\341\135\372\032\034\312\006\236\310\114\241"
	"\272\106\001\352\337\263\134\066\156\060\330\156\053\164\052\175"
	"\375\251\170\004\342\117\343\031\010\267\324\167\144\243\133\045"
	"\305\341\026\173\367\216\112\207\073\134\244\040\215\160\337\155"
	"\116\332\230\003\020\220\253\207\076\041\337\206\232\050\242\315"
	"\057\132\107\322\226\122\266\354\170\272\002\017\244\145\362\207"
	"\036\207\071\020\114\021\360\173\301\067\311\220\170\126\376\244"
	"\373\231\245\335\222\225\251\372\346\263\113\024\111\004\044\375"
	"\217\275\201\142\044\321\217\131\130\255\005\075\333\210\307\274"
	"\217\232\243\303\151\302\047\036\157\164\147\375\337\223\323\341"
	"\263\201\367\176\063\222\241\220\250\004\162\126\003\131\002\043"
	"\321\034\165\317\374\074\037\117\017\047\327\363\355\247\022\013"
	"\342\031\256\215\143\132\342\173\074\154\071\162\115\122\067\354"
	"\013\140\011\002\356\116\166\024\030\166\245\123\003\374\024\314"
	"\275\212\262\340\203\025\101\252\271\036\244\374\264\240\272\246"
	"\130\066\006\007\123\357\344\275\327\104\324\276\123\132\331\247"
	"\336\314\356\143\107\240\355\157\306\255\313\207\137\332\332\075"
	"\203\202\003\366\302\363\261\320\154\232\342\254\072\267\244\055"
	"\337\176\231\224\174\061\301\300\033\136\233\137\254\017\170\217"
	"\377\141\222\040\131\117\060\033\207\131\213\251\304\275\051\076"
	"\165\121\022\122\362\256\230\335\025\027\343\250\177\125\000\071"
	"\002\004\266\351\054\367\353\156\376\056\041\053\237\163\026\213"
	"\165\214\306\160\352\041\216\312\014\350\074\131\113\075\272\212"
	"\360\177\245\014\165\213\052\202\002\114\123\134\273\207\126\217"
	"\126\277\261\132\073\337\026\356\065\251\226\356\353\003\200\046"
	"\241\032\001\344\155\074\362\212\102\157\210\317\232\200\041\004"
	"\222\331\060\272\000\331\250\065\202\076\044\156\102\244\224\343"
	"\276\226\310\054\323\273\266\025\053\077\345\305\277\006\312\121"
	"\340\372\013\340\324\264\025\127\363\071\306\065\335\132\031\234"
	"\361\341\310\304\235\177\332\310\277\300\215\176\306\130\320\247"
	"\122\333\207\047\217\234\176\202\326\104\270\264\237\321\120\221"
	"\263\031\126\120\231\060\031\130\361\247\327\267\377\247\136\122"
	"\203\346\171\023\202\370\225\130\075\116\015\335\037\135\157\323"
	"\167\305\044\020\366\075\151\347\344\100\237\343\350\375\066\153"
	"\343\257\176\146\250\024\277"
#define      chk2_z	19
#define      chk2	((&data[2110]))
	"\303\370\340\072\004\175\162\262\104\320\232\130\257\010\051\115"
	"\137\107\376\047\202\052\063"
#define      xecc_z	15
#define      xecc	((&data[2134]))
	"\172\262\364\005\225\104\014\006\050\072\146\061\205\310\304\171"
	"\117\356\267\033"
#define      msg1_z	42
#define      msg1	((&data[2158]))
	"\164\200\104\162\266\257\050\341\342\063\134\276\225\060\270\321"
	"\064\302\212\207\142\225\353\271\014\245\317\146\341\117\037\340"
	"\353\363\220\250\127\125\226\004\334\072\201\321\075\354\312\055"
	"\126\146\056"
#define      date_z	1
#define      date	((&data[2203]))
	"\023"
#define      tst1_z	22
#define      tst1	((&data[2209]))
	"\111\271\050\163\354\237\253\103\054\375\277\065\355\220\004\060"
	"\261\105\325\217\055\347\064\130\160\245\307\176\025\344"
#define      lsto_z	1
#define      lsto	((&data[2234]))
	"\226"
#define      rlax_z	1
#define      rlax	((&data[2235]))
	"\154"
#define      chk1_z	22
#define      chk1	((&data[2237]))
	"\314\037\247\263\201\135\351\306\014\207\353\172\336\076\041\046"
	"\100\337\166\013\146\335\010"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !defined(TRACEABLE)

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !defined(TRACEABLE) */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !defined(TRACEABLE)
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
